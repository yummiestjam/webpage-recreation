!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="54ffc909-9c46-40c3-93f0-2a006f2615ae",e._sentryDebugIdIdentifier="sentry-dbid-54ffc909-9c46-40c3-93f0-2a006f2615ae")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6998],{96390:function(){},68370:function(e,t,l){"use strict";l.d(t,{k:function(){return n}});var i=l(44003);l(56678);let n=e=>{let{textContent:t}=e;return(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center gap-5",children:[(0,i.jsx)("div",{className:"relative h-8 w-8",style:{WebkitMaskImage:"linear-gradient(to top, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 1))"},children:(0,i.jsx)("img",{src:"/images/tatem-logo.png",className:"loading-spin h-8 dark:invert",alt:"Tatem logo icon"})}),(0,i.jsx)("div",{className:"loading-text bg-clip-text",children:(0,i.jsx)("div",{className:"text-body text-transparent",children:t})})]})}},44424:function(e,t,l){"use strict";l.d(t,{KN:function(){return j},ce:function(){return I},dt:function(){return T},nu:function(){return M},y_:function(){return R}});var i=l(44003),n=l(70137),r=l(48804),o=l(63372),a=l(98506),d=l(26031),s=l(87355),u=l(6566),c=l(74848),v=l(61808),m=l.n(v),p=l(59897),h=l.n(p),f=l(41646),g=l(62516),b=l(39359),y=l(50026),x=l(50025),k=l(31097),w=l(5965),C=l(58145);l(11193);let S=(0,f.default)(()=>Promise.all([l.e(3384),l.e(6165),l.e(5703),l.e(3777)]).then(l.bind(l,83777)),{loadableGenerated:{webpack:()=>[83777]},ssr:!1}),I=async e=>{var t,l,i,n,r,o,a,d,s,u,c;let{part:v,message:m,onStarted:p,onCompleted:h,onError:f}=e;p&&p();let g=null===(t=window)||void 0===t?void 0:t.gapi;if(!h)return null==g?void 0:null===(c=g.client)||void 0===c?void 0:null===(u=c.gmail)||void 0===u?void 0:null===(s=u.users)||void 0===s?void 0:null===(d=s.messages)||void 0===d?void 0:d.attachments.get({userId:"me",messageId:null==m?void 0:m.id,id:null==v?void 0:null===(a=v.body)||void 0===a?void 0:a.attachmentId});null==g||null===(o=g.client)||void 0===o||null===(r=o.gmail)||void 0===r||null===(n=r.users)||void 0===n||null===(i=n.messages)||void 0===i||i.attachments.get({userId:"me",messageId:null==m?void 0:m.id,id:null==v?void 0:null===(l=v.body)||void 0===l?void 0:l.attachmentId}).then(e=>{h&&h(e.result)}).catch(e=>{f&&f(e)})},N=e=>e.parts?N(e.parts):e,T=(e,t)=>{var l,i,n,r;if(null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(l=i.body)||void 0===l?void 0:l.attachmentId)return[null==e?void 0:e.payload];let o=null==e?void 0:null===(r=e.payload)||void 0===r?void 0:null===(n=r.parts)||void 0===n?void 0:n.flatMap(e=>N(e));return null==o?void 0:o.filter(e=>{var l,i,n,r;let o=null==e?void 0:null===(i=e.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toUpperCase())==="CONTENT-ID"}))||void 0===l?void 0:l.value,a=null==e?void 0:null===(r=e.headers)||void 0===r?void 0:null===(n=r.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toUpperCase())==="CONTENT-DISPOSITION"}))||void 0===n?void 0:n.value;return(null==a||!a.includes("inline"))&&(null!=a&&!!a.includes("attachment")||!!e.filename&&e.filename.length&&(!e.mimeType.includes("image/")||e.mimeType.includes("image/")&&!o||t))})},j=e=>{var t,l,i,n,r,o;return{raw:e,loading:!1,error:"",data:"",extension:(0,w.A)((null==e?void 0:e.filename)||"?"),mimeType:null!==(r=null==e?void 0:e.mimeType)&&void 0!==r?r:null==e?void 0:e.contentType,size:(0,x.j)((null==e?void 0:null===(t=e.body)||void 0===t?void 0:t.size)||0),fileColor:null!==(o=C.f[null==e?void 0:e.mimeType])&&void 0!==o?o:void 0,filename:(null==e?void 0:e.filename)||"Untitled",isPreviewable:!!((null==e?void 0:null===(l=e.mimeType)||void 0===l?void 0:l.startsWith("application/pdf"))||(null==e?void 0:null===(i=e.mimeType)||void 0===i?void 0:i.startsWith("image/"))||(null==e?void 0:null===(n=e.mimeType)||void 0===n?void 0:n.startsWith("video/")))}},E=e=>{let t=T(e,!0);return t?t.reduce((e,t)=>({...e,[t.partId||""]:j(t)}),{}):{}},M=()=>(0,i.jsx)("div",{className:"fixed left-1/2 top-0 z-10 flex h-full -translate-x-1/2 items-center",children:(0,i.jsx)(s.J,{path:y.N.SyncLarge,className:"shrink-0 animate-[spin_1s_ease-in-out_infinite] text-primary dark:text-primary-dark"})});function A(e,t){if(e+="",(t+="").length<=0)return 0;for(var l=0,i=0,n=t.length;;)if((i=e.indexOf(t,i))>=0)++l,i+=n;else break;return l}let D=new Set(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","text/csv","text/html","application/json","application/xml","text/markdown","application/javascript","text/javascript","text/typescript","text/x-python","text/x-c"]),L=e=>{var t,l,r,s,c,v,p;let{message:f,attachment:x,attachments:w,isSearchOpen:C,closeModal:N,pdfDimensions:T,pdfPrintReference:j,setIsSearchOpen:E,setAttachments:L}=e,[R,O]=(0,g.useState)(x),[F,B]=(0,g.useState)(1),[z,_]=(0,g.useState)(1),[H,P]=(0,g.useState)(""),[U,W]=(0,g.useState)(1.1),[q,K]=(0,g.useState)(!0),[V,J]=(0,g.useState)(void 0),[X,G]=(0,g.useState)(void 0),[Q,Z]=(0,g.useState)(-1),[Y,$]=(0,g.useState)({globalMark:-1,pagesToCumulativeMarksIndex:-1}),[ee,et]=(0,g.useState)(void 0),el=(0,g.useRef)([]),ei=(0,g.useRef)(),en=(0,g.useRef)(null),er=(0,g.useRef)(1),eo=(0,g.useRef)([]),ea=(0,g.useRef)(0),ed=(0,g.useRef)(null),es=D.has(x.mimeType||""),eu=(0,g.useMemo)(()=>({data:(0,k.CX)(R)}),[R.data]),ec=(0,g.useMemo)(()=>{let e=(0,k.LN)(eu.data,null==R?void 0:R.mimeType);return j.current=e,e},[eu.data]),ev=(0,k.eh)(R.mimeType||"",(null==R?void 0:R.data)||""),em=(0,g.useCallback)((e,t)=>{O(e=>({...e,...t})),L(l=>({...l,[e]:{...l[e],...t}}))},[x.raw.partId]);(0,g.useEffect)(()=>{R.data||ep(R.raw.partId||"")},[R.raw.partId]),(0,g.useEffect)(()=>{let e=document.getElementById("main-page");if(e)return e.style.scrollbarGutter="auto",e.style.overflow="hidden",()=>{e.style.scrollbarGutter="stable",e.style.overflow="auto"}},[]),(0,g.useEffect)(()=>{H.length>0&&ey()},[eo.current]);let ep=e=>{w[e].data?O(w[e]):I({part:w[e].raw,message:f,onStarted:()=>{em(e,{loading:!0,error:""})},onCompleted:t=>{em(e,{loading:!1,data:null==t?void 0:t.data})},onError:t=>{var l,i;em(e,{loading:!1,error:(null==t?void 0:null===(i=t.result)||void 0===i?void 0:null===(l=i.error)||void 0===l?void 0:l.message)||"Unknown error"})}})},eh=()=>{if(!(ea.current>=5)){if(ea.current=ea.current+1,"application/pdf"===R.mimeType){let e=2.25*Math.min(window.innerWidth,800),t=Math.min(window.innerWidth,800)/T.current.width*.25;W(l=>(l+t)*T.current.width<=e?l+t:e/T.current.width)}else{0===ea.current?K(!0):K(!1);let e=document.getElementById("attachment-image");if(e){let t=e.clientWidth;V||J(t),G(t+(null!=V?V:t)*.25)}}}},ef=()=>{if(!(ea.current<=-1)){if(ea.current=ea.current-1,"application/pdf"===R.mimeType){let e=.75*Math.min(window.innerWidth,800),t=Math.min(window.innerWidth,800)/T.current.width*.25;W(l=>(l-t)*T.current.width>=e?l-t:e/T.current.width)}else{0===ea.current?K(!0):K(!1);let e=document.getElementById("attachment-image");if(e){let t=e.clientWidth;V||J(t),G(t-(null!=V?V:t)*.25)}}}},eg=()=>{if("application/pdf"===R.mimeType){K(!1);let e=T.current.width,t=T.current.height,l=window.innerWidth/e-(window.innerWidth>800?.1:0);t*l>1.5*window.innerHeight&&l>1&&(l=1.5*window.innerHeight/t);let i=l*e/Math.min(window.innerWidth,800);ea.current=(i-1)/.25,W(l)}},eb=()=>{ea.current=0,K(!0),"application/pdf"===R.mimeType?W(Math.min(window.innerWidth,800)/T.current.width):G(void 0)},ey=e=>{var t;let l=null!=e?e:H;0!==el.current.length&&(el.current=[]);let i=[],n=0;for(let e=0;e<eo.current.length;e++){let t=A(eo.current[e],l);t>0&&(n+=t,i.push({page:e+1,cumulativeMarks:n}))}el.current=[{pagesToCumulativeMarks:i,markText:l,totalMarks:n}],en.current=i;let r=null===(t=i.at(0))||void 0===t?void 0:t.page;Z(n),void 0!==r&&($({globalMark:1,pagesToCumulativeMarksIndex:0}),et({page:r,indexRelativeToPage:0}),(r<er.current-1||r>er.current+1)&&eI(r))},ex=(e,t)=>{var l,i,n,r,o;let a=(null!=t?t:H).toLocaleLowerCase(),d=e.toLocaleLowerCase();if(d.length>a.length){let e;let t=el.current,l=!1;for(let i=t.length-1;i>=0;i--){let n=null!==(r=null==(e=t[i])?void 0:e.markText)&&void 0!==r?r:d;if(n.length<=a.length&&n===a.substring(0,n.length)&&e){if(l&&(el.current=t,en.current=e.pagesToCumulativeMarks),n.length===a.length){Z(e.totalMarks);let t=null===(o=e.pagesToCumulativeMarks.at(0))||void 0===o?void 0:o.page;void 0!==t&&($({globalMark:1,pagesToCumulativeMarksIndex:0}),et({page:t,indexRelativeToPage:0}),(t<er.current-2||t>er.current+2)&&eI(t))}else ex(n,a);return}l=!0,t.pop()}0===t.length&&ey(a)}else{if(null===en.current){ey(a);return}{let e=el.current;for(let t=e.length-1;t>=0;t--){let l=e[t].markText.length;if(l<=a.length&&e[t].markText===a.substring(0,l))break;e.pop()}if(0===e.length){ey(a);return}let{filteredPages:t,totalMarksFound:r}=(null!==(n=null===(l=e.at(e.length-1))||void 0===l?void 0:l.pagesToCumulativeMarks)&&void 0!==n?n:[]).reduce((e,t)=>{let l=t.page-1,i=A(eo.current[l],a);return i>0&&(e.totalMarksFound+=i,e.filteredPages.push({page:t.page,cumulativeMarks:e.totalMarksFound})),e},{filteredPages:[],totalMarksFound:0});e.push({pagesToCumulativeMarks:t,markText:a,totalMarks:r}),en.current=t,el.current=e;let o=null===(i=t.at(0))||void 0===i?void 0:i.page;Z(r),void 0!==o&&($({globalMark:1,pagesToCumulativeMarksIndex:0}),et({page:o,indexRelativeToPage:0}),(o<er.current-2||o>er.current+2)&&eI(o))}}},ek=()=>{var e,t,l,i,n,r;let o=Y.pagesToCumulativeMarksIndex,a=Y.globalMark;if(null!==en.current&&a!==Q){if(null===(e=ei.current)||void 0===e||e.forEach(e=>null==e?void 0:e.classList.remove("!bg-[#ffcc2999]")),(null===(t=en.current.at(o))||void 0===t?void 0:t.cumulativeMarks)===a){let e=null===(l=en.current.at(o+1))||void 0===l?void 0:l.page;e&&($(e=>({globalMark:e.globalMark+1,pagesToCumulativeMarksIndex:e.pagesToCumulativeMarksIndex+1})),et({page:e,indexRelativeToPage:0}),(e<er.current-2||e>er.current+2)&&eI(e))}else $(e=>({globalMark:e.globalMark+1,pagesToCumulativeMarksIndex:e.pagesToCumulativeMarksIndex})),et(e=>void 0!==e?{page:e.page,indexRelativeToPage:e.indexRelativeToPage+1}:void 0)}else if(a===Q){null===(i=ei.current)||void 0===i||i.forEach(e=>e.classList.remove("!bg-[#ffcc2999]"));let e=null===(r=en.current)||void 0===r?void 0:null===(n=r.at(0))||void 0===n?void 0:n.page;e&&($({globalMark:1,pagesToCumulativeMarksIndex:0}),et({page:e,indexRelativeToPage:0}),(e<er.current-2||e>er.current+2)&&eI(e))}},ew=()=>{let e=Y.pagesToCumulativeMarksIndex,t=Y.globalMark;if(null!==en.current&&1!==t){var l,i,n,r,o;null===(l=ei.current)||void 0===l||l.forEach(e=>e.classList.remove("!bg-[#ffcc2999]"));let a=e-1>=0?null===(i=en.current.at(e-1))||void 0===i?void 0:i.cumulativeMarks:void 0;if(a&&a===t-1){let t=e-1>=0?null===(n=en.current.at(e-1))||void 0===n?void 0:n.page:void 0;t&&($(e=>({globalMark:e.globalMark-1,pagesToCumulativeMarksIndex:e.pagesToCumulativeMarksIndex-1})),et({page:t,indexRelativeToPage:a-(e-2>=0&&null!==(o=null===(r=en.current.at(e-2))||void 0===r?void 0:r.cumulativeMarks)&&void 0!==o?o:0)-1}),(t<er.current-2||t>er.current+2)&&eI(t))}else $(e=>({globalMark:e.globalMark-1,pagesToCumulativeMarksIndex:e.pagesToCumulativeMarksIndex})),et(e=>void 0!==e?{page:e.page,indexRelativeToPage:e.indexRelativeToPage-1}:void 0)}},eC=()=>{en.current=null,Z(-1),el.current=[]},eS=e=>{let t=parseInt(e);""!==e&&Number.isNaN(t)||B(""===e?e:t)},eI=e=>{let t=null!=e?e:F;if(""===t){B(er.current);return}if(t>z){eI(z);return}if(t<=0){eI(1);return}t!==F&&B(t),er.current=t;let l=40+U*T.current.height;ed.current&&(ed.current.scrollTop=l*(t-1))},eN=h()(()=>{var e,t;let l=40+U*T.current.height,i=Math.floor(((null!==(t=null===(e=ed.current)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0)+(l-40)/2)/l+1);i!==er.current&&(er.current=i,B(i))},100),eT={file:eu,currPage:er.current,numPages:z,setNumPages:_,searchText:H,markPageAndIndexRender:ee,zoom:U,setZoom:W,pdfDimensions:T,DEFAULT_PDF_FIT_WIDTH:800,PAGE_BREAK_SPACE:40,parsedWordsArray:eo,changePage:eI,selectedMark:ei},ej={id:"view-more-attachment-dropdown-options"},eE=[{label:"Open in New Tab  ↗",onSelect:()=>{window.open(ec)},doesCloseOnSelect:!0}];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("nav",{className:"fixed top-0 z-30 inline-flex h-14 w-full justify-between px-2 py-3 text-t2 sm:px-6",children:[(0,i.jsxs)("span",{className:m()("flex items-center gap-3 text-primary dark:text-primary-dark sm:w-full"),children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{icon:y.N.LeftArrow,variant:"tertiary",className:"peer",onClick:()=>{N()}}),(0,i.jsx)(o.M,{...n.Wz.Close,position:"top-10 left-0"})]}),(0,i.jsxs)("span",{className:m()("w-full items-center gap-2 sm:flex",{hidden:C},{flex:!C}),children:[(0,i.jsx)("div",{className:m()("flex h-6 w-6 items-center justify-center rounded bg-fill-dark-primary font-mono text-[10px] font-medium text-tertiary dark:bg-fill-dark-primary",{"dark:!text-tertiary-dark":"application/pdf"!==R.mimeType},null==x?void 0:x.fileColor),children:null===(t=x.extension)||void 0===t?void 0:t.toUpperCase()}),(0,i.jsx)("div",{className:m()("truncate",{"w-10 md:w-[250px] lg:w-[475px]":C},{"w-[120px] md:w-[475px]":!C}),children:R.filename})]})]}),(0,i.jsx)("div",{className:"flex select-none gap-2 pl-3 sm:pl-4",children:C?(0,i.jsx)(u.a,{id:"attachment-viewer-search-bar",onKeyDown:e=>{"Escape"===e.key?(e.stopPropagation(),eC(),P(""),E(!1)):"Enter"===e.key?(e.stopPropagation(),null!==en.current&&en.current.length>0?ek():ey()):"ArrowDown"===e.key&&null!==en.current?(e.preventDefault(),ek()):"ArrowUp"===e.key&&null!==en.current&&(e.preventDefault(),ew())},onChange:e=>{P(e.target.value),e.target.value.length>0?ex(H,e.target.value):null!==en.current&&eC()},placeholder:"Find in file...",type:"search",containerClassName:"h-8 w-full sm:w-[400px]",radius:"lg",onCancel:()=>{eC(),P(""),E(!1)},navDownButton:{disabled:null===en.current,onClick:()=>ek()},navUpButton:{disabled:null===en.current||1===Y.globalMark,onClick:()=>ew()},resultText:0!==eo.current.length&&Q>-1?Q>0?{str:"".concat(Y.globalMark," of ").concat(Q),className:"text-tertiary dark:text-tertiary-dark"}:{str:"No Results",className:"text-red-400 dark:text-red-dark-400"}:void 0}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{className:"peer",variant:"tertiary",disabled:!es,icon:y.N.Search,onClick:()=>E(!0)}),(0,i.jsx)(o.M,{...n.Wz.SearchFile,position:"top-10 left-1/2 -translate-x-20"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{className:"peer",variant:"tertiary",icon:y.N.Printer,onClick:()=>{if("application/pdf"===R.mimeType){let e=window.open(ec,"_blank");e&&(e.onload=()=>{e.self.focus(),e.self.print()})}else self.focus(),self.print()}}),(0,i.jsx)(o.M,{...n.Wz.PrintFile,position:"top-10 left-1/2 -translate-x-20"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("a",{href:ev,download:R.filename,className:"peer",children:(0,i.jsx)(b.z,{variant:"tertiary",icon:y.N.Download,onClick:()=>{}})}),(0,i.jsx)(o.M,{...n.Wz.DownloadFile,position:"top-10 left-1/2 -translate-x-20"})]}),(0,i.jsx)("div",{className:"relative hidden sm:block",children:(0,i.jsxs)(a.Z,{items:eE,triggerProps:ej,containerId:"attachment-viewer-content",children:[(0,i.jsx)(b.z,{variant:"tertiary",icon:y.N.ThreeDot,className:"peer group-data-[state=open]/dropdown:bg-fill-primary dark:group-data-[state=open]/dropdown:bg-fill-dark-primary",tabIndex:-1}),(0,i.jsx)(o.M,{...n.Wz.MoreOptions,position:"top-10 right-0"})]})}),(0,i.jsx)("div",{className:"sm:hidden",children:(0,i.jsx)(d.Z,{items:eE,title:"Attachment Viewer Options",triggerProps:ej,containerId:"attachment-viewer-content",children:(0,i.jsx)(b.z,{variant:"tertiary",icon:y.N.ThreeDot,className:"group-data-[state=open]/dropdown:bg-fill-primary dark:group-data-[state=open]/dropdown:bg-fill-dark-primary",tabIndex:-1})})})]})})]}),R.isPreviewable?R.loading?(0,i.jsx)(M,{}):(0,i.jsx)("div",{id:"scrollable-viewer",ref:ed,className:m()("custom-scroll-dark fixed left-1/2 top-0 z-20 mt-14 flex h-[calc(100vh-56px)] w-full -translate-x-1/2 flex-col items-center justify-end overflow-auto text-primary-dark dark:text-primary-dark"),onScroll:eN,onClick:()=>N(),children:(0,i.jsx)("div",{className:m()("h-full w-max max-w-full"),onClick:e=>e.stopPropagation(),children:(0,i.jsxs)(i.Fragment,{children:["application/pdf"===R.mimeType&&eu.data&&(0,i.jsx)(S,{...eT}),(null===(l=R.mimeType)||void 0===l?void 0:l.startsWith("image/"))&&(0,i.jsx)("img",{id:"attachment-image",className:"max-h-[90vh] w-fit max-w-full overflow-x-auto object-contain",style:{width:X?"".concat(X,"px"):"",maxWidth:X?"none":"",maxHeight:X?"none":""},src:ev,title:R.filename}),(null===(r=R.mimeType)||void 0===r?void 0:r.startsWith("video/"))&&(0,i.jsx)("div",{className:"flex h-[180px] max-h-full w-[320px] max-w-full items-center sm:h-[576px] sm:w-[1024px]",children:(0,i.jsx)("iframe",{className:"h-full w-full rounded",src:ev,title:R.filename})})]})})}):(0,i.jsx)("div",{className:"fixed left-1/2 top-0 z-10 flex h-full -translate-x-1/2 items-center",onClick:()=>N(),children:(0,i.jsxs)("div",{className:"h-8 w-[237px] text-center text-body text-primary dark:text-primary-dark",children:["No preview available for that file type."," ",(0,i.jsx)("a",{href:ev,download:R.filename,className:"brand-common-link",children:"Download"})," ","to view."]})}),R.isPreviewable&&!(null===(s=R.mimeType)||void 0===s?void 0:s.startsWith("video/"))&&(0,i.jsxs)("nav",{className:"fixed bottom-5 left-1/2 z-30 flex -translate-x-1/2 items-center gap-3 rounded-lg bg-[#36363680] px-3 py-2 text-primary-dark before:absolute before:inset-0 before:rounded-lg before:shadow-layer-sm before:backdrop-blur-menu before:dark:shadow-control-dark",children:[(0,i.jsx)("div",{className:"relative h-8 border-r-2 border-[#ffffff0d] pr-3 text-body",children:(0,i.jsxs)("span",{className:"flex h-full items-center justify-center gap-1.5",children:[(0,i.jsx)("span",{children:"Page"}),(0,i.jsx)(u.a,{value:F,onChange:e=>eS(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(eI(),e.target.blur())},inputClassName:"text-quartery-dark focus:text-primary-dark text-center !px-2",height:"32px",width:"40px",onFocus:e=>null==e?void 0:e.target.select(),maxLength:z.toString().length}),(0,i.jsx)("span",{children:"/"}),(0,i.jsx)("span",{children:z})]})}),(0,i.jsxs)("div",{className:"dark flex items-center gap-1.5",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{icon:y.N.Minus,disabled:ea.current<=-1,variant:"secondary",className:"peer",onClick:()=>{ef()}}),(0,i.jsx)(o.M,{...n.Wz.ZoomOut,position:"bottom-10 left-1/2 -translate-x-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{icon:!q||(null===(c=R.mimeType)||void 0===c?void 0:c.startsWith("image/"))?y.N.ResetZoom:y.N.FitToWidth,variant:"secondary",className:"peer",disabled:(null===(v=R.mimeType)||void 0===v?void 0:v.startsWith("image/"))&&q,onClick:()=>{var e;!q||(null===(e=R.mimeType)||void 0===e?void 0:e.startsWith("image/"))?eb():eg()}}),(0,i.jsx)(o.M,{title:!q||(null===(p=R.mimeType)||void 0===p?void 0:p.startsWith("image/"))?n.Wz.ResetZoom.title:n.Wz.FitToWidth.title,position:"bottom-10 left-1/2 -translate-x-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(b.z,{icon:y.N.Plus,disabled:ea.current>=5,className:"peer hover:cursor-pointer",variant:"secondary",onClick:()=>{eh()}}),(0,i.jsx)(o.M,{...n.Wz.ZoomIn,position:"bottom-10 left-1/2 -translate-x-8"})]})]})]})]})},R=e=>{let{part:t,message:l}=e,[a,d]=(0,g.useState)(j(t)),[s,u]=(0,g.useState)(E(l)),[v,p]=(0,g.useState)(!1),[h,f]=(0,g.useState)(!1),b=(0,g.useRef)(""),y=(0,g.useRef)({width:800,height:1200}),x=e=>{e?(p(!0),setTimeout(()=>{let e=document.getElementById("attachment-viewer-search-bar");null==e||e.focus()},50)):p(!1)},k=()=>{x(!1),f(!1)};return(0,g.useCallback)((e,t)=>{d(e=>({...e,...t})),u(l=>({...l,[e]:{...l[e],...t}}))},[a.raw.partId]),(0,i.jsxs)(c.fC,{open:h,children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(c.xz,{className:m()("peer"),id:"attachment-".concat(a.filename),onClick:()=>f(!0),children:(0,i.jsx)(r.Y,{attachment:a,idx:0,message:l})}),(0,i.jsx)(o.M,{...n.Wz.AttachmentOpen,position:"top-[46px] left-[calc(50%-59px)]"})]}),(0,i.jsxs)(c.h_,{children:[(0,i.jsx)(c.aV,{className:"overlay fixed inset-0 z-10 bg-[#000000ed] duration-100"}),(0,i.jsx)(c.VY,{id:"attachment-viewer-content",onWheel:e=>e.stopPropagation(),className:"dark",onEscapeKeyDown:e=>{e.stopPropagation(),k()},onKeyDown:e=>{var t,l,i,n,r,o;e.stopPropagation();let d=e.metaKey&&(null===(i=window)||void 0===i?void 0:null===(l=i.navigator)||void 0===l?void 0:null===(t=l.platform)||void 0===t?void 0:t.indexOf("Mac"))===0||e.ctrlKey&&!(null===(o=window)||void 0===o?void 0:null===(r=o.navigator)||void 0===r?void 0:null===(n=r.platform)||void 0===n?void 0:n.includes("Mac"));if("Escape"===e.key)k();else if(d){if("f"===e.key.toLowerCase())e.preventDefault(),x(!0);else if("p"===e.key.toLowerCase()&&"application/pdf"===a.mimeType){e.preventDefault();let t=window.open(b.current,"_blank");t&&(t.onload=()=>{t.self.focus(),t.self.print()})}}},onPointerDownOutside:e=>{e.stopPropagation(),e.preventDefault(),k()},onCloseAutoFocus:e=>{e.preventDefault()},onOpenAutoFocus:e=>{e.preventDefault();let t=document.getElementById("attachment-viewer-content");t&&t.focus()},children:(0,i.jsx)(L,{message:l,attachment:a,attachments:s,isSearchOpen:v,pdfDimensions:y,pdfPrintReference:b,closeModal:k,setIsSearchOpen:x,setAttachments:u})})]})]})}},63372:function(e,t,l){"use strict";l.d(t,{M:function(){return d}});var i=l(44003),n=l(61808),r=l.n(n),o=l(62516);let a=["⌘","Ctrl","Shift","⇧"],d=e=>{var t,l,n;let{keys:d,title:s,position:u="left-[176px] top-1",top:c,left:v,opaque:m}=e,p=(null===(n=window)||void 0===n?void 0:null===(l=n.navigator)||void 0===l?void 0:null===(t=l.platform)||void 0===t?void 0:t.indexOf("Mac"))===0;return(0,i.jsxs)("div",{className:r()("support invisible absolute z-10 flex items-center gap-1 rounded px-2 py-1.5 opacity-0 shadow-layer-sm backdrop-blur-menu transition-opacity duration-[175ms] peer-hover:visible peer-hover:opacity-100 dark:shadow-control-dark",u,{"bg-[#F8F8F8] dark:bg-[#343434]":m},{"bg-[#F8F8F8]/80 dark:bg-[#383838]/80":!m}),style:{top:null!=c?c:void 0,left:null!=v?v:void 0,willChange:"transform",WebkitFontSmoothing:"antialiased"},children:[(0,i.jsx)("span",{className:r()("support block select-none whitespace-nowrap !leading-5",{"mr-0.5":d&&d.length>0}),children:s}),d&&d.map((e,t)=>{let l="⌘"===e,n="⌥"===e;return(0,i.jsxs)(o.Fragment,{children:[t>0&&!a.includes(d[0])&&(0,i.jsx)("span",{className:"select-none text-secondary dark:text-secondary-dark",children:"then"}),(0,i.jsx)("div",{className:"flex h-5 min-w-[20px] select-none items-center justify-center rounded-sm bg-white text-primary shadow-key dark:bg-fill-dark-base dark:text-primary-dark "+("⌫"===e?" pl-1":"")+((l||n)&&p?"":" px-[5px]"),children:l&&!p?"Ctrl":n&&!p?"Alt":e})]},t)})]})}},40911:function(e,t,l){"use strict";l.d(t,{l:function(){return r}});var i=l(44003),n=l(63372);let r=e=>{let{children:t,onClick:l,tooltip:r}=e;return(0,i.jsxs)("button",{tabIndex:-1,className:"group/ctc relative",onClick:e=>{l(e)},children:[(0,i.jsx)("div",{className:"peer flex items-center gap-1.5",children:t}),r&&(0,i.jsx)(n.M,{...r})]})}},26031:function(e,t,l){"use strict";l.d(t,{Z:function(){return a}});var i=l(44003),n=l(89151),r=l(61808),o=l.n(r);function a(e){var t,l;let{children:r,containerId:a,items:d,title:s,triggerProps:u}=e;return(0,i.jsxs)(n.fC,{modal:!0,children:[(0,i.jsx)(n.xz,{...u,children:r}),(0,i.jsx)(n.Uv,{container:a?null===(t=document)||void 0===t?void 0:t.getElementById(a):null===(l=document)||void 0===l?void 0:l.getElementById("main-page"),children:(0,i.jsxs)(n.VY,{collisionPadding:8,sideOffset:4,align:"start",className:"dropdownContent z-30 min-w-[200px] rounded-lg bg-fill-overlay shadow-layer-md backdrop-blur-menu duration-175 dark:bg-fill-dark-overlay dark:shadow-control-dark",children:[(0,i.jsx)("div",{className:"border-b border-border-primary px-5 py-3 text-support text-tertiary dark:border-border-dark-primary dark:text-tertiary-dark",children:s}),(0,i.jsx)("div",{className:"max-h-[60dvh] overflow-y-auto",children:d.map((e,t)=>{var l;return e.type&&"item"!==e.type||e.disabled?null:(0,i.jsxs)(n.ck,{className:"body flex h-12 items-center justify-between gap-3 px-5",onSelect:e.onSelect,children:[null!==(l=e.jsxContent)&&void 0!==l?l:e.label,e.icon&&"string"==typeof e.icon&&(0,i.jsx)("div",{className:"flex gap-x-1.5",children:e.icon.split(" ").map((e,t)=>" "===e?null:(0,i.jsx)("span",{className:o()("inline-flex min-w-[20px] shrink-0 items-center justify-center rounded bg-base px-[5px] py-[3px] text-support text-secondary shadow-key dark:bg-base-dark dark:text-secondary-dark"),children:e},t))})]},t)})})]})})]})}l(60036)},6566:function(e,t,l){"use strict";l.d(t,{a:function(){return s}});var i=l(44003),n=l(61808),r=l.n(n),o=l(62516),a=l(39359),d=l(50026);let s=e=>{var t,l,n;let{id:s,name:u,label:c,value:v,disabled:m=!1,placeholder:p,autoFocus:h,defaultValue:f,type:g,height:b,width:y,radius:x="md",containerClassName:k,inputClassName:w,maxLength:C,resultText:S,navUpButton:I,navDownButton:N,onKeyDown:T,onSubmit:j,onChange:E,onCancel:M,onFocus:A}=e,[D,L]=(0,o.useState)(!1);return(0,i.jsxs)("div",{className:r()("flex flex-col text-body",{"gap-1.5":c}),children:[c&&(0,i.jsx)("label",{htmlFor:u,className:"text-tertiary dark:text-tertiary-dark",children:c}),(0,i.jsxs)("div",{className:r()("relative inline-flex text-primary dark:text-primary-dark","border border-border-primary focus-within:bg-fill-input dark:border-border-dark-primary dark:focus-within:bg-fill-dark-input",{"hover:border-border-secondary hover:dark:border-border-dark-secondary":!m},{rounded:"md"===x},{"rounded-lg":"lg"===x},k,{"h-8 w-[200px]":!(k||b||y)},{"animate-error":D}),style:{height:b,width:y},children:[(0,i.jsx)("input",{id:s,name:u,value:v,disabled:m,maxLength:C,onChange:E,onSubmit:j,onKeyDown:e=>{var t;if(((null==v?void 0:null===(t=v.toString())||void 0===t?void 0:t.length)||0)>=(C||0)&&1===e.key.length){e.preventDefault(),L(!0),setTimeout(()=>{L(!1)},500);return}null==T||T(e)},className:r()("block w-full !appearance-none bg-transparent px-3 py-2 outline-none placeholder:text-quartery dark:placeholder:text-quartery-dark",w,""),placeholder:p,autoFocus:h,onFocus:A,defaultValue:f}),(0,i.jsxs)("span",{className:r()("flex items-center justify-end gap-3",{"mr-1":S||N||I||"search"===g}),children:[S&&(0,i.jsx)("span",{className:r()(S.className,"max-w-[85px] truncate"),children:S.str}),(0,i.jsxs)("span",{className:"flex flex-row gap-0.5",children:[I&&(0,i.jsx)(a.r,{...I,icon:d.N.UpChevron,variant:"tertiary",size:"sm"}),N&&(0,i.jsx)(a.r,{...N,icon:d.N.DownChevron,variant:"tertiary",size:"sm"}),C&&(0,i.jsxs)("span",{className:r()("w-max pr-3",{"text-primary dark:text-primary-dark":((null==v?void 0:null===(t=v.toString())||void 0===t?void 0:t.length)||0)>=C,"text-tertiary dark:text-tertiary-dark":((null==v?void 0:null===(l=v.toString())||void 0===l?void 0:l.length)||0)<C}),children:[(null==v?void 0:null===(n=v.toString())||void 0===n?void 0:n.length)||0,"/",C||"∞"]})]}),"search"===g&&(0,i.jsx)(a.r,{label:"Cancel",variant:"tertiary",size:"sm",onClick:M})]})]})]})}},50025:function(e,t,l){"use strict";l.d(t,{j:function(){return i}});let i=e=>{let t=["B","KB","MB","GB","TB"],l=e;if(l)for(let e in t){if(l<1024)return l.toFixed(1)+" "+t[e];l/=1024}return String(l)}},31097:function(e,t,l){"use strict";l.d(t,{CX:function(){return s},LN:function(){return u},eh:function(){return a},lS:function(){return d}});let i=(e,t,i)=>{let a=navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof l.g&&l.g.global===l.g?l.g:void 0;if("download"in HTMLAnchorElement.prototype&&!a){let l=d.URL||d.webkitURL,a=document.createElementNS("http://www.w3.org/1999/xhtml","a");t=t||e.name||"download",a.download=t,a.rel="noopener","string"==typeof e?(a.href=e,a.origin!==location.origin&&r(a.href)?n(e,t,i):o(a)):(a.href=l.createObjectURL(e),setTimeout(function(){l.revokeObjectURL(a.href)},4e4),setTimeout(function(){o(a)},0))}else if("msSaveOrOpenBlob"in navigator){if(t=t||e.name||"download","string"==typeof e){if(r(e))n(e,t,i);else{let t=document.createElement("a");t.href=e,t.target="_blank",setTimeout(function(){o(t)})}}else{var s;d.msSaveOrOpenBlob((void 0===(s=i)?s={autoBom:!1}:"object"!=typeof s&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type))?new Blob([String.fromCharCode(65279),e],{type:e.type}):e,t)}}else{let l=open("","_blank");if(l&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,i);let r="application/octet-stream"===e.type,o=/constructor/i.test(window.HTMLElement)||window.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||r&&o||a)&&"undefined"!=typeof FileReader){let t=new FileReader;t.onloadend=function(){let e=t.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},t.readAsDataURL(e)}else{let t=window.URL||window.webkitURL,i=t.createObjectURL(e);l?l.location=i:location.href=i,l=null,setTimeout(function(){t.revokeObjectURL(i)},4e4)}}};function n(e,t,l){let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){i(n.response,t,l)},n.onerror=function(){console.error("could not download file")},n.send()}function r(e){let t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(l){let t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}let a=(e,t)=>"data:".concat(e,";base64,").concat(t.replace(/-/g,"+").replace(/_/g,"/")),d=(e,t,l)=>{fetch(a(e,t)).then(e=>e.arrayBuffer()).then(t=>{i(new File([new Blob([t],{type:e})],l,{type:e}),l,{autoBom:!0})})},s=e=>{if(!e.data)return;let t=a(e.mimeType||"",(null==e?void 0:e.data)||""),l=";base64,",i=t.indexOf(l)+l.length,n=t.substring(i),r=window.atob(n),o=r.length,d=new Uint8Array(new ArrayBuffer(o));for(let e=0;e<o;e++)d[e]=r.charCodeAt(e);return d},u=(e,t)=>{let l=new Blob([null!=e?e:""],{type:null!=t?t:void 0});return URL.createObjectURL(l)}},5965:function(e,t,l){"use strict";l.d(t,{A:function(){return n}});let i=l(58145).a,n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(e){var l,n;if(i[e])return t?i[e].substring(0,t):i[e];if(e&&e.split(".").length>1)return t?null===(l=e.split(".").pop())||void 0===l?void 0:l.substring(0,t):e.split(".").pop();if(e.split(".").length>1)return t?null===(n=e.split(".").pop())||void 0===n?void 0:n.substring(0,t):e.split(".").pop()}return"-"}},58145:function(e,t,l){"use strict";l.d(t,{a:function(){return i},f:function(){return n}});let i={"image/svg+xml":"svg","image/bmp":"bmp","image/png":"png","image/jpeg":"jpg","image/tiff":"tiff","image/webp":"webp","image/pict":"pct","image/gif":"gif","image/icns":"icsn","image/vnd.microsoft.icon":"ico","image/x-icon":"ico","text/plain":"txt","text/html":"html","text/css":"css","text/csv":"csv","text/markdown":"md","text/md":"md","text/x-vcard":"vcf","application/json":"json","application/xml":"xml","application/rtf":"rtf","application/pdf":"pdf","application/msword":"doc","application/vnd.ms-word":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/ms-powerpointtd":"ppt","application/vnd.ms-powerpointtd":"ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/ms-excel":"xls","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","audio/x-midi":"midi","audio/mpeg":"mp3","audio/wav":"wav","audio/x-wav":"wav","audio/ogg":"ogg","audio/vorbis":"ogg","video/mp4":"mp4","video/webm":"webm","video/avi":"avi","video/mpg":"mpg","video/ogg":"ogv","video/quicktime":"mov","application/zip":"zip","application/x-compressed-zip":"zip","application/x-compressed":"zip","multipart/x-zip":"zip","font/opentype":"otf","font/ttf":"ttf","font/ttc":"ttc","font/woff":"woff","application/postscript":"ai","image/vnd.adobe.photoshop":"psd","application/x-photoshop":"psd","application/photoshop":"psd","application/psd":"psd","image/psd":"psd"},n={"application/pdf":"text-red-700 dark:text-red-dark-700","application/vnd.ms-powerpoint":"text-red-600 dark:text-red-dark-600","application/vnd.openxmlformats-officedocument.presentationml.presentation":"text-red-600 dark:text-red-dark-600","application/msword":"text-blue-700 dark:text-blue-dark-700","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"text-blue-700 dark:text-blue-dark-700","application/vnd.ms-excel":"text-green-700 dark:text-green-dark-700","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text-green-700 dark:text-green-dark-700","application/zip":"text-yellow-600 dark:text-yellow-dark-600","application/x-compressed-zip":"text-yellow-600 dark:text-yellow-dark-600","application/x-compressed":"text-yellow-600 dark:text-yellow-dark-600","multipart/x-zip":"text-yellow-600 dark:text-yellow-dark-600","image/vnd.adobe.photoshop":"text-blue-600 dark:text-blue-dark-600","application/x-photoshop":"text-blue-600 dark:text-blue-dark-600","application/photoshop":"text-blue-600 dark:text-blue-dark-600","application/psd":"text-blue-600 dark:text-blue-dark-600","image/psd":"text-blue-600 dark:text-blue-dark-600","text/csv":"text-green-600 dark:text-green-dark-600"}},78488:function(e,t,l){"use strict";l.d(t,{P:function(){return i}});let i=(e,t)=>{let l=RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),i=RegExp("mailto:(?:[a-zA-Z0-9!#$&'*+/=?^_`{|}~-]|%[0-9a-fA-F]{2})+(?:.(?:[a-zA-Z0-9!#$&'*+/=?^_`{|}~-]|%[0-9a-fA-F]{2})+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?","i"),n=new RegExp(/^(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}.[a-zA-Z]{2,3})$/i);return e.length<2083&&(l.test(e)||i.test(e)||t&&n.test(e))}},80571:function(e,t,l){"use strict";l.d(t,{F:function(){return n},v:function(){return i}});let i=e=>/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e),n=e=>{let t=e.match(/^([^<>]+) <([^<>]+)>$/);return!!t&&/^[^<>]+ <[^\s<>]+@[^\s<>]+\.[^\s<>]+>$/.test(e)&&i(t[2])}},19959:function(e,t,l){"use strict";l.d(t,{C_:function(){return ee},uC:function(){return et},F3:function(){return el},Iz:function(){return Y},a1:function(){return $}});var i=l(44003),n=l(60136),r=l(17115),o=l(27799),a=l(80672),d=l(39635),s=l(70137),u=l(3984),c=l(44424),v=l(63372),m=l(39359),p=l(98506),h=l(50026),f=l(16502),g=l(61808),b=l.n(g),y=l(80930),x=l.n(y),k=l(55028),w=l(1394),C=l(87502),S=l(87767),I=l(62516),N=l(8562),T=l(93629),j=l(87355);let E=e=>{let{numAttachments:t,firstFileName:l}=e;return(0,i.jsxs)("div",{className:"relative flex h-6 w-6 items-center justify-center "+N.X,children:[(0,i.jsx)("span",{className:"peer",children:(0,i.jsx)(j.J,{path:h.N.AttachmentTilt,className:"h-4 w-4 text-tertiary dark:text-tertiary-dark"})}),(0,i.jsx)(v.M,{title:t>1?"".concat(t," Attachments"):l,position:"sm:top-8 top-6 left-1/2 -translate-x-10 peer-hover:delay-300 font-normal"})]})};var M=l(9112);let A=e=>{let{date:t}=e;return(0,i.jsxs)("div",{className:"relative flex h-6 w-6 items-center justify-center "+N.X,children:[(0,i.jsx)("span",{className:"peer",children:(0,i.jsx)(j.J,{path:h.N.Calendar,className:"h-4 w-4 text-tertiary dark:text-tertiary-dark"})}),(0,i.jsx)(v.M,{title:t.toLocaleString("en-us",M.V).replace(/(,)(?!.*\1)/," at"),position:"sm:top-8 top-6 left-1/2 -translate-x-10 peer-hover:delay-300 font-normal"})]})},D=["s","e","u","1","!","l","L","<",",",">",".",'"',"'","Backspace","o","r","f"],L=(0,w.Pi)(e=>{var t,l,n,g,y,w,j,M,L,F,B,z,_,H,P,U,W,q,K,V,J,X,G,Q,Z,$,et,el,ei,en,er,eo,ea,ed,es,eu,ec,ev,em,ep,eh,ef,eg,eb;let{index:ey,style:ex,data:ek}=e,{data:ew,isHoverActive:eC,cachedAPIContent:eS,listRef:eI,setCurrentThreadIndex:eN,currentLabel:eT,isMobile:ej,isTablet:eE,userLabels:eM,cannotArchive:eA,isLoadingMore:eD,workspaceUrl:eL,archiveToggleThreads:eR,deleteToggleThreads:eO,starToggleThreads:eF,spamToggleThreads:eB,unreadToggleThreads:ez,changeThreadLabels:e_,blockSenderAction:eH}=ek,{uiStore:eP,supabaseStore:eU,sidebarStore:eW,keyboardStore:eq,commandMenuStore:eK,syncStore:eV,inboxStore:eJ,labelStore:eX,toastStore:{addToast:eG},searchStore:eQ,modalsStore:eZ}=(0,u.m)(),eY=(0,S.useRouter)(),e$=(0,S.usePathname)(),e0=ew[ey],e1=null==e0?void 0:e0.messages,e2=e1?null==e1?void 0:e1.at(-1):null,e5=eT.includes("INBOX")?"INBOX":eT,e3=e1?null!==(eu=null===(t=(0,o.zJ)(e1,e5,!0))||void 0===t?void 0:t.at(-1))&&void 0!==eu?eu:e2:null,e6=e1?null!==(ec=null===(l=(0,o.zJ)(e1,e5,!1))||void 0===l?void 0:l.at(-1))&&void 0!==ec?ec:e2:null,[e4,e8]=(0,I.useState)(void 0),e9=(0,I.useMemo)(()=>{if(e$.includes("/search/")){var e,t,l,i,n,r,a,d,s,u,c;if(null==eQ?void 0:null===(e=eQ.searchQuery)||void 0===e?void 0:e.includes(":"))return null==e3?void 0:e3.snippet;if(null==e3?void 0:null===(i=e3.snippet)||void 0===i?void 0:null===(l=i.toLowerCase())||void 0===l?void 0:l.includes(null===(t=eQ.searchQuery)||void 0===t?void 0:t.toLowerCase()))return O(null==e3?void 0:e3.snippet,null==eQ?void 0:eQ.searchQuery);{let e=null===(n=(0,o.QS)(null==e3?void 0:e3.payload,"text/plain"))||void 0===n?void 0:n.at(0);if(null==e?void 0:null===(r=e.body)||void 0===r?void 0:r.data){let t=null===(a=(0,k.Jx)(null==e?void 0:null===(d=e.body)||void 0===d?void 0:d.data))||void 0===a?void 0:a.replace(/(?:https?|ftp):\/\/[\n\S]+/g,""),l=null==t?void 0:t.toLowerCase(),i=null==l?void 0:l.indexOf(null==eQ?void 0:null===(s=eQ.searchQuery)||void 0===s?void 0:s.toLowerCase());if(i>=0){let e=null===(u=l.slice(0,i-1))||void 0===u?void 0:u.lastIndexOf(" "),n=null===(c=l.slice(0,e-1))||void 0===c?void 0:c.lastIndexOf(" ");return O(null==t?void 0:t.slice(n,i+80),null==eQ?void 0:eQ.searchQuery)}}}}return null==e3?void 0:e3.snippet},[null==e3?void 0:e3.snippet,e$]);(0,I.useEffect)(()=>{var e,t,l,i;if(e1&&(null==e3?void 0:null===(e=e3.payload)||void 0===e?void 0:e.parts)&&!e4){if(e3.id&&eS.current.has(e3.id)){let e=null===(l=eS.current.get(e3.id))||void 0===l?void 0:l.invitationData;if(e&&e.hasInvitation){e8(e.firstDate);return}}let e=null;for(let l=0;l<(null==e3?void 0:null===(t=e3.payload)||void 0===t?void 0:t.parts.length);l++){let t=null==e3?void 0:null===(i=e3.payload)||void 0===i?void 0:i.parts[l];if(t&&("text/calendar"===t.mimeType||t.filename&&t.filename.endsWith(".ics"))){e=t;break}}if(e){let t=(0,c.KN)(e);(0,c.ce)({part:t.raw,message:e3,onStarted:()=>{},onCompleted:e=>{let t=atob(e.data.replace(/-/g,"+").replace(/_/g,"/")),l=x().parseICS(t);for(let e in l)if(l.hasOwnProperty(e)&&"VEVENT"===l[e].type){var i;let t=new Date(null!==(i=l[e].start)&&void 0!==i?i:"");e8(t);let n=eS.current;e3.id&&(n.set(e3.id,{invitationData:{hasInvitation:!0,firstDate:t}}),eS.current=n)}},onError:e=>{e8(void 0)}})}}},[null==e3?void 0:null===(n=e3.payload)||void 0===n?void 0:n.parts]);let e7=(0,I.useMemo)(()=>{var e,t,l;return null!==(l=null==e3?void 0:null===(t=e3.payload)||void 0===t?void 0:null===(e=t.headers)||void 0===e?void 0:e.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))&&void 0!==l?l:{name:"From",value:""}},[null==e3?void 0:null===(g=e3.payload)||void 0===g?void 0:g.headers]),te=(0,I.useMemo)(()=>{var e,t,l;return null!==(l=null==e3?void 0:null===(t=e3.payload)||void 0===t?void 0:null===(e=t.headers)||void 0===e?void 0:e.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="to"}))&&void 0!==l?l:{name:"To",value:""}},[null==e3?void 0:null===(y=e3.payload)||void 0===y?void 0:y.headers]),tt=(0,I.useMemo)(()=>"SENT"===eT,[eT]),tl=(0,I.useMemo)(()=>{var e;return null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("DRAFT")},[null==e3?void 0:e3.labelIds]),ti=(0,I.useMemo)(()=>{var e,t;return(0,o.Pb)(tt||tl?null==te?void 0:null===(t=te.value)||void 0===t?void 0:null===(e=t.replaceAll("<",""))||void 0===e?void 0:e.replaceAll(">",""):null==e7?void 0:e7.value)},[tt,tl,null==te?void 0:te.value,null==e7?void 0:e7.value]),tn=(0,I.useMemo)(()=>{var e,t,l,i,n;return null!==(n=null==e1?void 0:null===(i=e1.at(0))||void 0===i?void 0:null===(l=i.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:null===(e=t.find(e=>"Subject"===e.name))||void 0===e?void 0:e.value)&&void 0!==n?n:""},[e1]),tr=(0,I.useMemo)(()=>{var e;return e$.includes("/search/")&&(null==tn?void 0:tn.toLowerCase().includes(null===(e=eQ.searchQuery)||void 0===e?void 0:e.toLowerCase()))?O(tn,eQ.searchQuery):tn},[tn,e$]),to=(0,I.useMemo)(()=>Array.isArray(e1)?[...e1].reverse().map(e=>{var t,l,i;return null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:null===(t=l.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===t?void 0:t.value}).filter(e=>{var t,l;return!!e&&!e.includes(null!==(l=null===(t=eU.userData)||void 0===t?void 0:t.email)&&void 0!==l?l:"")}):[],[e1,null===(w=eU.userData)||void 0===w?void 0:w.email]),ta=(0,I.useMemo)(()=>null==to?void 0:to.filter((e,t)=>to.indexOf(e)===t),[to]),td=new Date(parseInt(null!==(ev=null==e6?void 0:e6.internalDate)&&void 0!==ev?ev:"")),ts=(0,I.useMemo)(()=>{var e;return null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("UNREAD")},[null==e3?void 0:e3.labelIds]),tu=(0,I.useMemo)(()=>{var e,t;return e$.includes("search")&&e1?!!e1.find(e=>e.labelIds.includes("STARRED")):null!==(t=null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("STARRED"))&&void 0!==t&&t},[null==e3?void 0:null===(j=e3.labelIds)||void 0===j?void 0:j.length,e$]),tc=(0,I.useMemo)(()=>{var e;return!(null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("INBOX"))},[null==e3?void 0:e3.labelIds]),tv=(0,I.useMemo)(()=>{var e;return null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("SPAM")},[null==e3?void 0:e3.labelIds]),tm=(0,I.useMemo)(()=>{var e;return null==e3?void 0:null===(e=e3.labelIds)||void 0===e?void 0:e.includes("TRASH")},[null==e3?void 0:e3.labelIds]),tp=(0,o.AK)(td),th=JSON.stringify(eq.selectedIndices).includes("[1,".concat(ey,"]")),tf=JSON.stringify(eq.currentIndex)==="[1,".concat(ey,"]"),{numAttachments:tg=0,firstFileName:tb=""}=null!==(em=null==e1?void 0:e1.reduce((e,t)=>{var l;if(null==t?void 0:null===(l=t.payload)||void 0===l?void 0:l.parts){let{count:l,firstFileNameInMessage:i}=(0,o.RZ)(t);e.numAttachments+=l,0===e.firstFileName.length&&(e.firstFileName=i)}return e},{numAttachments:0,firstFileName:""}))&&void 0!==em?em:{},ty=(0,I.useMemo)(()=>e1&&(null==e1?void 0:e1.find(e=>{var t;return!!(null===(t=(0,o.QS)(null==e?void 0:e.payload,"application/ics"))||void 0===t?void 0:t.length)})),[e1]),tx=(0,I.useMemo)(()=>null==ta?void 0:ta.filter(e=>"string"==typeof e),[ta]),tk=(0,I.useMemo)(()=>{var e,t;return(null===(e=eU.userData)||void 0===e?void 0:e.user_metadata.full_name)+" <"+(null===(t=eU.userData)||void 0===t?void 0:t.email)+">"},[null===(M=eU.userData)||void 0===M?void 0:M.user_metadata.full_name,null===(L=eU.userData)||void 0===L?void 0:L.email]),tw=0,tC=(0,I.useMemo)(()=>{var e,t,l,n,r,a,d,s,u,c,v;return tt||tl||(null==e7?void 0:null===(t=e7.value)||void 0===t?void 0:t.includes(null!==(u=null===(e=eU.userData)||void 0===e?void 0:e.email)&&void 0!==u?u:"hello@tatem.com"))?(0,i.jsx)(R,{displayedName:tt||tl?(null==te?void 0:null===(n=te.value)||void 0===n?void 0:n.includes(null!==(c=null===(l=eU.userData)||void 0===l?void 0:l.email)&&void 0!==c?c:"hello@tatem.com"))?"Me":null===(r=(0,o.KJ)(null==te?void 0:te.value))||void 0===r?void 0:r.replaceAll('"',""):"Me",hoverName:tt||tl?(null==te?void 0:null===(d=te.value)||void 0===d?void 0:d.includes(null!==(v=null===(a=eU.userData)||void 0===a?void 0:a.email)&&void 0!==v?v:"hello@tatem.com"))?tk:null==te?void 0:null===(s=te.value)||void 0===s?void 0:s.trim().replaceAll('"',""):tk,hoverOffset:tl?54:0,searchStore:eQ}):tx.map((e,t)=>{var l;let n=null===(l=(0,o.KJ)(e))||void 0===l?void 0:l.replaceAll('"',""),r=6*tw;return tw+=n.length+2,(0,i.jsx)(R,{count:t,displayedName:n,hoverName:e.trim().replaceAll('"',""),hoverOffset:r,searchStore:eQ},t)})},[e1]),tS=null==e3?void 0:null===(F=e3.labelIds)||void 0===F?void 0:F.map(e=>eM.find(t=>t.id===e)).filter(e=>!!e&&!e.name.includes("[Tatem]")),tI=Number(null!==(ep=null==ex?void 0:ex.height)&&void 0!==ep?ep:0)>Math.round(ej?tg>0||e4||(null!==(eh=null==tS?void 0:tS.length)&&void 0!==eh?eh:0)>0?122.5:86.5:50.5);if(!e1)return null;let tN=(0,I.useCallback)(async e=>{var t,l,i,n,d,s,u,c,v,m,p,h,g,b,y,x,k,w,C,S;let I;let N=(null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key,j=eq.selectedIndices.length>1,E=(j?eq.selectedIndices.map(e=>{var t;return null===(t=ew[e[1]])||void 0===t?void 0:t.id}):1===eq.selectedIndices.length?[null===(l=ew[eq.selectedIndices[0][1]])||void 0===l?void 0:l.id]:[null===(i=ew[ey])||void 0===i?void 0:i.id]).map(e=>ew.find(t=>(null==t?void 0:t.id)===e)).filter(e=>void 0!==e);if(!E)return;let M=E.map(e=>e.id),A=!E.some(e=>{var t;return null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.some(e=>e.labelIds.includes("INBOX"))}),D=ee.includes(e5),L=E.flatMap(e=>e.messages.map(e=>e.id));switch(N){case"s":if(e.shiftKey||(0,r.xN)(e))break;let R=E.some(e=>!!e&&e.messages.some(e=>e.labelIds.includes("STARRED")));I=(0,a.pJ)(R,M,j,E),eF({hasLabel:R,threadIds:M,emailIds:L,toastProps:I}),eq.setSelectedIndices([]);break;case"e":if(e.shiftKey){if(!A||(0,r.SE)(e)||D)return;I=(0,a.pJ)(!0,M,j,E),eR({hasLabel:!0,threadIds:M,emailIds:L,toastProps:I}),eq.setSelectedIndices([])}else{if(A||(0,r.SE)(e)||D)break;let t=null==E?void 0:E.flatMap(e=>{var t,l;return null==e?void 0:null===(l=e.messages)||void 0===l?void 0:null===(t=l.filter(e=>A||e.labelIds.includes("INBOX")))||void 0===t?void 0:t.map(e=>e.id)});I=(0,a.pJ)(!1,M,j,E),eR({hasLabel:!1,threadIds:M,emailIds:t,toastProps:I}),eq.setSelectedIndices([])}break;case"u":if(e.shiftKey)break;if((0,r.xN)(e)){if(e.preventDefault(),E.every(e=>{var t;return null===(t=e.messages)||void 0===t?void 0:t.find(e=>{var t,l;return null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:t.find(e=>"List-Unsubscribe"===e.name)})}))1===E.length&&(eK.setPages(["Unsubscribe"]),eK.setOpenedExternally(!0),eK.setCommandMenuOpen(!0));else if(1===E.length){let e=null==e7?void 0:e7.value,t="".concat(null==e?void 0:null===(n=e.split("@"))||void 0===n?void 0:n.join("".concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203))));eZ.setAlertModalObj({alertMsg:"Block sender instead?",alertDescription:"We can’t find a link to unsubscribe. Would you like to block the sender instead? This will delete all messages, including future messages, from ".concat(t,"."),alertCode:f.xK.BLOCK_SENDER,onConfirm:{title:"Block",onClick:()=>{eH({email:e,isSenderBlocked:!1})}},onClose:{title:"Cancel"}}),eZ.setAlertModalOpen(!0)}}else{let e=E.some(e=>{var t;return null===(t=e.messages)||void 0===t?void 0:t.find(e=>{var t;return null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("UNREAD")})});I=(0,a.pJ)(!e,M,j,E),ez({hasLabel:e,threadIds:M,emailIds:L,toastProps:I})}break;case"1":if(e.metaKey&&e.shiftKey&&r.V5){e.preventDefault();let t=E.some(e=>{var t;return null===(t=e.messages)||void 0===t?void 0:t.find(e=>{var t;return null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("SPAM")})});if(!t)return;I=(0,a.pJ)(t,M,j,E),eB({isSpam:!0,threadIds:M,emailIds:L,toastProps:I,isArchived:!1,isTrash:!1}),eq.setSelectedIndices([])}break;case"!":let O=E.some(e=>{var t;return null===(t=e.messages)||void 0===t?void 0:t.find(e=>{var t;return null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("SPAM")})});if(e.preventDefault(),O)e.ctrlKey&&(I=(0,a.pJ)(O,M,j,E),eB({isSpam:!0,threadIds:M,emailIds:L,toastProps:I,isArchived:!1,isTrash:!1}));else{if((0,r.xN)(e))break;let t=E.some(e=>e.messages.find(e=>e.labelIds.includes("TRASH")));I=(0,a.pJ)(O,M,j,E),eB({isSpam:!1,threadIds:M,emailIds:L,toastProps:I,isArchived:A,isTrash:t})}eq.setSelectedIndices([]);break;case"Backspace":let F=E.some(e=>e.messages.find(e=>e.labelIds.includes("TRASH")));if(F)(0,r.SE)(e)&&e.shiftKey&&(e.preventDefault(),I=(0,a.pJ)(F,M,j,E),eO({isTrash:!0,threadIds:M,emailIds:L,toastProps:I,isSpam:!1,isArchived:!1}));else if((0,r.SE)(e)&&!e.shiftKey){e.preventDefault();let t=E.some(e=>e.messages.find(e=>e.labelIds.includes("SPAM")));I=(0,a.pJ)(F,M,j,E),eO({isTrash:!1,threadIds:M,emailIds:L,toastProps:I,isArchived:A,isSpam:t}),eq.setSelectedIndices([])}break;case"l":if(e.preventDefault(),!(0,r.xN)(e)){if(e.shiftKey){if(E.length>0){if(E.every(e=>0===e.messages[0].labelIds.filter(e=>e.startsWith("Label_")).length))return;E.every(e=>e.messages[0].labelIds.filter(e=>e.startsWith("Label_")).length<=1)?(E.forEach(e=>{var t,l,i;let n=null==e?void 0:null===(l=e.messages)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.labelIds.find(e=>e.startsWith("Label_")),r=null==e?void 0:null===(i=e.messages)||void 0===i?void 0:i.map(e=>e.id);n&&r&&e_({hasLabel:!0,threadIds:[null==e?void 0:e.id],emailIds:r,labelIds:[n],subject:tn})}),eG(T.t.lambdas.LabeledConversation({isActive:!0,primaryText:"Label",count:E.length})),eq.setSelectedIndices([])):(eK.setCommandMenuOpen(!0),eK.setPages(["Remove Labels"]))}}else eK.setCommandMenuOpen(!0),eK.setPages(["Add Labels"])}break;case"<":if((0,r.SE)(e)&&!r.V5){e.preventDefault();let t=M.map(e=>window.location.origin+window.location.pathname+"/thread/"+e),l=window.location.href,i=t.join("\n");navigator.clipboard.writeText(i),eG(T.t.lambdas.ConversationUrlCopied({count:t.length,href:null!==(d=null==t?void 0:t.at(0))&&void 0!==d?d:l}))}break;case",":if(r.V5&&e.shiftKey&&e.metaKey){e.preventDefault();let t=M.map(e=>window.location.origin+window.location.pathname+"/thread/"+e),l=window.location.href,i=t.join("\n");navigator.clipboard.writeText(i),eG(T.t.lambdas.ConversationUrlCopied({count:t.length,href:null!==(s=null==t?void 0:t.at(0))&&void 0!==s?s:l}))}break;case">":if(!r.V5&&e.ctrlKey){e.preventDefault();let t=E.map(e=>{var t,l,i,n,r;let a=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,o.e6)(null!==(r=null==a?void 0:null===(n=a.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==r?r:"")}),l=t.join("\n");navigator.clipboard.writeText(l),eG(T.t.lambdas.SenderAddressCopied({primaryText:l,count:t.length}))}break;case'"':if(!r.V5&&e.ctrlKey){e.preventDefault();let t=E.map(e=>{var t,l,i,n;let r=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return null==r?void 0:null===(n=r.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>(null==e?void 0:e.name)==="Subject"))||void 0===l?void 0:l.value}),l=t.join("\n");navigator.clipboard.writeText(l),eG(T.t.lambdas.SubjectCopied({primaryText:l,count:t.length}))}break;case"'":if(r.V5&&e.shiftKey&&e.metaKey){e.preventDefault();let t=E.map(e=>{var t,l,i,n;let r=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return null==r?void 0:null===(n=r.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>(null==e?void 0:e.name)==="Subject"))||void 0===l?void 0:l.value}),l=t.join("\n");navigator.clipboard.writeText(l),eG(T.t.lambdas.SubjectCopied({primaryText:l,count:t.length}))}break;case".":if(r.V5){if(e.preventDefault(),e.stopPropagation(),e.metaKey&&!e.shiftKey){let e=E.map(e=>{var t,l,i,n,r;let a=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,o.Kc)(null!==(r=null==a?void 0:null===(n=a.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==r?r:"")}),t=e.join("\n");navigator.clipboard.writeText(t),eG(T.t.lambdas.SenderCopied({primaryText:t,count:e.length}))}else if(e.shiftKey&&e.metaKey){let e=E.map(e=>{var t,l,i,n,r;let a=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,o.e6)(null!==(r=null==a?void 0:null===(n=a.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==r?r:"")}),t=e.join("\n");navigator.clipboard.writeText(t),eG(T.t.lambdas.SenderAddressCopied({primaryText:t,count:e.length}))}}else if(e.ctrlKey&&!e.shiftKey){e.preventDefault(),e.stopPropagation();let t=E.map(e=>{var t,l,i,n,r;let a=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,o.Kc)(null!==(r=null==a?void 0:null===(n=a.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==r?r:"")}),l=t.join("\n");navigator.clipboard.writeText(l),eG(T.t.lambdas.SenderCopied({primaryText:l,count:t.length}))}break;case"o":if(e.shiftKey)break;let B=ew[ey];B&&(localStorage.setItem("scrollPos",String(null!==(c=null===(u=eI.current)||void 0===u?void 0:u.scrollTop)&&void 0!==c?c:0)),eY.push(e$+"/thread/"+B.id),eJ.setCurrentThread(B));break;case"r":if(e.shiftKey)break;if(!(0,r.xN)(e)){let e=ew[ey],t=null==e?void 0:null===(v=e.messages)||void 0===v?void 0:v.filter(e=>{var t,l,i;return!((null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("DRAFT"))&&(null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:l.find(e=>"In-Reply-To"===e.name)))}),l=null==t?void 0:t.at(-1);localStorage.setItem("scrollPos",String(null!==(g=null===(m=eI.current)||void 0===m?void 0:m.scrollTop)&&void 0!==g?g:0)),eY.push(e$+"/thread/"+E[0].id+"?reply="+(null!==(b=null==l?void 0:l.id)&&void 0!==b?b:null==e?void 0:null===(h=e.messages)||void 0===h?void 0:null===(p=h.at(-1))||void 0===p?void 0:p.id)),eJ.setCurrentThread(e)}break;case"f":if(e.shiftKey)break;if(!(0,r.xN)(e)){let e=ew[ey],t=null==e?void 0:null===(y=e.messages)||void 0===y?void 0:y.filter(e=>{var t,l,i;return!((null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("DRAFT"))&&(null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:l.find(e=>"In-Reply-To"===e.name)))}),l=null==t?void 0:t.at(-1);localStorage.setItem("scrollPos",String(null!==(C=null===(x=eI.current)||void 0===x?void 0:x.scrollTop)&&void 0!==C?C:0)),eY.push(e$+"/thread/"+E[0].id+"?forward="+(null!==(S=null==l?void 0:l.id)&&void 0!==S?S:null==e?void 0:null===(w=e.messages)||void 0===w?void 0:null===(k=w.at(-1))||void 0===k?void 0:k.id)),eJ.setCurrentThread(e)}}},[eq.selectedIndices.length,ew,eX.currentLabel,eF,eR,ez,eB,eO,e_]),tT=(0,I.useCallback)(e=>{if("Enter"===e.key)setTimeout(()=>{var e,t;eJ.setCurrentThread(e0),eN(ey),localStorage.setItem("scrollPos",String(null==eI?void 0:null===(t=eI.current)||void 0===t?void 0:null===(e=t.state)||void 0===e?void 0:e.scrollOffset))},0);else{var t;let l=(null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key;if(D.includes(l)){if(e.repeat||eq.isNavigationActivated)return;tN(e)}}},[tN,eJ.setCurrentThread,eN,eq.isNavigationActivated]),tj=eE?null==tS?void 0:tS.map((e,t)=>{var l,n;return{label:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",jsxContent:(0,i.jsx)("div",{className:"inline-flex h-4 w-48 items-center justify-start gap-2 rounded px-1 py-2 text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:(0,i.jsx)("div",{className:"flex h-4 w-full shrink grow basis-0 items-center justify-start gap-x-2",children:(0,i.jsxs)("div",{className:"flex w-full items-center justify-start gap-1.5 rounded",children:[(0,i.jsx)("div",{className:"relative h-2 w-2 rounded-full bg-red-500",style:{backgroundColor:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor}}),(0,i.jsx)("span",{className:"truncate",children:null==e?void 0:e.name})]})})}),disabled:!1,doesCloseOnSelect:!0,onSelect(t){eY.push("".concat(eL,"/labels/").concat(null==e?void 0:e.id))}}}):null!==(ef=null==tS?void 0:null===(B=tS.slice(2))||void 0===B?void 0:B.map((e,t)=>{var l,n;return{label:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",jsxContent:(0,i.jsx)("div",{className:"inline-flex h-4 w-48 items-center justify-start gap-2 rounded px-1 py-2 text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:(0,i.jsx)("div",{className:"flex h-4 w-full shrink grow basis-0 items-center justify-start gap-x-2",children:(0,i.jsxs)("div",{className:"flex w-full items-center justify-start gap-1.5 rounded",children:[(0,i.jsx)("div",{className:"relative h-2 w-2 rounded-full bg-red-500",style:{backgroundColor:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor}}),(0,i.jsx)("span",{className:"truncate",children:null==e?void 0:e.name})]})})}),disabled:!1,doesCloseOnSelect:!0,onSelect(t){eY.push("".concat(eL,"/labels/").concat(null==e?void 0:e.id))}}}))&&void 0!==ef?ef:[],tE={id:"labels-".concat(null==e0?void 0:e0.id)};return(0,i.jsxs)("div",{className:"relative flex flex-col",style:ex,"data-date":(0,o.Cv)(td,tp),children:[tI&&(0,i.jsxs)("div",{className:"w-full",tabIndex:-1,children:[(0,i.jsx)("div",{className:"w-full px-[46px] py-3 pt-6 text-body font-medium text-tertiary dark:text-tertiary-dark "+(eW.sidebarOpen?"lg:pl-[52px]":"lg:pl-[68px]"),children:(0,o.Cv)(td,tp)}),(0,i.jsx)("div",{className:"mt-auto w-full border-b-[0.5px] "+((null===(z=eP.displaySettings)||void 0===z?void 0:z.border)||!eP.displaySettings?"border-border-primary dark:border-border-dark-primary":"border-transparent")})]},"header-".concat(null==e0?void 0:e0.id)),(0,i.jsxs)(C.default,{draggable:"false",href:(null===(H=window)||void 0===H?void 0:null===(_=H.location)||void 0===_?void 0:_.pathname)+"/thread"+(eV.isOfflineMode?"":"/".concat(null==e2?void 0:e2.threadId)),id:null==e0?void 0:e0.id,ref:e=>{(0,r.W_)(e,tf&&!!e&&!eJ.composeOpen,{preventScroll:eC})},onMouseMove:e=>{if((0,d.b)()){e.preventDefault();return}!tf&&eC&&eq.setCurrentIndex([1,ey])},onClick:e=>{if(e.shiftKey){if(e.preventDefault(),0===eq.selectedIndices.length)eq.setSelectedIndices([[1,ey]]);else{let e=eq.selectedIndices[eq.selectedIndices.length-1][1];if(ey>e){let t=Array.from({length:ey-e+1},(e,t)=>t).map(t=>[1,e+t]).filter(e=>!eq.selectedIndices.find(t=>t[1]===e[1]));eq.setSelectedIndices([...eq.selectedIndices,...t])}else if(ey<e){let t=Array.from({length:e-ey+1},(e,t)=>t).map(t=>[1,e-t]).filter(e=>!eq.selectedIndices.find(t=>t[1]===e[1]));eq.setSelectedIndices([...eq.selectedIndices,...t])}}}else{var t,l;eJ.setCurrentThread(e0),eN(ey),localStorage.setItem("scrollPos",String(null==eI?void 0:null===(l=eI.current)||void 0===l?void 0:null===(t=l.state)||void 0===t?void 0:t.scrollOffset))}},onKeyDown:tT,className:b()((tf&&th?"bg-brand-link/[.16] dark:bg-brand-dark-link/[.16]":tf?"bg-fill-primary dark:bg-fill-dark-primary":th?"bg-brand-link/[.08] focus:bg-brand-link/[.16] dark:bg-brand-dark-link/[.08] dark:focus:bg-brand-dark-link/[.16]":"focus:bg-fill-primary dark:focus:bg-fill-dark-primary")+(eW.sidebarOpen?" lg:pl-8":" lg:pl-12")+" group peer relative inline-flex max-w-full scroll-my-0.5 gap-3 border px-[26px] py-3 text-body outline-none duration-0 sm:items-center lg:px-7",{"border-transparent":!tf||eC,"border-border-secondary dark:border-border-dark-secondary":tf&&!eC}),children:[(0,i.jsxs)("div",{className:"mb-auto flex h-6 w-1.5 shrink-0 flex-col items-center justify-center",children:[tu&&(null===(P=eP.displaySettings)||void 0===P?void 0:P.status)&&(0,i.jsx)("div",{className:"-mt-0.5 h-1.5 w-1.5 shrink-0 rounded-full bg-yellow-400 first:mt-0 dark:bg-yellow-dark-400"}),ts&&(null===(U=eP.displaySettings)||void 0===U?void 0:U.status)&&(0,i.jsx)("div",{className:"-mt-0.5 h-1.5 w-1.5 shrink-0 rounded-full bg-brand first:mt-0 dark:bg-brand-dark"})]}),(null===(W=eP.displaySettings)||void 0===W?void 0:W.avatar)&&(0,i.jsx)("div",{className:(th?"bg-[#2795E4]":"bg-brand dark:bg-brand-dark")+" flex h-6 w-6 shrink-0 items-center justify-center rounded-full pt-[1px] text-[11px] font-medium uppercase leading-3 text-primary-dark"+" ".concat(ti),style:{background:th?"#2A63F4":""},children:th?(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,i.jsx)("path",{d:"M3 9L6.75 12L13 4",stroke:"white"})}):tt||tl?null!==(eg=null==te?void 0:null===(V=te.value)||void 0===V?void 0:null===(K=V.replaceAll("<","").replaceAll(/"/g,""))||void 0===K?void 0:null===(q=K.replace(" ",""))||void 0===q?void 0:q[0])&&void 0!==eg?eg:null==e7?void 0:null===(G=e7.value)||void 0===G?void 0:null===(X=G.replaceAll('"',"").replaceAll(/"/g,""))||void 0===X?void 0:null===(J=X.replace(" ",""))||void 0===J?void 0:J[0]:null==e7?void 0:null===($=e7.value)||void 0===$?void 0:null===(Z=$.replaceAll('"',"").replaceAll(/"/g,""))||void 0===Z?void 0:null===(Q=Z.replace(" ",""))||void 0===Q?void 0:Q[0]}),(0,i.jsxs)("div",{className:"flex w-full min-w-0 max-w-full shrink flex-col gap-1.5 sm:flex-row sm:items-center sm:gap-8",children:[(0,i.jsxs)("div",{className:"flex"+((null===(et=eP.displaySettings)||void 0===et?void 0:et.sender)?"":" sm:hidden"),children:[(null===(el=eP.displaySettings)||void 0===el?void 0:el.sender)&&(0,i.jsx)("div",{className:"relative",children:(0,i.jsxs)("span",{className:b()("body inline-flex w-[232px] items-center gap-0 truncate",{"font-medium":eP.displaySettings.emphasizeUnread&&ts},{"font-normal":eP.displaySettings.emphasizeUnread&&!ts},{"font-medium":!eP.displaySettings.emphasizeUnread}),children:[tl&&(0,i.jsx)("span",{children:(0,i.jsx)("span",{className:"mr-1 shrink-0 text-purple-500 dark:text-purple-dark-500",children:"Draft to "})}),tC]})}),(null===(ei=eP.displaySettings)||void 0===ei?void 0:ei.date)&&(0,i.jsx)("span",{className:"ml-auto whitespace-nowrap text-tertiary dark:text-tertiary-dark sm:hidden",children:tp})]}),(0,i.jsxs)("div",{className:"relative flex w-full min-w-0 max-w-full flex-col items-start gap-1.5 text-left sm:flex-row sm:items-center sm:gap-3",children:[(0,i.jsxs)("div",{className:b()("flex min-w-0 max-w-full shrink-0 flex-col items-start sm:flex-row sm:items-center",{"sm:gap-3":tg>0||!!e4||(null==tS?void 0:tS.length)>0}),children:[(0,i.jsx)("span",{className:b()("body min-w-0 max-w-full shrink truncate",{"font-medium":eP.displaySettings.emphasizeUnread&&ts},{"font-normal":eP.displaySettings.emphasizeUnread&&!ts},{"font-medium":!eP.displaySettings.emphasizeUnread}),children:(null==tn?void 0:tn.length)>0?tr!==tn?(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:tr}}):tr:"(no subject)"}),(0,i.jsxs)("div",{className:"shrink-0 items-center gap-x-1 sm:flex",children:[(null==tS?void 0:tS.length)>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"hidden sm:flex lg:hidden",children:(null==tS?void 0:tS.length)===1?(0,i.jsx)(N.f,{userLabel:null==tS?void 0:tS[0],href:"".concat(eL,"/labels/").concat(null==tS?void 0:null===(en=tS[0])||void 0===en?void 0:en.id)},"".concat(e0.id,"-").concat(null==tS?void 0:null===(er=tS[0])||void 0===er?void 0:er.id)):(0,i.jsx)(p.Z,{items:tj,triggerProps:tE,children:(0,i.jsxs)("div",{className:"h-6 shrink-0 whitespace-nowrap "+N.X,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,i.jsx)("div",{className:"relative flex items-center justify-center",style:{width:"".concat((null==tS?void 0:tS.length)*4+2,"px")},children:null==tS?void 0:tS.map((e,t)=>{var l;return(0,i.jsx)("div",{className:"absolute h-2 w-2 rounded-full bg-red-500",style:{left:"".concat(4*t,"px"),zIndex:t,backgroundColor:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor}},null==e?void 0:e.id)})}),(0,i.jsx)("span",{className:"text-primary dark:text-primary-dark",children:"+".concat(null==tS?void 0:tS.length," label").concat((null==tS?void 0:tS.length)===1?"":"s")})]})})}),(0,i.jsxs)("div",{className:"hidden lg:flex lg:flex-row lg:gap-x-1",children:[null==tS?void 0:null===(eo=tS.slice(0,2))||void 0===eo?void 0:eo.map(e=>(0,i.jsx)(N.f,{userLabel:e,href:"".concat(eL,"/labels/").concat(null==e?void 0:e.id)},"".concat(e0.id,"-").concat(null==e?void 0:e.id))),(null==tS?void 0:tS.length)>2&&(0,i.jsx)(p.Z,{items:tj,triggerProps:tE,children:(0,i.jsxs)("div",{className:"h-6 shrink-0 whitespace-nowrap "+N.X,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:[(0,i.jsx)("div",{className:"relative flex items-center justify-center",style:{width:"".concat(((null==tS?void 0:tS.length)-2)*4+2,"px")},children:null==tS?void 0:tS.slice(2).map((e,t)=>{var l;return(0,i.jsx)("div",{className:"absolute h-2 w-2 rounded-full bg-red-500",style:{left:"".concat(4*t,"px"),zIndex:t,backgroundColor:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor}},null==e?void 0:e.id)})}),(0,i.jsx)("span",{className:"text-primary dark:text-primary-dark",children:"+".concat((null==tS?void 0:tS.length)-2," label").concat((null==tS?void 0:tS.length)-2==1?"":"s")})]})})]})]}),!ej&&tg>0&&(0,i.jsx)(E,{numAttachments:tg,firstFileName:tb}),!ej&&ty&&(0,i.jsx)(A,{date:null!=e4?e4:td})]})]}),(null===(ea=eP.displaySettings)||void 0===ea?void 0:ea.description)&&(0,i.jsx)("span",{className:"h-4 min-w-0 max-w-full shrink text-tertiary dark:text-tertiary-dark"+(Y(null!==(eb=null==e2?void 0:e2.snippet)&&void 0!==eb?eb:"")?" overflow-hidden":" truncate"),dangerouslySetInnerHTML:{__html:null!=e9?e9:""}}),(tg>0||ty)&&(0,i.jsxs)("div",{className:"flex items-center justify-start gap-1 sm:hidden",children:[tg>0&&(0,i.jsx)(E,{numAttachments:tg,firstFileName:tb}),ty&&(0,i.jsx)(A,{date:null!=e4?e4:td})]})]})]}),tf?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"hidden w-24 sm:block"}),(0,i.jsxs)("div",{className:"absolute bottom-2 right-5 hidden gap-0.5 sm:flex",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:h.N.Archive,disabled:eA||tc,variant:"tertiary",className:eA||tc?"":"peer",onClick:e=>{var t;e.preventDefault(),e.stopPropagation(),eR({hasLabel:tc,threadIds:[null==e0?void 0:e0.id],emailIds:null==e1?void 0:null===(t=e1.filter(e=>tc||e.labelIds.includes("INBOX")))||void 0===t?void 0:t.map(e=>e.id),toastProps:{isActive:tc,primaryText:tn}})}}),(0,i.jsx)(v.M,{...s.Wz.Archive,position:"left-1/2 -translate-x-20 top-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:h.N.Trash,disabled:tm,variant:"tertiary",className:tm?"":"peer",onClick:e=>{e.preventDefault(),e.stopPropagation(),eO({isTrash:!!tm,threadIds:[null==e0?void 0:e0.id],emailIds:null==e1?void 0:e1.map(e=>e.id),toastProps:{isActive:!!tm,primaryText:tn},isArchived:tc,isSpam:!!tv})}}),(0,i.jsx)(v.M,{...s.Wz.Delete,position:"-right-8 top-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),eK.setCommandMenuOpen(!0)},icon:h.N.Command,variant:"tertiary",className:"peer"}),(0,i.jsx)(v.M,{...s.Wz.OpenCommandMenu,position:"right-0 top-10"})]})]})]}):(null===(ed=eP.displaySettings)||void 0===ed?void 0:ed.date)&&(0,i.jsx)("span",{className:"ml-auto hidden min-w-[80px] shrink-0 whitespace-nowrap pl-5 text-right text-tertiary dark:text-tertiary-dark sm:block",children:tp})]},null==e0?void 0:e0.id),(0,i.jsx)("div",{className:"mt-auto w-full border-b-[0.5px] "+((null===(es=eP.displaySettings)||void 0===es?void 0:es.border)?"border-b-border-primary dark:border-b-border-dark-primary":"border-transparent dark:border-transparent")})]},"wrapper-".concat(null==e0?void 0:e0.id))}),R=e=>{let{count:t,displayedName:l,hoverName:n,hoverOffset:r,searchStore:o}=e,a=(0,I.useMemo)(()=>{var e,t;return o.searchQuery&&(null==l?void 0:l.toLowerCase().includes(null==o?void 0:null===(e=o.searchQuery)||void 0===e?void 0:e.toLowerCase()))?O(l,null==o?void 0:o.searchQuery):(null==l?void 0:l.length)>29-(null!=r?r:0)/8?(null===(t=l.slice(0,29))||void 0===t?void 0:t.trimEnd())+"...":l},[l,o.searchQuery]);return(0,i.jsxs)("span",{className:"inline-flex",children:[(0,i.jsxs)("span",{className:b()("peer inline-flex items-center sm:py-1",{"opacity-0":(null!=r?r:0)>192}),children:[t&&t>0?", ":"",a!==l?(0,i.jsx)("div",{className:"min-w-0 max-w-full truncate"+(t&&t>0?" ml-1":""),dangerouslySetInnerHTML:{__html:a},style:{maxWidth:"".concat(Math.max(0,208-(null!=r?r:0)),"px")}}):(0,i.jsx)("div",{className:"inline-block min-w-0 truncate"+(t&&t>0?" ml-1":""),style:{maxWidth:"".concat(Math.max(0,208-(null!=r?r:0)),"px")},children:a})]}),(0,i.jsx)(v.M,{title:n,position:"sm:top-8 top-6 peer-hover:delay-300 font-normal",left:"".concat((null!=r?r:0)+(t&&t>0?4:0)-8,"px")})]})};R.displayName="EmailSenderOrRecipientComponent";let O=(e,t)=>{let l=[...e.toLowerCase().matchAll(RegExp(t.toLowerCase(),"gi"))].reverse(),i=[],n=e.length;return l.forEach(l=>{(null==l?void 0:l.index)!==void 0&&(null==l?void 0:l.index)>=0&&(i.push(e.substring(l.index+t.length,n)),i.push('<span style="background-color: rgba(255, 204, 41, 0.32)">'.concat(e.substring(l.index,l.index+t.length),"</span>")),n=l.index)}),i.push(e.substring(0,n)),i.reverse().join("")};var F=(0,w.Pi)(()=>{var e,t,l,n;let r=(0,S.useRouter)(),o=(0,S.useParams)(),{sidebarStore:a}=(0,u.m)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"body relative flex h-[200px] w-full max-w-[calc(100vw-40px)] shrink flex-col items-center justify-center overflow-hidden rounded-lg bg-fill-secondary px-4 duration-150 dark:bg-fill-dark-secondary sm:max-w-[calc(100vw-92px)]"+(a.sidebarOpen?" lg:max-w-[calc(100vw-292px)]":""),children:[null===(e=s.wb[4])||void 0===e?void 0:e.map((e,t)=>{let l="".concat(12-2*t,":").concat(6+7*t," AM");return(0,i.jsxs)("div",{className:"flex w-full max-w-[900px] items-center justify-between gap-3 border-b border-border-primary px-3 py-3 dark:border-border-dark-primary md:px-7",children:[(0,i.jsxs)("div",{className:"flex w-full shrink-0 items-start gap-3 md:w-1/4 md:items-center",children:[(0,i.jsx)("div",{className:"mt-[10px] h-1.5 w-1.5 shrink-0 rounded-full bg-brand dark:bg-brand-dark md:mt-0"}),(0,i.jsx)("img",{className:"h-6 w-6 shrink-0 rounded-full bg-gray-400 grayscale",src:e.image}),(0,i.jsx)("div",{className:"highlight-text hidden md:block",children:e.sender}),(0,i.jsxs)("div",{className:"flex w-full min-w-0 shrink flex-col gap-1.5 md:hidden",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{className:"highlight-text truncate whitespace-nowrap",children:e.sender}),(0,i.jsx)("div",{className:"text-tertiary dark:text-tertiary-dark",children:l})]}),(0,i.jsx)("div",{className:"highlight-text",children:e.subject}),(0,i.jsx)("div",{className:"truncate text-tertiary dark:text-tertiary-dark",children:e.body})]})]}),(0,i.jsxs)("div",{className:"hidden w-full min-w-0 shrink items-center gap-3 md:flex",children:[(0,i.jsx)("div",{className:"highlight-text max-w-[60%] shrink-0 truncate whitespace-nowrap",children:e.subject}),(0,i.jsx)("div",{className:"truncate text-tertiary dark:text-tertiary-dark",children:e.body}),(0,i.jsx)("div",{className:"ml-auto whitespace-nowrap text-tertiary dark:text-tertiary-dark",children:l})]})]},t)}),(0,i.jsx)("div",{className:"absolute inset-0 z-[1] rounded-lg bg-gradient-to-b from-[#F5F5F5]/90 via-transparent to-[#F5F5F5]/90 dark:from-[#393939]/90 dark:via-transparent dark:to-[#393939]/90"})]}),(0,i.jsx)("div",{className:"text-t2 text-primary dark:text-primary-dark",children:null===(t=s.je.find(e=>e.id.toLowerCase()===o.label))||void 0===t?void 0:t.name}),(0,i.jsx)("div",{className:"max-w-sm text-body text-tertiary dark:text-tertiary-dark",children:null!==(n=null===(l=s.je.find(e=>e.id.toLowerCase()===o.label))||void 0===l?void 0:l.emptyPlaceholder)&&void 0!==n?n:"You have no active conversations on this page."}),(0,i.jsx)("hr",{className:"w-full border-t border-border-primary dark:border-border-dark-primary"}),(0,i.jsxs)("div",{className:"max-w-sm text-body text-tertiary dark:text-tertiary-dark",children:["If you believe this is incorrect, try"," ",(0,i.jsx)("button",{className:"brand-common-link duration-150",onClick:()=>{r.refresh()},children:"restarting Tatem"}),". If the issue persists please contact"," ",(0,i.jsx)("a",{href:"mailto:support@tatem.com",className:"brand-common-link duration-150",children:"support@tatem.com"}),"."]})]})}),B=l(32930),z=l(26031),_=l(29174);let H=(0,w.Pi)(e=>{var t,l,o,a,d,c,f,g,y,x;let{labelData:k,userLabelObj:w,topThreadDate:N,isScrollActive:T,isMobile:E,innerRef:M}=e,A=(0,S.usePathname)(),[D,L]=(0,I.useState)(-1),[R,O]=(0,I.useState)(-1),{uiStore:{displaySettings:F,updateDisplaySettings:H},sidebarStore:P,supabaseStore:U,modalsStore:W,labelStore:q,keyboardStore:K}=(0,u.m)(),V=(0,n.H)(),J=(0,S.useRouter)(),X=(0,I.useMemo)(()=>q.userLabels.filter(e=>!e.name.includes("[Tatem]")),[q.userLabels]),G=(0,B.v)(T?".fixed-list":void 0),Q=[{label:"Emphasize Unread",disabled:!1,preventFocusOutside:!0,nestedItems:[{label:"On",type:"checkBoxIndicator",checked:F.emphasizeUnread,onSelect:()=>{H({...F,emphasizeUnread:!0})}},{label:"Off",type:"checkBoxIndicator",checked:!F.emphasizeUnread,onSelect:()=>{H({...F,emphasizeUnread:!1})}}]},{label:"Display Properties",disabled:!1,preventFocusOutside:!0,nestedItems:[{label:"Status",type:"checkBoxItem",checked:F.status,onSelect:()=>{H({...F,status:!F.status})}},{label:"Avatar",type:"checkBoxItem",checked:F.avatar,onSelect:()=>{H({...F,avatar:!F.avatar})}},{label:"Sender",type:"checkBoxItem",checked:F.sender,onSelect:()=>{H({...F,sender:!F.sender})}},{label:"Description",type:"checkBoxItem",checked:F.description,onSelect:()=>{H({...F,description:!F.description})}},{label:"Date",type:"checkBoxItem",checked:F.date,onSelect:()=>{H({...F,date:!F.date})}},{label:"Divider",type:"checkBoxItem",checked:F.border,onSelect:()=>{H({...F,border:!F.border})}}]},...E?[]:[{label:"Grouping Style",disabled:!1,preventFocusOutside:!0,nestedItems:[{label:"Minimal",type:"checkBoxIndicator",checked:"minimal"===F.groupingDisplay,onSelect:()=>{H({...F,groupingDisplay:"minimal"})}},{label:"Traditional",type:"checkBoxIndicator",checked:"traditional"===F.groupingDisplay,onSelect:()=>{H({...F,groupingDisplay:"traditional"})}},{label:"None",type:"checkBoxIndicator",checked:"none"===F.groupingDisplay,onSelect:()=>{H({...F,groupingDisplay:"none"})}}]}],{label:"sep-1",type:"separator"},{label:"Reset to Default",disabled:JSON.stringify(F)===JSON.stringify(_.M),onSelect:()=>{H(_.M)}}],Z=(0,I.useMemo)(()=>"[1,-1]"===JSON.stringify(K.currentIndex),[K.currentIndex]),Y=(0,I.useMemo)(()=>{var e;return null==U?void 0:null===(e=U.inboxSplits)||void 0===e?void 0:e.filter(e=>!!e.active)},[U.inboxSplits]),$=(0,I.useMemo)(()=>null==Y?void 0:Y.find(e=>"INBOX-split-".concat(e.value)===q.currentLabel),[Y,q.currentLabel]),ee=Y.map(e=>({label:null==e?void 0:e.name,onSelect:()=>{let t=(null==e?void 0:e.name)!=="Important"&&(null==e?void 0:e.name)!=="Inbox"?"/".concat(null==e?void 0:e.name.toLowerCase()):"";J.push(V+"/inbox"+t)},doesCloseOnSelect:!0}));return(0,I.useEffect)(()=>{if(Z){if(D<0&&q.currentLabel.includes("INBOX-")){let e=Y.findIndex(e=>"INBOX-split-".concat(e.value)===q.currentLabel);e>=0&&(L(e),O(e))}}else L(-1),O(-1)},[Z,q.currentLabel]),(0,i.jsxs)("div",{className:b()("sticky top-0 z-10 flex w-full items-start justify-between gap-8 border-b-[0.5px] bg-white/40 px-2 py-3 duration-150 dark:bg-[#282828]/40 sm:px-5",{"border-transparent":!(null==F?void 0:F.border)&&!G},{"border-border-secondary dark:border-border-dark-secondary":(null==F?void 0:F.border)||G}),ref:e=>{M&&(M.current=e)},children:[(0,i.jsxs)("div",{className:"z-10 flex items-center justify-start",children:[P.sidebarOpen?(0,i.jsx)("div",{className:"w-12 shrink-0 lg:w-8"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"relative mb-0 shrink-0",children:[(0,i.jsx)(m.z,{icon:h.N.LeftSidebar,variant:"tertiary",className:"peer !text-quartery hover:!text-primary dark:!text-quartery-dark dark:hover:!text-primary-dark",onClick:()=>{P.toggleLeftSidebar()}}),(0,i.jsx)(v.M,{title:P.sidebarOpen?s.Wz.HideLeftSidebar.title:s.Wz.ShowLeftSidebar.title,keys:s.Wz.HideLeftSidebar.keys,position:P.sidebarOpen?"top-10 left-0 sm:left-1/2 sm:-translate-x-10":"top-10 left-0"})]}),(0,i.jsx)("div",{className:"mb-auto mr-2 mt-2 flex w-2 shrink-0 items-center justify-center",children:(0,i.jsx)("div",{className:"h-4 w-0 border-l border-border-primary dark:border-border-dark-primary"})})]}),(0,i.jsx)("div",{className:b()("flex items-center gap-1.5 text-body",{"border border-transparent":!(null==A?void 0:A.includes("/Label_"))}),children:(null==A?void 0:A.includes("/Label_"))?(0,i.jsxs)("div",{className:"flex items-center gap-2 text-center",children:[(0,i.jsxs)(C.default,{draggable:"false",href:V+"/labels",className:b()("highlight-text relative -ml-2.5 flex items-center gap-1 rounded border p-2 text-secondary outline-none dark:text-secondary-dark",{"border-border-secondary bg-fill-primary focus-visible:border-border-secondary dark:border-border-dark-secondary dark:bg-fill-dark-primary dark:focus-visible:border-border-dark-secondary":Z&&0===D,"border-transparent":!Z||0!==D}),ref:e=>(0,r.W_)(e,"[1,-1]"===JSON.stringify(K.currentIndex)&&0===D),onKeyDown:e=>{"ArrowRight"===e.key&&(e.preventDefault(),e.stopPropagation(),L(1))},children:[(0,i.jsx)("span",{children:"Labels"}),(0,i.jsx)("span",{className:"text-support font-normal text-tertiary dark:text-tertiary-dark",children:null!==(c=null==X?void 0:X.length)&&void 0!==c?c:""})]}),(0,i.jsx)(j.J,{path:h.N.RightChevron,className:"text-quartery dark:text-quartery-dark"}),!!k&&A.includes(k.id)&&(0,i.jsxs)("div",{tabIndex:0,className:"group relative flex items-center gap-1 py-2 outline-none",ref:e=>(0,r.W_)(e,"[1,-1]"===JSON.stringify(K.currentIndex)&&1===D),onKeyDown:e=>{"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),L(0))},children:[(0,i.jsx)("div",{className:"mx-2 h-2 w-2 rounded-full "+(w?"bg-red-500":"bg-transparent"),style:{backgroundColor:null==w?void 0:null===(t=w.color)||void 0===t?void 0:t.backgroundColor}}),(0,i.jsx)("div",{className:"highlight-text text-secondary group-hover:text-primary dark:text-secondary-dark dark:group-hover:text-primary-dark",children:null==k?void 0:k.name}),(0,i.jsx)("span",{className:"text-support tabular-nums tracking-tighter text-quartery dark:text-quartery-dark",children:null!==(f=null==k?void 0:null===(l=k.threadsTotal)||void 0===l?void 0:l.toLocaleString())&&void 0!==f?f:""}),Z&&1===D&&(0,i.jsx)("div",{className:"absolute bottom-0 left-[30px] right-0 h-0.5 rounded-b bg-border-tertiary dark:bg-border-dark-tertiary"})]})]}):!A.includes("/inbox")&&(0,i.jsxs)("div",{className:b()("relative -ml-2 flex h-8 items-center gap-1 rounded border p-2 outline-none",{"border-border-secondary bg-fill-primary focus-visible:border-border-secondary dark:border-border-dark-secondary dark:bg-fill-dark-primary dark:focus-visible:border-border-dark-secondary":Z,"border-transparent":!Z}),children:[(0,i.jsx)("div",{className:"highlight-text capitalize",children:null!==(g=null===(o=s.je.find(e=>e.id===(null==k?void 0:k.id)))||void 0===o?void 0:o.name)&&void 0!==g?g:"Inbox"}),(0,i.jsx)("span",{className:"text-support tabular-nums tracking-tighter text-quartery dark:text-quartery-dark",children:null!==(y=null==k?void 0:null===(a=k.threadsTotal)||void 0===a?void 0:a.toLocaleString())&&void 0!==y?y:""})]})}),!!(null==Y?void 0:Y.length)&&A.includes("/inbox")&&(0,i.jsx)("div",{className:"block md:hidden",children:(0,i.jsx)(z.Z,{title:"Split Inbox",items:ee,children:(0,i.jsxs)("div",{className:"body flex shrink-0 items-center gap-1.5 rounded border border-border-primary p-2 outline-none dark:border-border-dark-primary",children:[(0,i.jsxs)("span",{className:"whitespace-nowrap",children:[(null==$?void 0:$.name)+" ",(0,i.jsxs)("span",{className:"text-support tabular-nums tracking-tighter text-quartery dark:text-quartery-dark",children:[null!==(x=null==k?void 0:null===(d=k.threadsTotal)||void 0===d?void 0:d.toLocaleString())&&void 0!==x?x:"",(null==k?void 0:k.threadsTotal)===1e3?"+":""]})]}),(0,i.jsx)(j.J,{path:h.N.RightChevron,className:"text-quartery dark:text-quartery-dark"})]})})}),!!(null==Y?void 0:Y.length)&&A.includes("/inbox")&&(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 md:-ml-2",children:[null==Y?void 0:Y.map((e,t)=>{var l,n,o,a,d,u,c,m;let p=null!==(c=null===(l=A.split("/"))||void 0===l?void 0:l.at(-1))&&void 0!==c?c:"",h=(null==k?void 0:k.id)===(null==e?void 0:e.value)||(null==k?void 0:null===(n=k.name)||void 0===n?void 0:n.toLowerCase())===(null==e?void 0:null===(o=e.name)||void 0===o?void 0:o.toLowerCase()),f=h||(null===(a=decodeURI(p))||void 0===a?void 0:a.includes(e.name.toLowerCase()))||"inbox"===p&&0===t,g=(null==e?void 0:e.name)!=="Important"&&(null==e?void 0:e.name)!=="Inbox"?"/".concat(null==e?void 0:e.name.toLowerCase()):"",y=h?null==k?void 0:k.threadsTotal:null==q?void 0:null===(u=q.cachedLabelArr)||void 0===u?void 0:null===(d=u.find(t=>t.id==="INBOX-split-".concat(null==e?void 0:e.value)))||void 0===d?void 0:d.count;return e.active?(0,i.jsxs)(C.default,{draggable:"false",className:b()("group relative hidden rounded border outline-none md:block",{"bg-fill-primary dark:bg-fill-dark-primary":D===t,"border-transparent":D!==t||R!==t,"border-border-secondary focus-visible:border-border-secondary dark:border-border-dark-secondary dark:focus-visible:border-border-dark-secondary":D===t&&R===t}),href:V+"/inbox"+g,ref:e=>{(0,r.W_)(e,!!e&&Z&&D===t)},onFocus:()=>{D<0&&(L(t),O(t))},onMouseMove:()=>{L(t),O(-1)},onMouseLeave:()=>{L(-1),O(-1)},onKeyDown:e=>{if(e.key.includes("Arrow")&&!(0,r.xN)(e))switch(e.key){case"ArrowDown":L(-1),O(-1);break;case"ArrowLeft":if(0!==D){e.preventDefault(),e.stopPropagation();let t=Math.max(0,D-1);L(t),O(t)}break;case"ArrowRight":e.preventDefault(),e.stopPropagation();let t=Math.min(null==Y?void 0:Y.length,D+1);L(t),O(t)}},children:[(0,i.jsxs)("div",{className:"peer flex items-center gap-1 p-2 font-medium",children:[(0,i.jsx)("div",{className:"text-body group-hover:text-primary group-focus:text-primary dark:group-hover:text-primary-dark dark:group-focus:text-primary-dark"+(f?" text-primary dark:text-primary-dark":" text-tertiary dark:text-tertiary-dark"),children:null==e?void 0:e.name}),(0,i.jsxs)("span",{className:"text-support tabular-nums tracking-tighter text-quartery dark:text-quartery-dark",children:[null!==(m=null==y?void 0:y.toLocaleString())&&void 0!==m?m:"",1e3===y?"+":""]})]}),(0,i.jsx)(v.M,{...s.Wz.NextSplitInbox,position:"top-10 left-0"})]},(null==e?void 0:e.value)+t):null}),(0,i.jsxs)("div",{className:"dark:hover:bg-fill-primary-dark dark:focus-within:bg-fill-primary-dark group relative rounded border border-transparent focus-within:border-border-secondary focus-within:bg-fill-primary hover:bg-fill-primary active:border-transparent dark:focus-within:border-border-dark-secondary dark:active:border-transparent",onKeyDown:e=>{if(e.key.includes("Arrow")&&!(0,r.xN)(e))switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowDown":K.setCurrentIndex([1,0]),L(-1),O(-1);break;case"ArrowLeft":let t=Math.max(0,(null==Y?void 0:Y.length)-1);L(t),O(t)}},children:[(0,i.jsx)(m.z,{variant:"tertiary",id:"split-options-button",className:b()("peer text-tertiary !shadow-none transition-opacity duration-100 hover:!bg-transparent dark:text-tertiary-dark"),icon:h.N.Cog,onClick:()=>W.setSplitInboxModalOpen(!0),ref:e=>{(0,r.W_)(e,!!e&&Z&&D===(null==Y?void 0:Y.length))}}),(0,i.jsx)(v.M,{title:"Split Inbox Settings",position:"top-8 -left-12"})]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(null==F?void 0:F.groupingDisplay)==="minimal"&&N&&(0,i.jsx)("span",{className:"body block whitespace-nowrap px-3 py-2 text-right font-medium max-[400px]:hidden sm:min-w-[172px]",children:N}),(0,i.jsx)(p.Z,{items:Q,triggerProps:{id:"view-dropdown-button",onKeyDown:e=>{"ArrowDown"===e.key&&e.preventDefault()}},children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:h.N.ViewOption,variant:"tertiary",className:"peer group-data-[state=open]/dropdown:bg-fill-primary"}),(0,i.jsx)(v.M,{...s.Wz.ShowViewOptions,position:"top-10 -right-10 group-data-[state=open]/dropdown:opacity-0"})]})}),(0,i.jsx)("div",{className:"flex w-2 items-center justify-center",children:(0,i.jsx)("div",{className:"h-4 w-0 border-l border-border-primary dark:border-border-dark-primary"})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:P.rightSidebarOpen?h.N.RightSidebarOpen:h.N.RightSidebar,variant:"tertiary",onClick:()=>P.toggleRightSidebar(),className:"peer !text-quartery hover:!text-primary dark:!text-quartery-dark dark:hover:!text-primary-dark"}),(0,i.jsx)(v.M,{title:P.rightSidebarOpen?s.Wz.HideRightSidebar.title:s.Wz.ShowRightSidebar.title,keys:s.Wz.HideRightSidebar.keys,position:"top-10 right-0"})]})]})]})}),P=()=>{let e=(0,S.usePathname)(),t=(0,I.useMemo)(()=>{var t;return decodeURIComponent(null!==(t=e.split("/").pop())&&void 0!==t?t:"")},[e]);return(0,i.jsx)("div",{className:"flex h-[90vh] items-center justify-center",children:(0,i.jsxs)("span",{className:"text-body text-primary dark:text-primary-dark",children:["We couldn't find any results for \"",t,'"']})})};var U=l(68370),W=l(95470),q=l(81863),K=l(87863),V=l(35175),J=l(68285),X=l(46203),G=l(6313);let Q=["\uFEFF","‌"," ͏"],Z=["Escape","ArrowDown","ArrowUp","ArrowLeft","ArrowRight","j","k","x","a"," "],Y=e=>Q.map(t=>e.includes(t)).find(e=>!!e),$=["ArrowDown","ArrowUp","ArrowLeft","j","k"],ee=["SPAM","TRASH","SENT","DRAFT"],et=["ARCHIVE","INBOX"],el=(0,w.Pi)(e=>{var t,l,a,c,p,g,y,x,k,w,C,N,E,M,A,D,R,O;let{data:z,pageSize:_,setPageSize:Q,mutateData:Y,isLoadingMore:et,isEmpty:el,mutateLabel:ei,labelData:en,isLoading:er,isReachingEnd:eo}=e,[ea,ed]=(0,I.useState)(0),[es,eu]=(0,I.useState)(!1),[ec,ev]=(0,I.useState)(!1),[em,ep]=(0,I.useState)(!0),[eh,ef]=(0,I.useState)(""),{uiStore:eg,labelStore:eb,keyboardStore:ey,commandMenuStore:ex,toastStore:{addToast:ek},modalsStore:ew,inboxStore:eC,idbStore:eS,transactionStore:eI,peopleStore:eN,supabaseStore:eT}=(0,u.m)(),{spamToggleThreads:ej,deleteToggleThreads:eE,unreadToggleThreads:eM,starToggleThreads:eA,archiveToggleThreads:eD,changeThreadLabels:eL,executeLabelUndoAction:eR,blockSenderAction:eO}=(0,X.Z)({mutateList:Y,mutateLabel:ei}),eF=(0,S.usePathname)(),eB=(0,S.useRouter)(),ez=(0,n.H)(),e_=(0,I.useRef)(null),eH=(0,I.useRef)(null),eP=(0,I.useMemo)(()=>eb.currentLabel,[z]),[,eU]=(0,I.useState)(0),eW=(0,I.useRef)(new Map),eq=(0,I.useRef)(null);(0,G.T)();let eK=[],eV=z[ey.currentIndex[1]],eJ=null==eV?void 0:eV.messages,eX=(0,I.useMemo)(()=>eb.currentLabel.includes("INBOX")?"INBOX":eb.currentLabel,[eb.currentLabel]),eG=null==eJ?void 0:eJ[(null==eJ?void 0:eJ.length)-1],eQ=(0,I.useMemo)(()=>{var e;return eJ?null!==(e=[...eJ].findLast(e=>{let t=e.labelIds;return!("SENT"!==eX&&(null==t?void 0:t.includes("SENT")))&&("ARCHIVE"===eX?!t.includes("INBOX"):t.includes(eX))}))&&void 0!==e?e:null==eJ?void 0:eJ.at(-1):null},[null==eV?void 0:null===(l=eV.messages)||void 0===l?void 0:null===(t=l.at(0))||void 0===t?void 0:t.labelIds,null==eV?void 0:eV.id,null==eJ?void 0:eJ.length,eX]),eZ=null!==(R=null==eG?void 0:null===(p=eG.payload)||void 0===p?void 0:null===(c=p.headers)||void 0===c?void 0:null===(a=c.find(e=>"Subject"===e.name))||void 0===a?void 0:a.value)&&void 0!==R?R:"",eY=(0,o.e6)(null!==(O=null==eQ?void 0:null===(x=eQ.payload)||void 0===x?void 0:null===(y=x.headers)||void 0===y?void 0:null===(g=y.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===g?void 0:g.value)&&void 0!==O?O:""),e$=(0,I.useMemo)(()=>(0,o.AK)(new Date(Number(null==eQ?void 0:eQ.internalDate))),[eQ]),e0=(0,I.useMemo)(()=>eF.includes("/search"),[eF]),e1=(0,I.useMemo)(()=>{var e;return!!(null==eQ?void 0:null===(e=eQ.labelIds)||void 0===e?void 0:e.includes("STARRED"))},[eQ]),e2=(0,I.useMemo)(()=>{var e,t;return null!==(t=null==eQ?void 0:null===(e=eQ.labelIds)||void 0===e?void 0:e.includes("UNREAD"))&&void 0!==t&&t},[eQ]),e5=(0,I.useMemo)(()=>{var e;return!(null==eQ?void 0:null===(e=eQ.labelIds)||void 0===e?void 0:e.includes("INBOX"))},[null==eQ?void 0:eQ.labelIds,eJ]),e3=(0,I.useMemo)(()=>{var e;let t=null===(e=ey.selectedIndices)||void 0===e?void 0:e.map(e=>{var t;return null==z?void 0:null===(t=z[e[1]])||void 0===t?void 0:t.id}),l=null==t?void 0:t.map(e=>null==z?void 0:z.find(t=>(null==t?void 0:t.id)===e));return!(null==l?void 0:l.some(e=>{var t;return null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.some(e=>{var t;return null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("INBOX")})}))},[ey.selectedIndices,z]),e6=(0,I.useMemo)(()=>{var e;return null==eG?void 0:null===(e=eG.labelIds)||void 0===e?void 0:e.includes("TRASH")},[eG]),e4=(0,I.useMemo)(()=>{var e;return null==eG?void 0:null===(e=eG.labelIds)||void 0===e?void 0:e.includes("SPAM")},[eG]),e8=(0,I.useMemo)(()=>{var e,t;return null==eG?void 0:null===(t=eG.payload)||void 0===t?void 0:null===(e=t.headers)||void 0===e?void 0:e.find(e=>"List-Unsubscribe"===e.name)},[eG]),e9=(0,I.useMemo)(()=>{var e;return!!(null===(e=eN.blockedSenders)||void 0===e?void 0:e.find(e=>null==eY?void 0:eY.includes(e)))},[eQ,null==eN?void 0:eN.blockedSenders]),e7=(0,I.useMemo)(()=>ee.includes(eb.currentLabel),[eb.currentLabel]),te=(0,I.useMemo)(()=>{var e;return(null==ey?void 0:null===(e=ey.currentIndex)||void 0===e?void 0:e[0])===1},[ey.currentIndex]),[tt,tl]=(0,I.useState)(null);eK=[{label:(e5?"Unarchive":"Archive")+" Conversation",icon:"E",type:"item",disabled:e7,onSelect:()=>{var e,t,l;eD({hasLabel:e5,threadIds:[null==eV?void 0:eV.id],emailIds:null===(l=z[ey.currentIndex[1]])||void 0===l?void 0:null===(t=l.messages)||void 0===t?void 0:null===(e=t.filter(e=>e5||e.labelIds.includes("INBOX")))||void 0===e?void 0:e.map(e=>e.id),toastProps:{isActive:e5,primaryText:eZ}}),ey.setSelectedIndices([])}},{label:e6?s.Wz.Undelete.title:s.Wz.Delete.title,icon:e6?s.Wz.Undelete.keys.join(" "):s.Wz.Delete.keys.join(" "),type:"item",disabled:!1,onSelect:()=>{var e,t;eE({isTrash:e6,threadIds:[null==eV?void 0:eV.id],emailIds:null===(t=z[ey.currentIndex[1]])||void 0===t?void 0:null===(e=t.messages)||void 0===e?void 0:e.map(e=>e.id),toastProps:{isActive:e6,primaryText:eZ},isArchived:e5,isSpam:e4})}},{label:(e1?"Unstar":"Star")+" Conversation",icon:"S",type:"item",disabled:!1,onSelect:()=>{var e,t;eA({hasLabel:e1,threadIds:[null==eV?void 0:eV.id],emailIds:null===(t=z[ey.currentIndex[1]])||void 0===t?void 0:null===(e=t.messages)||void 0===e?void 0:e.map(e=>e.id),toastProps:{isActive:e1,primaryText:eZ}}),ey.setSelectedIndices([])}},{label:e4?"Unmark Conversation Spam":"Mark Conversation Spam",icon:"!",type:"item",disabled:!1,onSelect:()=>{var e,t;ej({isSpam:e4,threadIds:[null==eV?void 0:eV.id],emailIds:null===(t=z[ey.currentIndex[1]])||void 0===t?void 0:null===(e=t.messages)||void 0===e?void 0:e.map(e=>e.id),toastProps:{isActive:e4,primaryText:eZ},isArchived:e5,isTrash:e6}),ey.setSelectedIndices([])}},{label:"Mark Conversation "+(e2?"Read":"Unread"),onSelect:()=>{var e,t;eM({hasLabel:e2,threadIds:[null==eV?void 0:eV.id],emailIds:null===(t=z[ey.currentIndex[1]])||void 0===t?void 0:null===(e=t.messages)||void 0===e?void 0:e.map(e=>e.id),toastProps:{isActive:!e2,primaryText:eZ}}),ey.setSelectedIndices([])},icon:"U",type:"item",disabled:!1},{label:"Remind Me (Snooze Conversation)",icon:"H",type:"item",disabled:!0},{label:"Mute Conversation",icon:"⇧ M",type:"item",disabled:!0},{label:"Unsubscribe (Opt Out)",icon:"⌘ U",type:"item",onSelect:()=>{if(e8)ex.setPages(["Unsubscribe"]),ex.setOpenedExternally(!0),ex.setCommandMenuOpen(!0);else if(eY){var e;let t="".concat(null==eY?void 0:null===(e=eY.split("@"))||void 0===e?void 0:e.join("".concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203))));ew.setAlertModalObj({alertMsg:"Block sender instead?",alertDescription:"We can’t find a link to unsubscribe. Would you like to block the sender instead? This will delete all messages, including future messages, from ".concat(t,"."),alertCode:f.xK.BLOCK_SENDER,onConfirm:{title:"Block",onClick:()=>{eO({email:eY,isSenderBlocked:e9})}},onClose:{title:"Cancel"}}),ew.setAlertModalOpen(!0)}}},{type:"item",disabled:!1,icon:"⌘ U",label:e9?"Unblock Sender":"Block Sender",onSelect:()=>{if(eY){var e;let t="".concat(null==eY?void 0:null===(e=eY.split("@"))||void 0===e?void 0:e.join("".concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203))));ew.setAlertModalObj({alertMsg:e9?"Unblock sender?":"Block sender?",alertDescription:e9?"Do you want to unblock ".concat(t,"?"):"This will delete all messages, including future messages, from ".concat(t,"."),alertCode:f.xK.BLOCK_SENDER,onConfirm:{title:e9?"Unblock":"Block",onClick:()=>{eO({email:eY,isSenderBlocked:e9})}},onClose:{title:"Cancel"}}),ew.setAlertModalOpen(!0)}},doesCloseOnSelect:!0},{label:((null==eJ?void 0:eJ.find(e=>{var t;return null===(t=eb.userLabels)||void 0===t?void 0:t.find(t=>{var l;return null==e?void 0:null===(l=e.labelIds)||void 0===l?void 0:l.includes(null==t?void 0:t.id)})}))?"Change":"Add")+" Labels",type:"item",nestedItems:null===(w=eb.userLabels)||void 0===w?void 0:null===(k=w.filter(e=>!e.name.includes("[Tatem]")))||void 0===k?void 0:k.map(e=>{let t=null==eJ?void 0:eJ.some(t=>{var l;return null==t?void 0:null===(l=t.labelIds)||void 0===l?void 0:l.includes(null==e?void 0:e.id)});return{type:"checkBoxItem",label:e.name,checked:t,onSelect:()=>{eL({hasLabel:t,threadIds:[null==eV?void 0:eV.id],emailIds:null==eJ?void 0:eJ.map(e=>e.id),labelIds:[null==e?void 0:e.id],subject:eZ})}}})},{label:"Group 1",type:"separator"},{label:"Add to Split Inbox",icon:(0,i.jsx)(j.J,{path:h.N.RightChevron,className:"ml-auto opacity-[.15] group-focus:opacity-[.85]"}),type:"item",disabled:!0},{label:"New Split Inbox",icon:(0,i.jsx)(j.J,{path:h.N.RightChevron,className:"ml-auto opacity-[.15] group-focus:opacity-[.85]"}),type:"item",disabled:!0},{label:"Group 2",type:"separator"},{label:"Copy Conversation URL",icon:"⌘ ⇧ ,",type:"item",onSelect:()=>{let e=null==eV?void 0:eV.id,t=window.location.origin+ez+"/thread/"+e;window.navigator.clipboard.writeText(window.location.origin+ez+"/thread/"+e),ek(T.t.lambdas.ConversationUrlCopied({href:t}))}},{label:"Copy Subject",icon:"⌘ ⇧ '",onSelect:()=>{window.navigator.clipboard.writeText(eZ),ek(T.t.lambdas.SubjectCopied({primaryText:eZ}))},type:"item",disabled:!eZ},{label:"Copy Sender's Name",icon:"⌘ .",type:"item",onSelect:()=>{var e,t,l,i;let n=(0,o.Kc)(null!==(i=null==eQ?void 0:null===(l=eQ.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:null===(e=t.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===e?void 0:e.value)&&void 0!==i?i:"");window.navigator.clipboard.writeText(n),ek(T.t.lambdas.SenderCopied({primaryText:n}))}},{label:"Copy Sender's Address",icon:"⌘ ⇧ . ",onSelect:()=>{window.navigator.clipboard.writeText(eY),ek(T.t.lambdas.SenderAddressCopied({primaryText:eY}))},type:"item",disabled:!eY},{label:"Group 3",type:"separator"},{label:"Open Command Menu",icon:"⌘ K",type:"item",onSelect:()=>{ex.setCommandMenuOpen(!0)}},{label:"Open in Desktop App",type:"item",disabled:!0}];let ti=(e,t)=>{var l,i,n,r,a;if(e>=t.length)return es?48:30;let d=null===(l=t[e])||void 0===l?void 0:l.messages,s=null===(i=(0,o.zJ)(d,eX))||void 0===i?void 0:i.at(-1),u=(null==s?void 0:s.internalDate)&&new Date(Number(null==s?void 0:s.internalDate)),c=e>0&&(null===(n=(0,o.zJ)(null===(r=t[e-1])||void 0===r?void 0:r.messages,eX))||void 0===n?void 0:n.at(-1)),v=(null==c?void 0:c.internalDate)&&new Date(Number(null==c?void 0:c.internalDate)),m=Date.now()-(null==u?void 0:u.getTime()),p=null==d?void 0:d.find(e=>{var t,l;return null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.parts)||void 0===t?void 0:t.some(e=>e.filename||"text/calendar"===e.mimeType)});if(!s||!u||!v&&e>0)return es?86.5:50.5;let h=!1;if(e>0&&eg.displaySettings.groupingDisplay&&"traditional"===eg.displaySettings.groupingDisplay){let t=(0,o.pE)(e,v,u),l=(0,o.xX)(e,v,u);h=!es&&(t||m<o.jE&&l)}let f=eg.displaySettings.sender||eg.displaySettings.date,g=86.5-(eg.displaySettings.description?0:22)-(f?0:16)+(f||eg.displaySettings.description?0:2)+(p?30:0);return(es?g:50.5)+(h?52.5:0)+((null===(a=window)||void 0===a?void 0:a.devicePixelRatio)>=2?0:h?1:.5)},tn=(0,I.useMemo)(()=>eb.userLabels.find(e=>e.id===eb.currentLabel||e.name===eb.currentLabel),[eb.currentLabel,eb.userLabels]);(0,I.useEffect)(()=>{var e;if(!eC.quickPreviewOpen||!(null==eQ?void 0:eQ.threadId)){ef("");return}null===(e=eS.db)||void 0===e||e.get("mail",eQ.threadId).then(e=>{var t,l;let i=null!==(l=null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.findLast(e=>e.labelIds.includes(eX)||e.labelIds.includes("DRAFT")))&&void 0!==l?l:eQ,n=(0,o.K9)((0,o.Gr)(null==i?void 0:i.payload,!1)),r=n&&new TextDecoder("utf-8").decode(n);r&&ef(null==r?void 0:r.replace(RegExp("<style(.|\\n)*?<\\/style>","gis"),""))})},[eQ,eC.quickPreviewOpen]),(0,I.useEffect)(()=>{var e,t,l,i,n,r;if((null==e_?void 0:e_.current)&&1===ey.currentIndex[0]){let e=localStorage.getItem("scrollPos");if(e&&Number(e)>=0){let o=null!==(n=null==eq?void 0:null===(t=eq.current)||void 0===t?void 0:t.clientHeight)&&void 0!==n?n:56.5;(null!==(r=null==eH?void 0:null===(l=eH.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==r?r:0)>(null===(i=window)||void 0===i?void 0:i.innerHeight)-o&&(eH.current&&(eH.current.style.opacity="0"),setTimeout(()=>{var t;null==e_||null===(t=e_.current)||void 0===t||t.scrollTo(Number(e)),setTimeout(()=>{var e;eH.current&&(eH.current.style.opacity="1"),null==e_||null===(e=e_.current)||void 0===e||e.setState(e=>({...e,scrollUpdateWasRequested:!1}))})},0)),setTimeout(()=>{localStorage.setItem("scrollPos","-1")})}}(null===(e=ey.currentIndex)||void 0===e?void 0:e[1])===-1&&eC.setQuickPreviewOpen(!1)},[ey.currentIndex]),(0,I.useEffect)(()=>{if(null==e_?void 0:e_.current){let e=localStorage.getItem("scrollPos");"-1"!==e&&e||(e_.current.scrollTo(0),1===ey.currentIndex[0]&&-1!==ey.currentIndex[1]&&ey.setCurrentIndex([1,0]))}},[eb.currentLabel]),(0,I.useEffect)(()=>{var e,t,l,i,n,r,o;let a=(null===(t=eH.current)||void 0===t?void 0:null===(e=t.firstChild)||void 0===e?void 0:e.childNodes)&&(null===(l=Array.from(null===(n=eH.current)||void 0===n?void 0:null===(i=n.firstChild)||void 0===i?void 0:i.childNodes))||void 0===l?void 0:l.at(0));a&&tl((null==a?void 0:null===(r=a.dataset)||void 0===r?void 0:r.date)||null),null==e_||null===(o=e_.current)||void 0===o||o.setState(e=>({...e,scrollUpdateWasRequested:!1}))},[eP]),(0,I.useEffect)(()=>{window.location.origin.includes("tatem.com")&&(0,S.redirect)("/");let e=()=>{var e,t,l,i,n;ed(null!==(n=null!==(i=null===(t=document)||void 0===t?void 0:null===(e=t.getElementById("dvh-calculator"))||void 0===e?void 0:e.clientHeight)&&void 0!==i?i:null===(l=window)||void 0===l?void 0:l.innerHeight)&&void 0!==n?n:0),window.innerWidth<640?eu(!0):eu(!1),window.innerWidth>=640&&window.innerWidth<=768?ev(!0):ev(!1)},t=e=>{$.includes(e.key)&&ep(!1)};return e(),window.addEventListener("keydown",t),window.addEventListener("resize",e),()=>{window.removeEventListener("keydown",t),window.removeEventListener("resize",e)}},[eF]),(0,I.useEffect)(()=>{if(e_.current){var e;null==e_||null===(e=e_.current)||void 0===e||e.resetAfterIndex(0)}},[z,es,eg.displaySettings]),(0,I.useEffect)(()=>{if(eC.quickPreviewOpen){let e=document.getElementById("quick-preview-item"),t=e&&e.querySelector("table");if(t){let l=null==t?void 0:t.clientWidth;if(l>(null==e?void 0:e.clientWidth)){let i=(null==e?void 0:e.clientWidth)/l;e.style.transform="scale(".concat(i,")"),e.style.transformOrigin="top left",e.style.marginBottom="-".concat((null==t?void 0:t.clientHeight)*(1-i),"px")}else e.style.transform="",e.style.marginBottom=""}else e&&(e.style.transform="",e.style.marginBottom="")}},[eh]),(0,I.useEffect)(()=>{var e;let t=null===(e=document)||void 0===e?void 0:e.getElementById("main-page");if(t)return t.style.overflowY="hidden",()=>{t.style.overflowY=null,ey.setSelectedIndices([])}},[]);let tr=(0,I.useCallback)(e=>{let t=e?eI.redo():eI.undo();if(t){var l;null==t||null===(l=t.transactions)||void 0===l||l.forEach(l=>{if(l)switch(null==l?void 0:l.type){case W.e.LabelThread:eR({transactionCall:{transaction:l,setReturnThread:t.setReturnThread},isRedo:e,threadList:eC.emailData,workspaceUrl:ez});break;case W.e.BlockSender:case W.e.UnblockSender:eO({email:l.parameters.email,isSenderBlocked:l.type!==W.e.BlockSender,isUndoOrRedo:!0});break;default:throw Error("Invalid Undo/Redo Transaction found.")}})}},[eR,eI.redo,eI.undo,ez,eC.emailData]),to=e=>{!ex.isCommandMenuOpen&&!ew.isModalOpen&&!eC.composeOpen&&"z"===e.key.toLowerCase()&&(0,r.SE)(e)&&(e.preventDefault(),tr(e.shiftKey))},ta=e=>{let t=ex.isCommandMenuOpen||ew.isModalOpen||eC.composeOpen,l=eF.includes("/inbox");if(!t&&l&&"Tab"===e.key){var i,n;e.preventDefault();let t=null==eT?void 0:eT.inboxSplits.filter(e=>!!e.active),l=t.findIndex(e=>eb.currentLabel==="INBOX-split-"+e.value)+(e.shiftKey?-1:1),r=l<0?(null==t?void 0:t.length)-1:l>=(null==t?void 0:t.length)?0:l,o=0===r?"":"/"+(null==t?void 0:null===(n=t[r])||void 0===n?void 0:null===(i=n.name)||void 0===i?void 0:i.toLowerCase());ey.setCurrentIndex([1,0]),eB.push("".concat(ez,"/inbox").concat(o))}};if((0,I.useEffect)(()=>(window.addEventListener("keydown",to),()=>{window.removeEventListener("keydown",to)}),[tr,eF]),(0,I.useEffect)(()=>(window.addEventListener("keydown",ta),()=>{window.removeEventListener("keydown",ta)}),[eF]),(0,I.useEffect)(()=>{if(!ex.isCommandMenuOpen&&!eC.composeOpen&&!ew.isModalOpen&&te){let e=async e=>{var t;let l=(null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key;if(Z.includes(l))switch(l){case"a":(r.V5?e.metaKey:e.ctrlKey)&&(e.preventDefault(),ey.selectedIndices.length===z.length?ey.setSelectedIndices([]):ey.setSelectedIndices(z.map((e,t)=>[1,t])));break;case"x":if((0,r.xN)(e)||1!==ey.currentIndex[0]||e.repeat)return;ey.setSelectedIndices(JSON.stringify(ey.selectedIndices).includes(JSON.stringify([ey.currentIndex[0],ey.currentIndex[1]]))?[...ey.selectedIndices].filter(e=>e[1]!==ey.currentIndex[1]):[...ey.selectedIndices,[ey.currentIndex[0],ey.currentIndex[1]]]);break;case"Escape":if(e.preventDefault(),e.stopPropagation(),ey.selectedIndices.length&&ey.setSelectedIndices([]),e0){let e=document.getElementById("search-page-input");e&&(ey.setCurrentIndex([1,-1]),setTimeout(()=>{e.focus(),e.select()},0))}}},t=e=>{if("Escape"===e.key)e.preventDefault(),e.stopPropagation(),eC.setQuickPreviewOpen(!1);else if(" "===e.key){var t;e.preventDefault(),!e.repeat&&(null===(t=ey.currentIndex)||void 0===t?void 0:t[1])>=0&&(eU(Date.now()),eC.setQuickPreviewOpen(!eC.quickPreviewOpen))}},l=e=>{if(" "===e.key){let t=Date.now();e.preventDefault(),eU(e=>(t-e>200&&setTimeout(()=>{eC.setQuickPreviewOpen(!1)},10),0))}};return window.addEventListener("keyup",l),window.addEventListener("keydown",t),window.addEventListener("keydown",e),()=>{window.removeEventListener("keyup",l),window.removeEventListener("keydown",t),window.removeEventListener("keydown",e)}}},[z,ex.isCommandMenuOpen,eC.composeOpen,ew.isModalOpen,te]),(0,I.useEffect)(()=>{if(e0){let e=document.getElementById("search-page-input");e&&!el&&(e.blur(),(void 0===ey.currentIndex[1]||-1===ey.currentIndex[1])&&ey.setCurrentIndex([1,0]))}},[]),er&&!(null==z?void 0:z.length)&&!el&&!e0&&(null==en?void 0:en.threadsTotal)!==0)return(0,i.jsx)("div",{className:"flex h-[100dvh] w-full flex-col gap-3",children:(0,i.jsxs)("div",{className:"h-full max-w-full",children:[!e0&&(0,i.jsx)(H,{labelData:en,userLabelObj:tn,topThreadDate:tt,innerRef:eq,isMobile:es}),(0,i.jsx)(U.k,{textContent:"Loading your inbox..."})]})});if(el||(null==en?void 0:en.threadsTotal)===0)return(0,i.jsxs)("div",{className:"flex w-full flex-col items-start gap-3",children:[!e0&&(0,i.jsx)(H,{labelData:en,userLabelObj:tn,isScrollActive:!0,innerRef:eq,isMobile:es}),(0,i.jsx)("div",{className:"flex flex-col gap-3 px-5 sm:pl-[46px]",children:e0?(0,i.jsx)(P,{}):(0,i.jsx)(F,{})})]});let td=0;return td=e0?eo?null==z?void 0:z.length:(null==z?void 0:z.length)+1:en&&(null==en?void 0:en.threadsTotal)>(null==z?void 0:z.length)?(null==z?void 0:z.length)+1:null==z?void 0:z.length,(0,i.jsxs)("div",{className:"flex h-[100dvh] w-full flex-col gap-3",children:[(0,i.jsxs)("div",{className:"max-w-full",children:[!e0&&(0,i.jsx)(H,{labelData:en,userLabelObj:tn,topThreadDate:tt,isScrollActive:!0,innerRef:eq,isMobile:es}),eC.quickPreviewOpen&&(0,i.jsxs)("div",{className:"fixed right-4 top-4 z-40 flex flex-col gap-3 rounded-lg p-4 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",children:[(0,i.jsx)("h3",{className:"max-w-[min(calc(100vw-64px),480px)] truncate text-t2 font-medium dark:text-primary-dark sm:max-w-[480px]",children:eZ}),(0,i.jsxs)("div",{className:"body flex items-center justify-between gap-3",children:[(0,i.jsx)("div",{className:"highlight-text truncate",children:eY}),(0,i.jsx)("span",{className:"text-tertiary dark:text-tertiary-dark",children:e$})]}),eh?(0,i.jsx)("div",{className:"body max-h-[calc(100vh-200px)] w-[480px] max-w-[calc(100vw-64px)] overflow-hidden rounded-lg bg-white p-4 dark:bg-fill-dark-base",children:(0,i.jsx)("div",{id:"quick-preview-item",className:(null==eh?void 0:eh.includes("<table"))?"":"whitespace-pre-wrap leading-5",dangerouslySetInnerHTML:{__html:eh}})}):(0,i.jsx)("div",{className:"-mt-3 h-0 w-[480px] max-w-[calc(100vw-64px)] rounded"})]}),(0,i.jsx)("div",{id:"dvh-calculator",className:"absolute left-0 z-[-1] h-[100dvh] w-0"}),(0,i.jsxs)(q.fC,{children:[(0,i.jsx)(q.xz,{id:"context-trigger",onContextMenu:e=>{let t=document.querySelectorAll('[role="menu"]');(null==t?void 0:t.length)>0&&(e.preventDefault(),setTimeout(()=>{var t,l;let i=null===(l=document)||void 0===l?void 0:null===(t=l.elementFromPoint(e.pageX,e.pageY))||void 0===t?void 0:t.closest("a"),n=null==z?void 0:z.findIndex(e=>e.id===(null==i?void 0:i.id));n>=0&&ey.setCurrentIndex([1,n]),setTimeout(()=>{let t=document.getElementById("context-trigger"),l=new MouseEvent("contextmenu",e);null==t||t.dispatchEvent(l)},50)},30))},onMouseMove:e=>{(0,d.b)()&&e.preventDefault(),em||ep(!0)},children:(0,i.jsx)(V.Z,{isItemLoaded:e=>e<(null==z?void 0:z.length),itemCount:td,loadMoreItems:()=>{Q(_+1)},children:e=>{var t,l;let{onItemsRendered:n,ref:r}=e;return(0,i.jsx)(K.S_,{className:b()("fixed-list !overflow-x-hidden overscroll-none",(0,B.u)()),height:ea-(null!==(l=null==eq?void 0:null===(t=eq.current)||void 0===t?void 0:t.clientHeight)&&void 0!==l?l:56.5),itemCount:td,estimatedItemSize:es?86.5:50.5,itemSize:e=>ti(e,z),itemKey:e=>{var t;return(null===(t=z[e])||void 0===t?void 0:t.id)+e},width:"100%",ref:e=>{r(e),e_.current=e},onItemsRendered:n,onScroll:e=>{var t,l,i,n,r,o;let a=e.scrollOffset,d=(null===(l=eH.current)||void 0===l?void 0:null===(t=l.firstChild)||void 0===t?void 0:t.childNodes)&&(null===(i=Array.from(null===(r=eH.current)||void 0===r?void 0:null===(n=r.firstChild)||void 0===n?void 0:n.childNodes))||void 0===i?void 0:i.find(e=>Number(e.style.top.slice(0,-2))>=a));d&&tl((null==d?void 0:null===(o=d.dataset)||void 0===o?void 0:o.date)||null)},outerRef:eH,itemData:{data:z,isHoverActive:em,listRef:e_,setCurrentThreadIndex:ey.setCurrentThreadIndex,cachedAPIContent:eW,currentLabel:eP,isStarred:e1,isMobile:es,isTablet:ec,userLabels:eb.userLabels,cannotArchive:e7,isLoadingMore:null!=et&&et,workspaceUrl:ez,deleteToggleThreads:eE,archiveToggleThreads:eD,starToggleThreads:eA,spamToggleThreads:ej,changeThreadLabels:eL,unreadToggleThreads:eM,blockSenderAction:eO},children:e=>{let{index:t,style:l,data:n}=e;return et&&t===n.data.length?(0,i.jsx)("div",{className:"relative flex flex-col items-center justify-center",style:l,children:(0,i.jsx)(j.J,{path:h.N.Sync,className:"shrink-0 animate-[spin_1s_ease-in-out_infinite] text-primary dark:text-primary-dark"})},"".concat(t,"-loading")):(0,i.jsx)(L,{index:t,data:n,style:l})}})}})}),(0,i.jsx)(J.Z,{items:eK})]})]}),(null===(C=ey.selectedIndices)||void 0===C?void 0:C.length)>0&&(0,i.jsxs)("div",{className:"fixed bottom-5 left-1/2 flex -translate-x-[103px] items-center gap-3 rounded-lg px-3 py-2 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",children:[(0,i.jsxs)("div",{className:"support flex items-center justify-start gap-1",children:[(0,i.jsx)("div",{style:{width:(null===(N=String(null===(E=ey.selectedIndices)||void 0===E?void 0:E.length))||void 0===N?void 0:N.length)*8},className:"tabular-nums tracking-tighter",children:null===(M=ey.selectedIndices)||void 0===M?void 0:M.length})," ","selected"]}),(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:h.N.Archive,variant:"secondary",className:"peer",disabled:e7,onClick:()=>{let e={isActive:e3,primaryText:eZ,count:ey.selectedIndices.length},t=ey.selectedIndices.map(e=>{var t;return null===(t=z[e[1]])||void 0===t?void 0:t.id}),l=t.map(e=>z.find(t=>(null==t?void 0:t.id)===e));if(!l)return;let i=null==l?void 0:l.flatMap(e=>{var t,l;return null==e?void 0:null===(l=e.messages)||void 0===l?void 0:null===(t=l.filter(e=>e3||e.labelIds.includes("INBOX")))||void 0===t?void 0:t.map(e=>e.id)});eD({hasLabel:e3,threadIds:t,emailIds:i,toastProps:e}),ey.setSelectedIndices([])}}),!e7&&(0,i.jsx)(v.M,{title:(e3?s.Wz.Unarchive.title:s.Wz.Archive.title)+((null===(A=ey.selectedIndices)||void 0===A?void 0:A.length)>1?"s":""),keys:s.Wz.Archive.keys,position:"bottom-10 left-1/2 -translate-x-20"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{icon:h.N.Trash,variant:"secondary",className:"peer",onClick:()=>{let e="TRASH"===eb.currentLabel,t=ey.selectedIndices.map(e=>{var t;return null===(t=z[e[1]])||void 0===t?void 0:t.id}),l=t.map(e=>z.find(t=>(null==t?void 0:t.id)===e));if(!l)return;let i={isActive:e6,primaryText:eZ,count:ey.selectedIndices.length};eE({isTrash:e,threadIds:t,emailIds:null==l?void 0:l.flatMap(e=>null==e?void 0:e.messages.map(e=>e.id)),toastProps:i,isArchived:e3,isSpam:e4}),ey.setSelectedIndices([])}}),(0,i.jsx)(v.M,{title:(e6?s.Wz.Undelete.title:s.Wz.Delete.title)+((null===(D=ey.selectedIndices)||void 0===D?void 0:D.length)>1?"s":""),keys:e6?s.Wz.Undelete.keys:s.Wz.Delete.keys,position:"bottom-10 left-1/2 -translate-x-20"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(m.z,{onClick:()=>{ex.setCommandMenuOpen(!0)},icon:h.N.Command,className:"peer",variant:"secondary"}),(0,i.jsx)(v.M,{...s.Wz.OpenCommandMenu,position:"bottom-10 left-1/2 -translate-x-20"})]})]})]})]})})},25441:function(e,t,l){"use strict";l.d(t,{NL:function(){return es},Tb:function(){return Z},pk:function(){return en},nn:function(){return ea},LE:function(){return ei}});var i=l(44003),n=l(70137),r=l(48804),o=l(17115),a=l(39635),d=l(94061),s=l(3984),u=l(80571),c=l(61808),v=l.n(c),m=l(1394),p=l(62516),h=l(63372),f=l(87355),g=l(50026);let b=(0,p.forwardRef)((e,t)=>{let{inputId:l,contact:n,selectedContacts:r,index:a,onRemove:d,isFocused:s,isSelected:c,setFocusContactIndex:m,currentFocusIndex:b,contactsLength:y,focusContacts:x,tempSelectedContacts:k,setTempSelectedContacts:w,setFocusContacts:C,setSelectedContacts:S,setTypeValue:I,dragState:N,setDragState:T}=e,[j,E]=p.useState(!1),[M,A]=p.useState(null),[D,L]=p.useState(!1),[R,O]=p.useState(""),F=(0,u.F)(R),B=e=>{if(e.stopPropagation(),e.preventDefault(),e.shiftKey){if(null===b){m(a),C(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a]);return}let e=b,t=a;if(e>t){let l=e;e=t,t=l}let l=[];for(let i=e;i<=t;i++)l.push(i);C(e=>{let t=new Set(e);return l.forEach(e=>{t.add(e)}),Array.from(t)})}else m(a),C(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},z=(0,p.useCallback)(()=>{let e=R.replace(/>(.*)/,">");S(t=>{var l;let i=[...t],r={...n},o=e.split("<");return r.name=o[0].trim(),r.emailAddress=null===(l=o[1])||void 0===l?void 0:l.replace(">","").trim(),i[a]=r,i}),O(e),L(!1)},[R,S,n,a,l]),_=e=>{if((0,o.SE)(e)&&!e.shiftKey){e.preventDefault();let t=n.name+" <"+n.emailAddress+">";navigator.clipboard.writeText(t)}},H=()=>{let e=r.length-1;m(t=>{if(null===t)return e;let l=k.includes(t),i=k.includes(t-1),n=0===t;if(t>0){if(i)w(e=>e.filter(e=>e!==t));else{if(!l&&!x.includes(t))return w(e=>[...e,t]),t;w(e=>[...e,t-1])}}else n||l||w(e=>[...e,t]);return n?0:t-1})},P=()=>{let e=r.length-1;m(t=>{if(null===t)return null;let l=k.includes(t),i=x.includes(t);if(t<r.length-1){if(k.includes(t+1))w(e=>e.filter(e=>e!==t));else{if(!l&&!i)return w(e=>[...e,t]),t;w(e=>[...e,t+1])}}else l||w([...k,t]);return t===e?e:t+1})};return((0,p.useEffect)(()=>{if(D){let e=document.getElementById("contact-edit-input-".concat(n.emailAddress));e&&(e.focus(),e.select())}else m(null)},[D]),(0,p.useEffect)(()=>{E(!0),O("".concat(n.name," <").concat(n.emailAddress,">"))},[n]),j)?D?(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("span",{className:"h-7 max-w-full overflow-x-auto whitespace-nowrap bg-transparent opacity-0 outline-none",children:R}),(0,i.jsx)("input",{id:"contact-edit-input-".concat(n.emailAddress),value:R,className:"absolute inset-0 touch-none bg-transparent outline-none",onChange:e=>{if(""===e.target.value)d(n.emailAddress,a),L(!1);else if(1===e.target.value.length&&R.length>1){d(n.emailAddress,a);let t=document.getElementById(l);t&&setTimeout(()=>{t.focus(),I(e.target.value)},0)}else O(e.target.value)},type:"text",onBlur:()=>{L(!1)},onClick:e=>{e.stopPropagation()},onKeyDown:e=>{switch(e.stopPropagation(),e.key){case"Enter":e.preventDefault(),z(),setTimeout(()=>{let e=document.getElementById(l);e&&e.focus()},0);break;case"Escape":L(!1);break;case"ArrowRight":if(e.target.selectionStart===R.length){if(z(),a===y-1){let e=document.getElementById(l);e&&e.focus()}else m(a+1)}}},"data-state-edit":D,spellCheck:"false",autoComplete:"off"},"contact-edit-input-".concat(n.emailAddress))]}):(0,i.jsxs)(i.Fragment,{children:[N&&(null==N?void 0:N.container.startsWith(l))&&N.index===a-1&&0===a&&(0,i.jsx)("div",{className:"mr-[-10px] h-4 w-0.5 bg-brand dark:bg-brand-dark"}),(0,i.jsxs)("label",{className:"relative",htmlFor:"selected-contact-handler-".concat(a),children:[(0,i.jsx)("input",{id:"selected-contact-handler-".concat(a),className:"absolute z-[-1] h-0 w-0 touch-none opacity-0",tabIndex:-1,ref:e=>{s&&!D?null==e||e.focus():null==e||e.blur()},onKeyDown:e=>{switch(e.stopPropagation(),e.key){case"Backspace":e.preventDefault(),x.length>0?(S(r.filter((e,t)=>!x.includes(t))),C([]),w([]),setTimeout(()=>{let e=document.getElementById(l);e&&e.focus()},0)):d(n.emailAddress,a);break;case"Enter":(0,o.xN)(e)||(e.preventDefault(),x.length>0&&(w([]),C([])),L(!0));break;case"Escape":if(e.preventDefault(),x.length>0)w([]),C([]);else{let e=document.getElementById(l);s&&(null==e||e.focus())}break;case"ArrowRight":if(e.preventDefault(),(0,o.xN)(e)||e.shiftKey)e.shiftKey&&P();else{if(a===y-1){let e=document.getElementById(l);e&&e.focus();return}m(a+1)}break;case"ArrowLeft":e.preventDefault(),(0,o.xN)(e)||e.shiftKey?e.shiftKey&&H():0!==a&&m(a-1);break;case"c":_(e);break;case"a":(0,o.SE)(e)&&!e.shiftKey&&(e.preventDefault(),C(Array.from({length:y},(e,t)=>t)));break;default:(0,o.xN)(e)||e.preventDefault()}}}),(0,i.jsxs)("div",{id:"selected-contact-".concat(a),tabIndex:-1,className:v()("group/contact peer relative flex h-7 cursor-pointer items-center gap-1 rounded border py-1 pl-2 pr-1 opacity-[.999] outline-none",{"border-button-destructive bg-button-destructive/[.16] text-red-dark-500 dark:border-button-dark-destructive dark:bg-button-dark-destructive/[.16]":!F&&(c||s||M===a),"border-button-destructive bg-button-destructive/[.08] text-red-dark-500 dark:border-button-dark-destructive dark:bg-button-dark-destructive/[.08]":!F&&!c&&!s&&M!==a,"border-brand-link bg-brand-link/[.16] text-brand-link dark:border-brand-dark-link dark:bg-brand-dark-link/[.16] dark:text-brand-dark-link":F&&c&&(s||M===a),"border-brand-link bg-brand-link/[.08] text-brand-link dark:border-brand-dark-link dark:bg-brand-dark-link/[.08] dark:text-brand-dark-link":F&&(c||s)&&!(c&&(s||M===a)),"border-transparent hover:border-border-primary hover:bg-fill-primary dark:hover:border-border-dark-primary dark:hover:bg-fill-dark-primary":F&&!c&&!s}),onMouseEnter:()=>{A(a)},onMouseLeave:()=>{A(null)},onClick:e=>{D||B(e)},onDoubleClick:e=>{e.preventDefault(),e.stopPropagation(),L(!0)},draggable:!0,onDragStart:e=>{var t;e.dataTransfer.effectAllowed="move",null===(t=e.dataTransfer)||void 0===t||t.setData("text/plain","contact");let i=l+"-container";T&&T({contact:n,container:i,index:a,originalIndex:a})},onDragEnd:()=>{let e=l+"-container";setTimeout(()=>{var t,l,i;let r=null===(l=document)||void 0===l?void 0:null===(t=l.getElementById(null==N?void 0:N.container))||void 0===t?void 0:t.textContent;N.container&&N.container!==e&&N.container!==(null==e?void 0:e.replace("-container",""))&&(null==r?void 0:r.includes(null==N?void 0:null===(i=N.contact)||void 0===i?void 0:i.name))&&d(n.emailAddress,a),T&&T(null)},10)},children:[N&&(0,i.jsx)("div",{className:"absolute left-0 h-full w-1/2 bg-transparent",onDragEnter:e=>{let t=l+"-container";T&&((null==N?void 0:N.container)!==t||(null==N?void 0:N.index)!==a-1)&&T({...N,container:t,index:a-1})}}),N&&(0,i.jsx)("div",{className:"absolute right-0 h-full w-1/2 bg-transparent",onDragEnter:e=>{let t=l+"-container";T&&((null==N?void 0:N.container)!==t||(null==N?void 0:N.index)!==a)&&T({...N,container:t,index:a})}}),(0,i.jsxs)("div",{className:"flex max-w-[300px] items-center gap-x-1",children:[(0,i.jsx)("span",{className:v()("max-w-full truncate text-body font-medium"),children:n.name}),(0,i.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),d(n.emailAddress,a)},tabIndex:-1,type:"button",className:v()("flex h-5 w-5 items-center justify-center rounded-sm duration-0",{"text-quartery hover:bg-fill-primary hover:text-primary dark:text-quartery-dark dark:hover:bg-fill-dark-primary dark:hover:text-primary-dark":F&&!(c||s)},{"hover:bg-brand-link/[.08] dark:hover:bg-brand-dark-link/[.08]":F&&(c||s)},{"hover:bg-button-destructive/[.08] dark:hover:bg-button-dark-destructive/[.08]":!F}),children:(0,i.jsx)(f.J,{path:g.N.Close})})]})]}),(0,i.jsx)(h.M,{title:"".concat(n.name," [").concat(n.emailAddress,"]"),position:"left-0 top-9"})]}),N&&(null==N?void 0:N.container.startsWith(l))&&N.index===a&&(0,i.jsx)("div",{className:"-mx-[5px] h-4 w-0.5 bg-brand dark:bg-brand-dark"})]}):null});b.displayName="SelectedContact";var y=l(1918);let x={frequent:1,directory:2,connection:3,manual:4},k=(0,m.Pi)(e=>{let{id:t,name:l,selectedContacts:n,setSelectedContacts:r,onBlur:c,dragState:m,setDragState:h}=e,[f,g]=(0,p.useState)(!1),[k,w]=(0,p.useState)(""),[C]=(0,d.c)(k,10,{leading:!0}),[S,I]=(0,p.useState)(()=>[]),[N,T]=(0,p.useState)(0),[j,E]=(0,p.useState)(null),[M,A]=(0,p.useState)([]),[D,L]=(0,p.useState)([]),[R,O]=(0,p.useState)([]),[F,B]=(0,p.useState)(!1),[z,_]=(0,p.useState)(!1),H=(0,p.useRef)(null),P=(0,p.useRef)(null),{composeStore:{setCurrentFocusedContact:U},peopleStore:W,sidebarStore:q}=(0,s.m)();(0,p.useEffect)(()=>{if(!W.allContacts)return;let e=C.trim().toLowerCase();if(e){let t=(0,u.v)(e),l=W.allContacts.filter(t=>t.emailAddress.toLowerCase().includes(e.toLowerCase())||t.displayName&&t.displayName.toLowerCase().includes(e.toLowerCase())).map(e=>({name:e.displayName,emailAddress:e.emailAddress.toLowerCase(),photoUrl:e.photoUrl,sourceType:e.sourceType})).slice(0,6).sort((e,t)=>x[e.sourceType]-x[t.sourceType]),i=t||0===l.length?[{name:e,emailAddress:e,sourceType:"manual"}]:l;I(i),T(0),B(i.length>0)}else I([])},[C.length]);let K=(0,p.useCallback)(e=>{(null==n?void 0:n.some(t=>t.emailAddress===e.emailAddress))||(r(t=>[...t,e]),w(""),I([]),U(e))},[n,r]),V=e=>{if(!(S.length<1)&&S){if(C.length>0)e.preventDefault(),K(S[N]);else{if(!C||""===C)return;e.preventDefault(),K(S[N])}}},J=e=>{if(e.preventDefault(),e.ctrlKey||e.metaKey){setTimeout(()=>{T(e=>S.length-1)},0);return}setTimeout(()=>{T(e=>{let t=e+1;return t<S.length?t:e})},0)},X=e=>{if(e.preventDefault(),(0,o.SE)(e)){setTimeout(()=>{T(0)},0);return}setTimeout(()=>{T(e=>{let t=e-1;return t>=0?t:e})},0)},G=e=>{e.preventDefault(),0===S.length&&(0,u.v)(C)&&w(""),F&&S.length>0&&K(S[N])},Q=(e,t)=>{var l;r(n.filter(t=>t.emailAddress!==e));let i=M.filter(e=>e!==t);E(null),A(i),null===(l=P.current)||void 0===l||l.focus()},Z=(0,p.useCallback)(e=>{w(e.target.value),null!==j&&E(null)},[w,j,E]),Y=e=>{var t,l,i,r;switch((null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key){case"Escape":F&&(e.stopPropagation(),B(!1));break;case"Enter":G(e);break;case"Tab":V(e);break;case"Backspace":!C&&n.length>0&&(null===(l=P.current)||void 0===l||l.blur(),E(n.length-1));break;case"ArrowUp":X(e);break;case"ArrowDown":J(e);break;case"ArrowLeft":!C&&(e.preventDefault(),null===(i=P.current)||void 0===i||i.blur(),E(n.length-1),e.shiftKey&&A([...M,n.length-1]));break;case"a":if(0===n.length||C||e.shiftKey)return;(0,o.SE)(e)&&!e.shiftKey&&(e.preventDefault(),null===(r=P.current)||void 0===r||r.blur(),E(e=>null===e?n.length-1:e),A(n.map((e,t)=>t)))}};return((0,p.useEffect)(()=>{F&&S.length>0&&-1===N&&T(0)},[F]),(0,p.useEffect)(()=>{R.length>0&&L(e=>{let t=0===e.length?M:e;return A(Array.from(new Set([...t,...R]))),t})},[R]),(0,p.useEffect)(()=>{U(S[null!=N?N:0])},[N]),(0,p.useEffect)(()=>{U(null!==j?n[j]:null)},[j]),(0,p.useEffect)(()=>{g(!0)},[]),f)?(0,i.jsxs)("div",{className:"group relative mr-4 flex h-auto min-w-0 flex-1 cursor-text flex-wrap items-center justify-start gap-x-1 gap-y-1 rounded py-2",id:t+"-container",onClick:e=>{var t;null===(t=P.current)||void 0===t||t.focus()},onKeyUp:e=>{e.shiftKey||(R.length>0&&O([]),L([]))},onDragOver:e=>{e.preventDefault()},onDrop:e=>{if(e.preventDefault(),(null==m?void 0:m.container)!==t+"-container")return;let l=null==m?void 0:m.contact;if(l){let e=[...n],t=[],i=e.findIndex(e=>l.emailAddress===e.emailAddress);i>=0?(e.splice(i,1),e.splice(Math.max((null==m?void 0:m.index)+(i<=(null==m?void 0:m.index)?0:1),0),0,n[i]),t=e):t=(null==e?void 0:e.length)?[...e.slice(0,(null==m?void 0:m.index)+1),l,...e.slice((null==m?void 0:m.index)+1,null==e?void 0:e.length)]:[l],r(t)}setTimeout(()=>{var e;null===(e=document.getElementById(t))||void 0===e||e.focus()},10)},children:[Array.isArray(n)&&(null==n?void 0:n.map((e,l)=>{var o;return(0,i.jsx)(b,{inputId:t,ref:H,index:l,contact:e,selectedContacts:n,currentFocusIndex:j,contactsLength:n.length,onRemove:Q,isFocused:j===l,isSelected:null!==(o=null==M?void 0:M.includes(l))&&void 0!==o&&o,focusContacts:M,tempSelectedContacts:R,setTempSelectedContacts:O,setFocusContactIndex:E,setSelectedContacts:r,setFocusContacts:A,setTypeValue:w,dragState:m,setDragState:h},l)})),m&&(null==m?void 0:m.container.startsWith(t))&&!(null==n?void 0:n.length)&&(0,i.jsx)("div",{className:"absolute left-0 h-4 w-0.5 bg-brand dark:bg-brand-dark"}),(0,i.jsxs)("div",{className:"relative -mr-14 grow [&:not(:first-child)]:pl-1.5",children:[(0,i.jsx)("input",{id:t,name:l,ref:P,className:v()("body h-7 w-full flex-1 touch-none bg-transparent pr-6 font-medium outline-none placeholder:select-none placeholder:text-quartery dark:placeholder:text-quartery-dark",{"max-md:caret-transparent":q.sidebarOpen}),placeholder:n.length>0?"":"Recipients",type:"text",value:k,size:(null==k?void 0:k.length)>0?null==k?void 0:k.length:1,autoComplete:"off",spellCheck:"false",onChange:e=>{Z(e)},onPaste:e=>{let t=Array.from(e.clipboardData.getData("text").matchAll(/(?:([^,<>]+)\s*<)?([^,<>@\s]+@[^,<>@\s]+)>(?:,\s*|$)/g));if(t.length>0){e.preventDefault();let l=t.map(e=>{var t;return{name:(null===(t=e[1])||void 0===t?void 0:t.trim())||e[2].split("@")[0],emailAddress:e[2],sourceType:"manual"}});r(e=>e.some(e=>l.some(t=>t.emailAddress===e.emailAddress))?e:[...e,...l])}},onBlur:e=>{setTimeout(()=>{z||B(!1)},0),c&&c(e)},onMouseDownCapture:()=>{(0,a.b)()&&(null==P?void 0:P.current)&&(P.current.style.fontSize="16px",setTimeout(()=>{P.current&&(P.current.style.fontSize="13px")}))},onFocusCapture:()=>{(null==P?void 0:P.current)&&(P.current.style.fontSize="13px")},onFocus:e=>{e.preventDefault(),setTimeout(()=>{S.length>0&&B(!0)},0),null!==j&&E(null),M.length>0&&A([])},onKeyDown:e=>{Y(e)},onDragEnter:e=>{(null==m?void 0:m.container)!==t+"-container"&&h&&h({...m,container:t+"-container",index:(null==n?void 0:n.length)?(null==n?void 0:n.length)-1:0})}},t),(0,i.jsx)("div",{className:"relative z-20",children:F&&(0,i.jsx)(y.w,{suggestions:S,selectedContacts:n,typedValue:C,onSelect:K,focusIndex:N,setFocusIndex:T,showSuggestions:F,setIsMouseInsideSuggestionList:_,inputRef:P})})]})]},t+"-container"):null}),w=["application/x-msaccess","application/vnd.android.package-archive","application/appx","application/appxbundle","application/x-msdos-program","application/vnd.ms-cab-compressed","application/vnd.ms-htmlhelp","application/cmd","application/cpl","application/diagcab","application/diagcfg","application/diagpkg","application/x-msdownload","application/x-apple-diskimage","application/ex","application/hta","application/octet-stream","application/x-internet-signup","application/java-archive","application/x-java-jnlp-file","application/javascript","application/x-javascript","text/javascript","application/x-ms-shortcut","application/msix","application/msixbundle","application/x-nsh","application/x-sh","application/x-powershell","application/x-screensaver","application/x-sct","application/x-shb","application/x-sys","application/x-vbscript","application/x-vhd","application/x-vxd","application/x-wsc","application/x-wsf","application/x-wsh","application/vnd.ms-excel"],C=[".ade",".adp",".apk",".appx",".appxbundle",".bat",".cab",".chm",".cmd",".com",".cpl",".diagcab",".diagcfg",".diagpkg",".dll",".dmg",".ex",".ex_",".exe",".hta",".img",".ins",".iso",".isp",".jar",".jnlp",".js",".jse",".lib",".lnk",".mde",".mjs",".msc",".msi",".msix",".msixbundle",".msp",".mst",".nsh",".pif",".ps1",".scr",".sct",".shb",".sys",".vb",".vbe",".vbs",".vhd",".vxd",".wsc",".wsf",".wsh",".xll"];var S=l(32930),I=l(64751),N=l.t(I,2),T=l(79496),j=l.t(T,2);let E=e=>{var t,l,n,r,o;let{x:a,y:d,active:s,search:u,editor:c,editorRef:m,setEmojiMenu:h}=e,[f,g]=(0,p.useState)([]),[b,y]=(0,p.useState)(0),[x,k]=(0,p.useState)(null),w=(0,p.useRef)(null),C=e=>{c.modifyBlocks(t=>{let l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT);for(;l.nextNode();){var i,n;(null===(n=l.currentNode)||void 0===n?void 0:null===(i=n.textContent)||void 0===i?void 0:i.includes(":".concat(u)))&&(l.currentNode.textContent=l.currentNode.textContent.replace(":".concat(u),e))}return t}),h(null)},I=(0,p.useMemo)(()=>u?f.filter(e=>{var t,l;return(null==e?void 0:e.keywords)?null==e?void 0:null===(t=e.keywords)||void 0===t?void 0:t.find(e=>null==e?void 0:e.includes(u)):null==e?void 0:null===(l=e.slug)||void 0===l?void 0:l.includes(u)}):f,[u]),T=e=>{"ArrowDown"===e.key?(e.preventDefault(),y(e=>{var t;let l=Math.min((null==I?void 0:I.length)-1,e+1,10);return null===(t=document.getElementById("emoji-option-".concat(l)))||void 0===t||t.scrollIntoView({block:"nearest"}),l>=0?l:0})):"ArrowUp"===e.key?(e.preventDefault(),y(e=>{var t;let l=Math.max(e-1,0);return null===(t=document.getElementById("emoji-option-".concat(l)))||void 0===t||t.scrollIntoView({block:"nearest"}),l})):"Enter"===e.key&&(e.preventDefault(),y(e=>{var t;let l=null===(t=document)||void 0===t?void 0:t.getElementById("emoji-option-"+e);return setTimeout(()=>{null==l||l.click()},10),-1}))};(0,p.useEffect)(()=>{g(Object.keys(j).map(e=>{var t;return"default"===e?null:{...j[e],emoji:e,keywords:null===(t=N[e])||void 0===t?void 0:t.map(e=>e.replaceAll(" ","_"))}}).filter(e=>e))},[]),(0,p.useEffect)(()=>{if(s)return y(0),window.addEventListener("keydown",T),()=>{window.removeEventListener("keydown",T)}},[null==I?void 0:I.length,s]),(0,p.useEffect)(()=>{var e;k(null==m?void 0:null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect())},[a]);let E=(null===(t=window)||void 0===t?void 0:t.innerWidth)-(null!==(r=null==x?void 0:x.left)&&void 0!==r?r:0)-((null==w?void 0:null===(l=w.current)||void 0===l?void 0:l.clientWidth)?null==w?void 0:null===(n=w.current)||void 0===n?void 0:n.clientWidth:435)-a>20;return(0,i.jsx)("div",{ref:w,className:v()("absolute z-10 flex select-none flex-col items-start gap-0.5 rounded-lg p-1 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",{hidden:!s},{"rte-modal":s}),style:{top:d?d+24:0,left:E?null!=a?a:0:"auto",right:E?"auto":(null!==(o=null==x?void 0:x.right)&&void 0!==o?o:0)-(window.innerWidth-12),maxHeight:216},children:(0,i.jsx)("div",{className:v()("h-full w-full overflow-y-auto",(0,S.u)()),children:(null==I?void 0:I.length)>0?I.map((e,t)=>{if(t>10)return null;let l=b===t;return(0,i.jsxs)("button",{id:"emoji-option-".concat(t),className:v()("flex w-full items-center justify-start gap-1.5 truncate whitespace-nowrap rounded px-3 py-2 text-body",{"bg-fill-primary text-primary dark:bg-fill-dark-primary dark:text-primary-dark":l,"text-secondary dark:text-secondary-dark":!l}),onMouseEnter:()=>{y(t)},onClick:()=>C(null==e?void 0:e.emoji),children:[null==e?void 0:e.emoji," :",null==e?void 0:e.slug]},null==e?void 0:e.slug)}):(0,i.jsxs)("button",{id:"emoji-option-0",className:v()("flex w-full items-center justify-start gap-2 whitespace-nowrap rounded px-3 py-2 text-body",{"bg-fill-primary text-primary dark:bg-fill-dark-primary dark:text-primary-dark":0===b}),onClick:()=>h(null),children:["No Results Found",(0,i.jsx)("span",{className:"text-support text-quartery dark:text-quartery-dark",children:"Close"})]})})})};var M=l(93629);let A=(0,m.Pi)(e=>{var t,l,n,r,o;let{x:a,y:d,link:u,editor:c,editorRef:m,setLinkMenu:h}=e,{toastStore:{addToast:f}}=(0,s.m)(),g=(0,p.useRef)(null),[b,y]=(0,p.useState)(null),x=()=>{h(null)};(0,p.useEffect)(()=>{if(u)return window.addEventListener("click",x),()=>{window.removeEventListener("click",x)}},[u]),(0,p.useEffect)(()=>{var e;y(null==m?void 0:null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect())},[a]);let k=(null===(t=window)||void 0===t?void 0:t.innerWidth)-(null!==(r=null==b?void 0:b.left)&&void 0!==r?r:0)-((null==g?void 0:null===(l=g.current)||void 0===l?void 0:l.clientWidth)?null==g?void 0:null===(n=g.current)||void 0===n?void 0:n.clientWidth:435)-a>20;return(0,i.jsxs)("div",{ref:g,className:v()("absolute z-10 flex min-w-[238px] select-none flex-col rounded-lg p-1 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",{hidden:!u},{"rte-modal":!!a}),style:{top:d?d+24:0,left:k?null!=a?a:0:"auto",right:k?"auto":(null!==(o=null==b?void 0:b.right)&&void 0!==o?o:0)-(window.innerWidth-12)},onClick:e=>{e.preventDefault()},children:[(0,i.jsx)("button",{className:"body w-full rounded px-3 py-2 text-left hover:bg-fill-primary dark:hover:bg-fill-dark-primary",onClick:()=>{var e;null===(e=window)||void 0===e||e.open(u,"_blank"),h(null)},children:"Open in New Tab ↗"}),(0,i.jsx)("button",{className:"body w-full rounded px-3 py-2 text-left hover:bg-fill-primary dark:hover:bg-fill-dark-primary",onClick:()=>{var e,t,l;let i="height=".concat(null===(e=window)||void 0===e?void 0:e.innerHeight,",width=").concat(null===(t=window)||void 0===t?void 0:t.innerWidth);null===(l=window)||void 0===l||l.open(u,"_blank",i),h(null)},children:"Open in New Window ↗"}),(0,i.jsx)("button",{className:"body w-full rounded px-3 py-2 text-left hover:bg-fill-primary dark:hover:bg-fill-dark-primary",onClick:()=>{var e,t;null===(t=navigator)||void 0===t||null===(e=t.clipboard)||void 0===e||e.writeText(u),h(null),f(M.t.lambdas.UrlCopied({primaryText:u})),setTimeout(()=>{null==c||c.focus()},10)},children:"Copy Link"}),(0,i.jsx)("button",{className:"body w-full rounded px-3 py-2 text-left hover:bg-fill-primary dark:hover:bg-fill-dark-primary",onClick:()=>{null==c||c.removeLink(),h(null)},children:"Remove Link"})]})}),D=[[{title:"Bulleted List",shortcut:["⌘","⇧","7"],onClick:e=>{e.makeUnorderedList()}},{title:"Numbered List",shortcut:["⌘","⇧","8"],onClick:e=>{e.makeOrderedList()}},{title:"Quote",shortcut:["⌘","⇧","9"],onClick:e=>{var t,l,i;e.decreaseQuoteLevel(),e.increaseQuoteLevel();let n=null==e?void 0:e.getSelection();if((null==n?void 0:null===(l=n.startContainer)||void 0===l?void 0:null===(t=l.parentElement)||void 0===t?void 0:t.tagName)==="BLOCKQUOTE"){let t=document.createRange();t.setStart(null==n?void 0:null===(i=n.startContainer)||void 0===i?void 0:i.parentElement,0),t.collapse(!0),e.setSelection(t),setTimeout(()=>{e.insertHTML(String.fromCharCode(8203))},10)}}}],[{title:"Attach File",shortcut:["⌘","⇧","A"],onClick:()=>{var e;null===(e=document.querySelector("input[type=file]"))||void 0===e||e.click()}}],[{title:"Emoji",shortcut:[":emoji"],onClick:e=>{e.insertHTML(":")}}]],L=(e,t,l)=>{let i=e.getSelection(),n=t?(null==i?void 0:i.startOffset)-(null==t?void 0:t.length):1;if(null==e||e.forEachBlock(e=>{var i,r;if((null===(i=e.innerText)||void 0===i?void 0:i.includes(t))||!t&&e.innerText.includes("/")){let i=null===(r=e.innerText)||void 0===r?void 0:r.replaceAll(String.fromCharCode(8203),"");e.innerText=l?i.replaceAll("/".concat(null!=t?t:""),String.fromCharCode(8203)):i.substring(0,n-1)+i.substring(n+(t?null==t?void 0:t.length:0))}}),l){var r;let t=document.createRange();t.setStartAfter(null==i?void 0:null===(r=i.startContainer)||void 0===r?void 0:r.firstChild),t.collapse(!1),e.setSelection(t)}},R=e=>{var t,l,n,r,o,a;let{x:d,y:s,active:u,search:c,editor:m,editorRef:h,setSlashMenu:f,setEmojiMenu:g}=e,[b,y]=(0,p.useState)(0),[x,k]=(0,p.useState)(null),w=(0,p.useRef)(null);(0,p.useEffect)(()=>{var e;k(null==h?void 0:null===(e=h.current)||void 0===e?void 0:e.getBoundingClientRect())},[d]);let C=(null===(t=window)||void 0===t?void 0:t.innerWidth)-(null!==(o=null==x?void 0:x.left)&&void 0!==o?o:0)-((null==w?void 0:null===(l=w.current)||void 0===l?void 0:l.clientWidth)?null==w?void 0:null===(n=w.current)||void 0===n?void 0:n.clientWidth:435)-d>20,I=(0,p.useMemo)(()=>(c?D.flat().filter(e=>{var t,l,i,n;return null===(n=e.title)||void 0===n?void 0:null===(i=n.toLowerCase())||void 0===i?void 0:null===(l=i.replace(/\s/g,""))||void 0===l?void 0:l.includes(null==c?void 0:null===(t=c.toLowerCase())||void 0===t?void 0:t.replace(/\s/g,""))}):D.flat()).filter(e=>!((null==m?void 0:m.hasFormat("li"))&&(e.title.includes("Heading")||e.title.includes("Text")))),[c,u]),N=e=>{"ArrowDown"===e.key?(e.preventDefault(),y(e=>{var t;let l=Math.min((null==I?void 0:I.length)-1,e+1,10);return null===(t=document.getElementById("slash-option-".concat(l)))||void 0===t||t.scrollIntoView({block:"nearest"}),l>=0?l:0})):"ArrowUp"===e.key?(e.preventDefault(),y(e=>{var t;let l=Math.max(e-1,0);return null===(t=document.getElementById("slash-option-".concat(l)))||void 0===t||t.scrollIntoView({block:"nearest"}),l})):"Enter"===e.key&&(e.preventDefault(),y(e=>{var t;let l=null===(t=document)||void 0===t?void 0:t.getElementById("slash-option-"+e);return setTimeout(()=>{null==l||l.click()},10),-1}))};return(0,p.useEffect)(()=>{if(u){var e,t;return y(0),(null===(e=w.current)||void 0===e?void 0:e.scrollTop)>0&&(null==w||null===(t=w.current)||void 0===t||t.scrollTo({top:0})),window.addEventListener("keydown",N),()=>{window.removeEventListener("keydown",N)}}},[null==I?void 0:I.length,u]),(0,i.jsx)("div",{className:v()("absolute z-10 flex select-none flex-col items-start gap-0.5 rounded-lg py-1 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",{hidden:!u},{"rte-modal":u}),style:{top:s?s+24:0,left:C?null!=d?d:0:"auto",right:C?"auto":(null!==(a=null==x?void 0:x.right)&&void 0!==a?a:0)-(window.innerWidth-12),opacity:(null==w?void 0:null===(r=w.current)||void 0===r?void 0:r.clientWidth)?1:0,maxHeight:216},children:(0,i.jsx)("div",{className:v()("h-full w-full overflow-y-auto overflow-x-hidden",(0,S.u)()),ref:w,children:u&&(null==I?void 0:I.length)>0?I.map((e,t)=>{var l;let n=b===t,r=!c&&D.find(t=>t[0].title===e.title);return(0,i.jsxs)(p.Fragment,{children:[r&&(0,i.jsx)("hr",{className:"my-1 w-full border-t border-border-primary first-of-type:hidden dark:border-border-dark-primary"}),(0,i.jsx)("div",{className:"px-1",children:(0,i.jsxs)("button",{id:"slash-option-".concat(t),className:v()("flex w-full items-center justify-between gap-1.5 whitespace-nowrap rounded px-3 py-2 text-body",{"bg-fill-primary text-primary dark:bg-fill-dark-primary dark:text-primary-dark":n,"text-secondary dark:text-secondary-dark":!n}),onMouseEnter:()=>{y(t)},onClick:()=>{m.focus(),e.title.includes("Heading")||e.title.includes("Text")||L(m,c),e.onClick(m),(e.title.includes("Heading")||e.title.includes("Text"))&&L(m,c,!0),f(null),"Emoji"===e.title&&g({x:d,y:s,active:!0,search:null})},children:[null==e?void 0:e.title,(0,i.jsx)("span",{className:"flex items-center justify-end gap-0.5 text-support text-quartery dark:text-quartery-dark",children:null==e?void 0:null===(l=e.shortcut)||void 0===l?void 0:l.map((e,t)=>(0,i.jsx)("span",{className:"block px-[3px] py-px",style:{width:1===e.length?16:"auto"},children:e},t))})]})})]},t)}):(0,i.jsx)("div",{className:"px-1",children:(0,i.jsxs)("button",{id:"slash-option-0",className:v()("flex w-full items-center justify-start gap-2 rounded px-3 py-2 text-body",{"bg-fill-primary text-primary dark:bg-fill-dark-primary dark:text-primary-dark":0===b}),onClick:()=>f(null),children:["No Results Found",(0,i.jsx)("span",{className:"text-support text-quartery dark:text-quartery-dark",children:"Close"})]})})})})};var O=l(39359),F=l(78488),B=l(16502),z=l(17157),_=l(87767),H=l(44424),P=l(81243);let U=["#000000D9","#513373","#005EBE","#0E7049","#FFA300","#FF4C14","#FF406C","#B5241E"],W=["#FFF","#A28DD1","#66CFFF","#4ACB78","#FFE562","#FFA95E","#FFA6D1","#FF7B74"],q=["H1","H2","H3","H4"],K=(0,m.Pi)(e=>{var t,l,r,a,d,u,c,m,f,b,y,x,k,w,C,S,I,N,T,j,E,A,D,L,R,B,z,_,H,K,V,J,X,G,Q,Z,Y,$,ee,et,el,ei,en;let{x:er,y:eo,editor:ea,editorRef:ed,mode:es,setRichTextMenu:eu,link:ec,selection:ev,selectedStyles:em,setSelectedStyles:ep}=e,[eh,ef]=(0,p.useState)(-1),[eg,eb]=(0,p.useState)(-1),[ey,ex]=(0,p.useState)(null),ek=(0,p.useRef)(null),{toastStore:{addToast:ew}}=(0,s.m)(),eC=e=>{var t,l,i,n;(null===(t=e.target)||void 0===t?void 0:t.tagName)==="INPUT"||(0,o.SE)(e)||"link"===es||e.preventDefault();let r="color"===es?U:"highlight"===es?W:q;if("ArrowRight"===e.key)eb(e=>Math.min((null==r?void 0:r.length)-1,e+1));else if("ArrowLeft"===e.key)eb(e=>Math.max(0,e-1));else if("Enter"===e.key)eb(e=>{var t;let l=null===(t=document)||void 0===t?void 0:t.getElementById("sub-menu-"+e);return setTimeout(()=>{null==l||l.click()},100),-1}),setTimeout(()=>{eu(e=>({...e,mode:""}))},100);else if("h"===e.key.toLowerCase()&&e.metaKey&&e.shiftKey){if("highlight"===es){let e=eh+1>=(null==r?void 0:r.length)?0:Math.min((null==r?void 0:r.length)-1,eh+1),t=null===(l=document)||void 0===l?void 0:l.getElementById("sub-menu-"+e);null==t||t.click(),ef(e)}}else if("o"===e.key.toLowerCase()&&e.metaKey&&!e.shiftKey){if("color"===es){let e=eh+1>=(null==r?void 0:r.length)?0:Math.min((null==r?void 0:r.length)-1,eh+1),t=null===(i=document)||void 0===i?void 0:i.getElementById("sub-menu-"+e);null==t||t.click(),ef(e)}}else if("6"===e.key&&e.metaKey&&e.shiftKey&&"text"===es){let e=eh+1>=(null==r?void 0:r.length)?0:Math.min((null==r?void 0:r.length)-1,eh+1),t=null===(n=document)||void 0===n?void 0:n.getElementById("sub-menu-"+e);null==t||t.click(),ef(e)}};(0,p.useEffect)(()=>{var e,t,l,i,n,r,o,a,d,s,u,c,v,m;if(es){if("color"===es||"highlight"===es){let m="color"===es?null==ev?void 0:null===(l=ev.startContainer)||void 0===l?void 0:null===(t=l.parentElement)||void 0===t?void 0:null===(e=t.style)||void 0===e?void 0:e.color:(null==ev?void 0:null===(r=ev.startContainer)||void 0===r?void 0:null===(n=r.parentElement)||void 0===n?void 0:null===(i=n.style)||void 0===i?void 0:i.backgroundColor)?null==ev?void 0:null===(d=ev.startContainer)||void 0===d?void 0:null===(a=d.parentElement)||void 0===a?void 0:null===(o=a.style)||void 0===o?void 0:o.backgroundColor:null==ev?void 0:null===(v=ev.startContainer)||void 0===v?void 0:null===(c=v.parentElement)||void 0===c?void 0:null===(u=c.parentElement)||void 0===u?void 0:null===(s=u.style)||void 0===s?void 0:s.backgroundColor,p="color"===es?U:W,h=null==p?void 0:p.findIndex(e=>(null==m?void 0:m.replaceAll(" ",""))==="rgb(".concat((0,P.oo)(e.slice(1)),")"));ef(h>0?h:0),eb(h>0?h:0)}if("text"===es){let e=null==q?void 0:q.findIndex(e=>ea.hasFormat(e));ef(e>=0?e:(null==q?void 0:q.length)-1),eb(e>=0?e:(null==q?void 0:q.length)-1)}}else ev&&!es&&(ef(-1),eb(-1),null==ed||null===(m=ed.current)||void 0===m||m.focus(),setTimeout(()=>{Math.abs((null==ev?void 0:ev.endOffset)-(null==ev?void 0:ev.startOffset))>0||null==ea||ea.setSelection(ev)},200))},[es]),(0,p.useEffect)(()=>{if(es)return eh!==eg&&eb(eh),window.addEventListener("keydown",eC),()=>{window.removeEventListener("keydown",eC)}},[es,eh]),(0,p.useEffect)(()=>{var e;ex(null==ed?void 0:null===(e=ed.current)||void 0===e?void 0:e.getBoundingClientRect())},[er]);let eS=(null===(t=window)||void 0===t?void 0:t.innerWidth)-(null!==(el=null==ey?void 0:ey.left)&&void 0!==el?el:0)-((null==ek?void 0:null===(l=ek.current)||void 0===l?void 0:l.clientWidth)?null==ek?void 0:null===(r=ek.current)||void 0===r?void 0:r.clientWidth:435)-er>20;return(0,i.jsx)("div",{id:"rich-text-menu",ref:ek,className:v()("absolute z-10 flex select-none items-center gap-0.5 rounded-lg p-1 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-fill-overlay before:shadow-layer-sm before:backdrop-blur-menu dark:before:bg-fill-dark-overlay before:dark:shadow-control-dark",{hidden:!er&&0!==er||!eo},{"rte-modal":!!er}),style:{top:eo?eo-8-40:0,left:eS?null!=er?er:0:"auto",right:eS?"auto":(null!==(ei=null==ey?void 0:ey.right)&&void 0!==ei?ei:0)-((null===(a=window)||void 0===a?void 0:a.innerWidth)-12)},onMouseLeave:()=>{eb(eh)},children:"link"===es?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{id:"rich-text-menu-link-input",autoFocus:!ec,defaultValue:ec,className:"body w-[300px] bg-transparent pl-2 outline-none placeholder:text-muted dark:placeholder:text-muted-dark",placeholder:"Enter URL",onKeyDown:e=>{if("Enter"===e.key){var t,l,i,n;let r=null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value;if(r){e.preventDefault();let t=r.startsWith("https://")?r:"https://"+r.replace("http://","");if(null==ea?void 0:ea.hasFormat("a")){let e=document.createRange();e.setStartBefore(null==ev?void 0:ev.startContainer),e.setEndAfter(null==ev?void 0:ev.startContainer),null==ea||ea.changeFormat({tag:"A",attributes:{href:t}},{tag:"A"},e)}else null==ea||ea.makeLink(t);let o=document.createRange();o.setEndAfter((null==ev?void 0:null===(l=ev.startContainer)||void 0===l?void 0:l.nodeName)==="#text"?null==ev?void 0:null===(i=ev.endContainer)||void 0===i?void 0:i.firstElementChild:null==ev?void 0:null===(n=ev.startContainer)||void 0===n?void 0:n.firstElementChild),o.collapse(),null==ea||ea.setSelection(o)}}else"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{ec?eu({}):eu(e=>({...e,mode:null}))}))}}),(0,i.jsx)("div",{className:"dark:border-border-primary-dark mx-0.5 h-4 w-0 border-r border-border-primary"}),(null==ea?void 0:ea.hasFormat("a"))&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.External,variant:"tertiary",className:"peer",onClick:()=>{window.open(ec)}}),(0,i.jsx)(h.M,{...n.Wz.OpenInNewTab,position:"bottom-10 left-1/2 -translate-x-1/2"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Copy,variant:"tertiary",className:"peer",onClick:()=>{window.navigator.clipboard.writeText(ec),ew(M.t.lambdas.UrlCopied({primaryText:ec}))}}),(0,i.jsx)(h.M,{...n.Wz.CopyLink,position:"bottom-10 left-1/2 -translate-x-1/2"})]})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Trash,variant:"tertiary",className:"peer",onClick:()=>{(null==ea?void 0:ea.hasFormat("a"))&&(null==ea||ea.removeLink()),eu({})}}),(0,i.jsx)(h.M,{...n.Wz.RemoveLink,position:"bottom-10 left-1/2 -translate-x-1/2"})]})]}):"text"===es?(0,i.jsx)("div",{className:"flex items-center gap-0.5",children:q.map((e,t)=>{let l=eg===t,n=eh===t;return(0,i.jsx)("div",{className:"relative",onMouseEnter:()=>{eb(t)},onMouseUp:()=>{setTimeout(()=>{eu(e=>({...e,mode:""}))},10)},children:(0,i.jsx)(O.z,{id:"sub-menu-"+t,icon:g.N[e],iconClassName:l?"!opacity-[.85]":"",className:v()("hover:bg-fill-secondary hover:dark:bg-fill-dark-secondary",{"bg-fill-secondary dark:bg-fill-dark-secondary":l&&!n},{"bg-transparent":!l&&!n},{"!bg-fill-tertiary dark:!bg-fill-dark-tertiary":n}),variant:"tertiary",onClick:()=>{var l,i;ea.modifyBlocks(function(t){if(1!=t.children.length)return t;let l=t.firstElementChild;if(null===l)return t;let i=l.tagName==e||"H4"===e?"DIV":e,n=t.ownerDocument.createElement(i);for(;null!==l.firstChild;)n.append(l.firstChild);return n});let n=ea.getSelection();if((null==n?void 0:null===(i=n.startContainer)||void 0===i?void 0:null===(l=i.textContent)||void 0===l?void 0:l.length)===0){ea.focus();let e=document.createRange();e.setStartBefore(null==n?void 0:n.startContainer),ea.setSelection(e)}ef(t)}})},e)})}):"color"===es?(0,i.jsx)("div",{className:"flex items-center gap-0.5",children:U.map((e,t)=>{let l=eh===t;return(0,i.jsx)("div",{className:"relative",onMouseEnter:()=>{eb(t)},onMouseUp:()=>{setTimeout(()=>{eu(e=>({...e,mode:""}))},10)},children:(0,i.jsx)(O.z,{id:"sub-menu-"+t,icon:(0,i.jsx)("div",{className:"rounded-full bg-primary dark:bg-primary-dark",style:{backgroundColor:0===t?"":e,width:13.33,height:13.33}}),className:v()("peer hover:bg-fill-secondary hover:dark:bg-fill-dark-secondary",{"bg-fill-secondary dark:bg-fill-dark-secondary":eg===t&&!l},{"bg-transparent":eg!==t&&!l},{"!bg-fill-tertiary dark:!bg-fill-dark-tertiary":l}),variant:"tertiary",onClick:()=>{null==ea||ea.setTextColor(0===t?"":e),ef(t)}})},e)})}):"highlight"===es?(0,i.jsx)("div",{className:"flex items-center gap-0.5",children:W.map((e,t)=>{let l=eh===t;return(0,i.jsx)("div",{className:"relative",onMouseEnter:()=>{eb(t)},onMouseUp:()=>{setTimeout(()=>{eu(e=>({...e,mode:""}))},10)},children:(0,i.jsx)(O.z,{id:"sub-menu-"+t,icon:(0,i.jsx)("div",{className:(0===t?"border border-border-secondary ":"")+"rounded-sm bg-base dark:bg-base-dark",style:{backgroundColor:0===t?"":e,width:13.33,height:9.33}}),className:v()("peer hover:bg-fill-secondary hover:dark:bg-fill-dark-secondary",{"!bg-fill-tertiary dark:!bg-fill-dark-tertiary":l},{"bg-fill-secondary dark:bg-fill-dark-secondary":eg===t&&!l},{"bg-transparent":eg!==t&&!l}),variant:"tertiary",onClick:()=>{var l,i,n;let r=null==ev?void 0:null===(n=ev.startContainer)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.style)||void 0===l?void 0:l.color;null==ea||ea.setHighlightColor(0===t?"":e),r&&(null==ea||ea.setTextColor(r)),ef(t)}})},e)})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{id:"rich-text-menu-bold-button",icon:g.N.Bold,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("b"))||(null==em?void 0:em.bold)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("b"))||(null==em?void 0:em.bold)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("b"))||(null==em?void 0:em.bold)?(null==ea||ea.removeBold(),em.bold&&ep({...em,bold:!1})):null==ea||ea.bold()}}),(0,i.jsx)(h.M,{...n.Wz.Bold,position:"bottom-10 left-1/2 -translate-x-12"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{id:"rich-text-menu-italic-button",icon:g.N.Italic,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("i"))||(null==em?void 0:em.italics)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("i"))||(null==em?void 0:em.italics)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("i"))||(null==em?void 0:em.italics)?(null==ea||ea.removeItalic(),em.italics&&ep({...em,italics:!1})):null==ea||ea.italic()}}),(0,i.jsx)(h.M,{...n.Wz.Italicize,position:"bottom-10 left-1/2 -translate-x-14"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{id:"rich-text-menu-underline-button",icon:g.N.Underline,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("u"))||(null==em?void 0:em.underline)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("u"))||(null==em?void 0:em.underline)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("u"))||(null==em?void 0:em.underline)?(null==ea||ea.removeUnderline(),em.underline&&ep({...em,underline:!1})):null==ea||ea.underline()}}),(0,i.jsx)(h.M,{...n.Wz.Underline,position:"bottom-10 left-1/2 -translate-x-16"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{id:"rich-text-menu-strikethrough-button",icon:g.N.Strikethrough,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("s"))||(null==em?void 0:em.strikethrough)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("s"))||(null==em?void 0:em.strikethrough)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("s"))||(null==em?void 0:em.strikethrough)?(null==ea||ea.removeStrikethrough(),em.strikethrough&&ep({...em,strikethrough:!1})):null==ea||ea.strikethrough()}}),(0,i.jsx)(h.M,{...n.Wz.Strikethrough,position:"bottom-10 left-1/2 -translate-x-1/2"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Link,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("a"))||(null==em?void 0:em.link)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("a"))||(null==em?void 0:em.link)?"!opacity-[.85]":"",onClick:()=>{if((null==ea?void 0:ea.hasFormat("a"))||(null==em?void 0:em.link))null==ea||ea.removeLink(),em.link&&ep({...em,link:!1});else{let t=null==ea?void 0:ea.getSelectedText();if((0,F.P)(t,!0)){var e;let l=t.includes("://")?t:"https://".concat(t);null==ea||ea.makeLink(l,{target:"_blank",rel:"noopener noreferrer"});let i=document.createRange();i.setEndAfter(null==ev?void 0:null===(e=ev.startContainer)||void 0===e?void 0:e.nextSibling),i.collapse(!1),null==ea||ea.setSelection(i)}else eu({x:er,y:eo,selection:ev,mode:"link"})}}}),(0,i.jsx)(h.M,{...n.Wz.Hyperlink,position:"bottom-10 left-1/2 -translate-x-16"})]})]}),(0,i.jsx)("div",{className:"mx-0.5 h-4 w-0 border-r border-border-primary dark:border-border-dark-primary"}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Highlight,variant:"tertiary",className:"peer "+((null==ev?void 0:null===(c=ev.startContainer)||void 0===c?void 0:null===(u=c.parentElement)||void 0===u?void 0:null===(d=u.style)||void 0===d?void 0:d.backgroundColor)&&(null==ev?void 0:null===(b=ev.startContainer)||void 0===b?void 0:null===(f=b.parentElement)||void 0===f?void 0:null===(m=f.style)||void 0===m?void 0:m.backgroundColor)!=="rgb(255, 255, 255)"||(null==ev?void 0:null===(w=ev.startContainer)||void 0===w?void 0:null===(k=w.parentElement)||void 0===k?void 0:null===(x=k.parentElement)||void 0===x?void 0:null===(y=x.style)||void 0===y?void 0:y.backgroundColor)&&(null==ev?void 0:null===(N=ev.startContainer)||void 0===N?void 0:null===(I=N.parentElement)||void 0===I?void 0:null===(S=I.parentElement)||void 0===S?void 0:null===(C=S.style)||void 0===C?void 0:C.backgroundColor)!=="rgb(255, 255, 255)"?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ev?void 0:null===(E=ev.startContainer)||void 0===E?void 0:null===(j=E.parentElement)||void 0===j?void 0:null===(T=j.style)||void 0===T?void 0:T.backgroundColor)||(null==ev?void 0:null===(R=ev.startContainer)||void 0===R?void 0:null===(L=R.parentElement)||void 0===L?void 0:null===(D=L.parentElement)||void 0===D?void 0:null===(A=D.style)||void 0===A?void 0:A.backgroundColor)?"!opacity-[.85]":"",onClick:()=>{var e;setTimeout(()=>{eu({x:er,y:eo,selection:ev,mode:"highlight"})},30),null==ed||null===(e=ed.current)||void 0===e||e.focus()}}),(0,i.jsx)(h.M,{...n.Wz.HighlightText,position:"bottom-10 left-1/2 -translate-x-24"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:(0,i.jsx)("div",{className:((null==ev?void 0:null===(_=ev.startContainer)||void 0===_?void 0:null===(z=_.parentElement)||void 0===z?void 0:null===(B=z.style)||void 0===B?void 0:B.color)&&(null==ev?void 0:null===(V=ev.startContainer)||void 0===V?void 0:null===(K=V.parentElement)||void 0===K?void 0:null===(H=K.style)||void 0===H?void 0:H.color)!=="rgba(0, 0, 0, 0.85)"?"!opacity-[.85]":"opacity-70 group-hover/button:opacity-[.85]")+" rounded-full bg-black dark:bg-white",style:{backgroundColor:null!==(en=null==ev?void 0:null===(G=ev.startContainer)||void 0===G?void 0:null===(X=G.parentElement)||void 0===X?void 0:null===(J=X.style)||void 0===J?void 0:J.color)&&void 0!==en?en:"",width:13.33,height:13.33}}),className:"peer "+((null==ev?void 0:null===(Y=ev.startContainer)||void 0===Y?void 0:null===(Z=Y.parentElement)||void 0===Z?void 0:null===(Q=Z.style)||void 0===Q?void 0:Q.color)&&(null==ev?void 0:null===(et=ev.startContainer)||void 0===et?void 0:null===(ee=et.parentElement)||void 0===ee?void 0:null===($=ee.style)||void 0===$?void 0:$.color)!=="rgba(0, 0, 0, 0.85)"?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),variant:"tertiary",onClick:()=>{var e;setTimeout(()=>{eu({x:er,y:eo,selection:ev,mode:"color"})},30),null==ed||null===(e=ed.current)||void 0===e||e.focus()}}),(0,i.jsx)(h.M,{...n.Wz.ColorText,position:"bottom-10 left-1/2 -translate-x-16"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.TextSize,className:((null==ea?void 0:ea.hasFormat("h1"))||(null==ea?void 0:ea.hasFormat("h2"))||(null==ea?void 0:ea.hasFormat("h3"))?"!bg-fill-tertiary hover:bg-fill-secondary dark:!bg-fill-dark-tertiary dark:hover:bg-fill-dark-secondary":"")+" peer",variant:"tertiary",onClick:()=>{var e;setTimeout(()=>{eu({x:er,y:eo,selection:ev,mode:"text"})},30),null==ed||null===(e=ed.current)||void 0===e||e.focus()}}),(0,i.jsx)(h.M,{...n.Wz.ResizeText,position:"bottom-10 left-1/2 -translate-x-[86px]"})]})]}),(0,i.jsx)("div",{className:"mx-0.5 h-4 w-0 border-r border-border-primary dark:border-border-dark-primary"}),(0,i.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.BulletList,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("ul"))||(null==em?void 0:em.bulletedList)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("ul"))||(null==em?void 0:em.bulletedList)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("ul"))||(null==em?void 0:em.bulletedList)?(null==ea||ea.removeList(),em.bulletedList&&ep({...em,bulletedList:!1})):null==ea||ea.makeUnorderedList()}}),(0,i.jsx)(h.M,{...n.Wz.BulletedList,position:"bottom-10 left-1/2 -translate-x-24"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.NumberList,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("ol"))||(null==em?void 0:em.numberedList)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("ol"))||(null==em?void 0:em.numberedList)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("ol"))||(null==em?void 0:em.numberedList)?(null==ea||ea.removeList(),em.numberedList&&ep({...em,numberedList:!1})):null==ea||ea.makeOrderedList()}}),(0,i.jsx)(h.M,{...n.Wz.NumberedList,position:"bottom-10 left-1/2 -translate-x-24"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Quote,variant:"tertiary",className:"peer "+((null==ea?void 0:ea.hasFormat("blockquote"))||(null==em?void 0:em.blockquote)?"!bg-fill-primary hover:!bg-fill-secondary dark:!bg-fill-dark-primary dark:hover:!bg-fill-dark-secondary":""),iconClassName:(null==ea?void 0:ea.hasFormat("blockquote"))||(null==em?void 0:em.blockquote)?"!opacity-[.85]":"",onClick:()=>{(null==ea?void 0:ea.hasFormat("blockquote"))||(null==em?void 0:em.blockquote)?(null==ea||ea.decreaseQuoteLevel(),em.blockquote&&ep({...em,blockquote:!1})):(null==ea||ea.decreaseQuoteLevel(),null==ea||ea.increaseQuoteLevel())}}),(0,i.jsx)(h.M,{...n.Wz.Quote,position:"bottom-10 left-1/2 -translate-x-20"})]})]}),(0,i.jsx)("div",{className:"mx-0.5 h-4 w-0 border-r border-border-primary dark:border-border-dark-primary"}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.RemoveStyle,className:"peer hover:bg-fill-secondary dark:hover:bg-fill-dark-secondary",variant:"tertiary",onClick:()=>{null==ea||ea.removeAllFormatting()}}),(0,i.jsx)(h.M,{...n.Wz.RemoveFormatting,position:"bottom-10 left-1/2 -translate-x-[86px]"})]})})]})})});var V=l(9112),J=l(27799),X=l(31248);l(89798);let G=e=>0===e.recipient.length?B.xK.RECIPIENT_REQUIRED:e.recipient.every(e=>Q(e))?e.cc.length>0&&!e.cc.every(e=>(0,u.v)(e)||(0,u.F)(e))?B.xK.INVALID_CC:e.bcc.length>0&&!e.bcc.every(e=>(0,u.v)(e)||(0,u.F)(e))?B.xK.INVALID_BCC:""===e.subject.trim()?B.xK.SUBJECT_MISSING:B.xK.SUCCESS:B.xK.INVALID_RECIPIENT,Q=e=>e.match(/^([^<>]+) <([^<>]+)>$/)?(0,u.F)(e):(0,u.v)(e),Z=26109542.4,Y='<div dir="ltr"><br></div>',$=o.V5?"Meta-":"Ctrl-",ee=e=>{let t=e.match(/^(.*?)\s*<(\S+@\S+\.\S+)>$/);if(t){let e=""===t[1].trim()?t[2]:t[1],l=t[2];return e.includes('"')&&(0,u.v)(e.replaceAll('"',""))&&(e=null==e?void 0:e.replaceAll('"',"")),[{name:e,emailAddress:l,sourceType:"manual"}]}return e.trim()?[{name:e,emailAddress:e,sourceType:"manual"}]:[]},et=(e,t)=>{let l=e.filter(e=>/image/.test(e.type));if(!l.length)return!1;let i=new FileReader;i.onload=e=>{var l,i,n;(null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.result)&&"string"==typeof(null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.result)&&(null==t||t.insertImage(null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.result,{}))},null==l||l.forEach(e=>{i.readAsDataURL((null==e?void 0:e.getAsFile)?null==e?void 0:e.getAsFile():e)})},el=async e=>{var t,l,i,n;let{files:r,emailData:o,setAlertModalObj:a,messageId:d="",setAlertModalOpen:s}=e,u=Array.from(r),c=[],v=null!==(i=null===(t=null!==(l=null==o?void 0:o.attachments)&&void 0!==l?l:[])||void 0===t?void 0:t.reduce((e,t)=>e+t.body.size,0))&&void 0!==i?i:0;for(let e of u){let t=null===(n=e.name.substring(e.name.lastIndexOf(".")))||void 0===n?void 0:n.toLowerCase();if(w.includes(e.type)||C.includes(t)){a({alertMsg:"File Type Not Supported",alertDescription:'"'.concat(e.name,'" is not supported. Please try another file type.'),alertCode:B.xK.INVALID_FILE_TYPE,focusIdOnClose:"attachment-button"+(d?"-".concat(d):""),onClose:{title:"OK",onClick:()=>{}}}),s(!0);break}if(e.size>Z){a({alertMsg:"File Size Exceeded",alertDescription:"Please upload a file less than 25 MB in size to continue.",alertCode:B.xK.FILE_SIZE_EXCEEDED,focusIdOnClose:"attachment-button"+(d?"-".concat(d):""),onClose:{title:"OK",onClick:()=>{}}}),s(!0);break}if((v+=e.size)>Z){a({alertMsg:"Total File Size Limit Exceeded",alertDescription:"Please limit the upload to a maximum of 25 MB in size to continue.",alertCode:B.xK.FILE_SIZE_EXCEEDED,focusIdOnClose:"attachment-button"+(d?"-".concat(d):""),onClose:{title:"OK",onClick:()=>{}}}),s(!0);break}c.push(e)}if(0!==c.length)return await Promise.all(c.map(async e=>{let t=await (0,J.Qi)(e);return{filename:e.name,contentType:e.type,data:String(t).replace("data:image/png;base64,",""),body:{size:e.size}}}))},ei=e=>"string"==typeof e?e.split(", ").flatMap(ee):Array.isArray(e)?e.flatMap(e=>"string"==typeof e?ee(e):[e]):[],en=function(e,t){let l,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t?"-".concat(t):"";(l=e?i?document.querySelector(".editor"):document.getElementById("editor"+n):i?document.querySelector("#recipient-input-group input"):document.getElementById("recipient-input"+n))&&(l.style.fontSize="16px",l.focus())},er=(e,t)=>{if(e&&!(null==t?void 0:t.selection)){var l;let t=null==e?void 0:e.getRoot(),i=null==t?void 0:t.querySelector(".gmail_quote"),n=null==i?void 0:i.querySelector(".gmail_attr");if(i&&n&&(null===(l=n.textContent)||void 0===l?void 0:l.includes("----- Forwarded"))){let t=document.createRange(),l=i.previousElementSibling;t.setStartBefore(null!=l?l:i),t.collapse(!0),null==e||e.setSelection(t)}else null==e||e.moveCursorToEnd()}},eo=e=>e.name&&e.name!==e.emailAddress?"".concat(e.name," <").concat(e.emailAddress,">"):e.emailAddress,ea=e=>Array.isArray(e)?null==e?void 0:e.map(e=>eo(e)):[],ed=e=>e.filter(e=>Q(eo(e))),es=(0,m.Pi)(e=>{var t,d,u,c;let{sendMail:m,exitFn:f,initialEmailData:b=X.ox,open:y=!0,originalMessage:x=null,messageId:w=null,exitText:C,emailData:I,setEmailData:N,saveDraft:T,doesFocusOnMount:j}=e,{commandMenuStore:M,modalsStore:D,sidebarStore:L}=(0,s.m)(),[P,U]=(0,p.useState)(b),W=null!=I?I:P,q=null!=N?N:U,[Q,Z]=(0,p.useState)(!!(null===(t=b.cc)||void 0===t?void 0:t.length)),[ee,eo]=(0,p.useState)(!!(null===(d=b.bcc)||void 0===d?void 0:d.length)),[es,eu]=(0,p.useState)(!1),ec=(0,p.useRef)(null),ev=(0,p.useRef)(!1),em=(0,p.useRef)(null),ep=(0,p.useRef)(null),[eh,ef]=(0,p.useState)(null),[eg,eb]=(0,p.useState)({}),[ey,ex]=(0,p.useState)({}),[ek,ew]=(0,p.useState)(null),[eC,eS]=(0,p.useState)(null),[eI,eN]=(0,p.useState)(null),[eT,ej]=(0,p.useState)(!0),[eE,eM]=(0,p.useState)(!1),[eA,eD]=(0,p.useState)([]),[eL,eR]=(0,p.useState)([]),[eO,eF]=(0,p.useState)([]),[eB,ez]=(0,p.useState)(!1),[e_,eH]=(0,p.useState)(null),eP=(0,p.useRef)(null),eU=(0,_.usePathname)(),eW=(0,p.useMemo)(()=>eU.includes("/compose"),[eU]),eq=(0,p.useMemo)(()=>!!w,[w]),eK=(0,p.useRef)(""),eV=(0,p.useRef)(null),eJ=(e,t)=>l=>{var i;let n,r=[];"function"==typeof l?e(e=>{let t=l(e);return r=t,t}):(e(l),r=l);let o=ed(r);q(e=>{let l={...e,[t]:ea(o)};return n=l,l}),T&&n&&T(n,null!==(i=null==eh?void 0:eh.getHTML())&&void 0!==i?i:"")},eX=(0,p.useMemo)(()=>{if(b.forwardedMessage){var e,t,l,i,n,r,o,a,d,s,u;let c=document.createRange().createContextualFragment(b.forwardedMessage),v=null==c?void 0:c.querySelector("title");v&&c.removeChild(v);let m=document.createElement("div");return m.appendChild(c.cloneNode(!0)),'<div><br/><br/><div class="gmail_quote"><div class="gmail_attr">---------- Forwarded Message ----------</div><br/>'+"From: ".concat(null==x?void 0:null===(l=x.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:null===(e=t.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===e?void 0:e.value.replaceAll("<","&lt;").replaceAll(">","&gt;"),"<br/>")+"Date: ".concat(null==x?void 0:null===(n=x.dateRecieved)||void 0===n?void 0:null===(i=n.toLocaleString("en-us",V.V))||void 0===i?void 0:i.replace(/(,)(?!.*\1)/," at"),"<br/>")+"Subject: ".concat(null==x?void 0:null===(a=x.payload)||void 0===a?void 0:null===(o=a.headers)||void 0===o?void 0:null===(r=o.find(e=>"Subject"===e.name))||void 0===r?void 0:r.value,"<br/>")+"To: ".concat(null==x?void 0:null===(u=x.payload)||void 0===u?void 0:null===(s=u.headers)||void 0===s?void 0:null===(d=s.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="to"}))||void 0===d?void 0:d.value.replaceAll("<","&lt;").replaceAll(">","&gt;"),"<br/><br/>")+m.innerHTML+"</div></div>"}},[x,b]),eG=(0,p.useMemo)(()=>{var e,t,l,i,n;return x&&'<br/><div class="gmail_quote"><div class="gmail_attr" dir="ltr">On '.concat(null==x?void 0:null===(t=x.dateRecieved)||void 0===t?void 0:null===(e=t.toLocaleString("en-us",V.V))||void 0===e?void 0:e.replace(/(,)(?!.*\1)/," at")," ").concat(null==x?void 0:null===(n=x.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value.replaceAll("<","&lt;").replaceAll(">","&gt;"),' wrote:</div><blockquote style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex" class="gmail_quote">').concat(null==x?void 0:x.html,"</blockquote></div>")},[x]),eQ=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.modifyBlocks(function(t){if(1!=t.children.length)return t;let i=t.firstElementChild;if(null===i)return t;let n=i.tagName==e||"H4"===e?"DIV":e,r=t.ownerDocument.createElement(n);for(;null!==i.firstChild;){let e=i.firstChild;l&&(e.textContent=String.fromCharCode(8203)),r.append(e)}return r})},eZ=async e=>{if(e){ez(!0);try{var t,l,i;let n=null!==(t=await el({files:e,emailData:W,setAlertModalObj:D.setAlertModalObj,setAlertModalOpen:D.setAlertModalOpen,messageId:w}))&&void 0!==t?t:[],r=null!==(l=W.attachments)&&void 0!==l?l:[],o={...W,attachments:[...r,...n]};q(o),T&&n.length&&T(o,null!==(i=null==eh?void 0:eh.getHTML())&&void 0!==i?i:"")}catch(e){console.error("File upload error:",e),D.setAlertModalObj({alertMsg:"File Upload Failed",alertDescription:"Please try again.",alertCode:B.xK.FILE_UPLOAD_ERROR,focusIdOnClose:"attachment-button"+(w?"-".concat(w):""),onClose:{title:"OK",onClick:()=>{}}}),D.setAlertModalOpen(!0)}finally{ez(!1)}}},eY=e=>{var t;let l=W.attachments.filter((t,l)=>l!==e),i={...W,attachments:l};q(i),en(!!(null==W?void 0:W.recipient.length),w),T&&T(i,null!==(t=null==eh?void 0:eh.getHTML())&&void 0!==t?t:"")},e$={onDragOver:e=>{var t,l,i;if(e.preventDefault(),(null==e?void 0:null===(l=e.dataTransfer)||void 0===l?void 0:null===(t=l.types)||void 0===t?void 0:t[0])==="text/plain")return;let n="editor"+(w?"-".concat(w):""),r=null===(i=document.getElementById(n))||void 0===i?void 0:i.closest("[role=dialog]");r&&(r.style.backgroundColor="rgba(0,0,0,.03)")},onDragLeave:e=>{var t;e.preventDefault();let l="editor"+(w?"-".concat(w):""),i=null===(t=document.getElementById(l))||void 0===t?void 0:t.closest("[role=dialog]");i&&(i.style.backgroundColor="")},onDrop:async e=>{var t,l;e.preventDefault();let i="editor"+(w?"-".concat(w):""),n=null===(t=document.getElementById(i))||void 0===t?void 0:t.closest("[role=dialog]");n&&(n.style.backgroundColor="");let r=null==e?void 0:null===(l=e.dataTransfer)||void 0===l?void 0:l.files,o=Array.from(r).filter(e=>/image/.test(e.type));(null==o?void 0:o.length)===(null==r?void 0:r.length)?eh&&et(o,eh):eZ(r)}};(0,p.useEffect)(()=>{let e=async()=>{var e,t,i,n,r,a,d;let s=(await l.e(7216).then(l.bind(l,17216))).default;if(!(null==ec?void 0:ec.current))return;let u=new s(null==ec?void 0:ec.current,{blockTag:"div",blockAttributes:{dir:"ltr"},tagAttributes:{blockquote:{style:"padding: 8px; background-color: #0000000A"},a:{target:"_blank"}}});if(b.forwardedMessage||(null==x?void 0:x.draft)||(null==b?void 0:b.message)){let t=(null==x?void 0:x.draft)?(0,J.K9)((0,J.Gr)(null==x?void 0:null===(e=x.draft)||void 0===e?void 0:e.payload)):null,l=t&&new TextDecoder("utf-8").decode(t),i=null!=l?l:(null==b?void 0:b.message)?null==b?void 0:b.message:eX;i&&i.trim()!==Y?(u.setHTML(i),eM(!1),null==eh||eh.moveCursorToEnd()):eM(!0)}else eM(!0);if(u.addEventListener("select",()=>{var e,t,l,i,n,r,o,a,d,s,c,v,m,p,h,f;let g=u.getCursorPosition(),b=null==ec?void 0:null===(l=ec.current)||void 0===l?void 0:null===(t=l.parentElement)||void 0===t?void 0:null===(e=t.parentElement)||void 0===e?void 0:e.getBoundingClientRect(),y={},x=u.getSelection();if(0===(null===(i=u.getSelectedText().replaceAll("\n",""))||void 0===i?void 0:i.trim()).length||(null==x?void 0:null===(r=x.startContainer)||void 0===r?void 0:null===(n=r.innerHTML)||void 0===n?void 0:n.includes("<img"))){eb({});return}if((null==u?void 0:u.hasFormat("a"))&&(y.link=null!==(v=null==x?void 0:null===(d=x.startContainer)||void 0===d?void 0:null===(a=d.parentElement)||void 0===a?void 0:a.href)&&void 0!==v?v:null==x?void 0:null===(c=x.endContainer)||void 0===c?void 0:null===(s=c.parentElement)||void 0===s?void 0:s.href,y.mode="link"),eb(e=>({...e,x:g.x-b.left,y:g.y-b.top,...y,selection:x})),ew(e=>e?{...e,active:!1}:null),eS(e=>e?{...e,active:!1}:null),x.commonAncestorContainer&&(null==x?void 0:null===(o=x.commonAncestorContainer)||void 0===o?void 0:o.hasChildNodes())){let e=(0,J.gg)(x.commonAncestorContainer),t=(null===(p=x.startContainer)||void 0===p?void 0:null===(m=p.parentElement)||void 0===m?void 0:m.tagName)!=="DIV"?x.startContainer.parentElement:x.startContainer,l=e.findIndex(e=>e.textContent===(null==t?void 0:t.textContent)),i=(null===(f=x.endContainer)||void 0===f?void 0:null===(h=f.parentElement)||void 0===h?void 0:h.tagName)!=="DIV"?x.endContainer.parentElement:x.endContainer,n=e.indexOf(i),r=e.slice(l>=0?l:n>=0?n:0,n>=0?n+1:l>=0?l+1:void 0).flatMap(e=>e.hasChildNodes()?[e.nodeName,...Array.from(e.childNodes).map(e=>e.nodeName)]:e.nodeName);ex({bold:r.includes("B"),italics:r.includes("I"),underline:r.includes("U"),strikethrough:r.includes("S"),bulletedList:r.includes("UL"),numberedList:r.includes("OL"),link:r.includes("A")})}else ex({})}),u.addEventListener("cursor",e=>{var t,l,i,n,r;let o=null==e?void 0:null===(t=e.detail)||void 0===t?void 0:t.range;if(o&&o.startOffset===(null===(i=o.commonAncestorContainer)||void 0===i?void 0:null===(l=i.textContent)||void 0===l?void 0:l.length))switch(null===(r=o.commonAncestorContainer)||void 0===r?void 0:null===(n=r.nextSibling)||void 0===n?void 0:n.nodeName){case"B":u.bold();break;case"I":u.italic();break;case"S":u.strikethrough();break;case"U":u.underline()}eb({}),ex({})}),u.addEventListener("input",()=>{var e;let t=null==ec?void 0:null===(e=ec.current)||void 0===e?void 0:e.textContent;(null==u?void 0:u.getHTML())!==Y&&"Sent from Tatem Mail"!==t?eM(!1):eM(!0)}),u.addEventListener("click",e=>{if(null==u?void 0:u.hasFormat("a")){var t,l,i;let e=u.getSelection();if(0===e.startOffset||e.endOffset===(null==e?void 0:null===(l=e.startContainer)||void 0===l?void 0:null===(t=l.textContent)||void 0===t?void 0:t.length))return;let n=null===(i=document)||void 0===i?void 0:i.createRange();n.selectNodeContents(null==e?void 0:e.startContainer),null==u||u.setSelection(n)}let n=e.target;if("IMG"===n.nodeName){let e=document.createRange();e.setStartBefore(n),e.setEndAfter(n),null==u||u.setSelection(e)}eS(null),ew(null)}),u.addEventListener("blur",e=>{var t,l,i,n,r,o,a,d,s;(null==e?void 0:null===(n=e.relatedTarget)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:null===(t=l.parentElement)||void 0===t?void 0:t.id)==="rich-text-menu"||(null==e?void 0:null===(a=e.relatedTarget)||void 0===a?void 0:null===(o=a.parentElement)||void 0===o?void 0:null===(r=o.parentElement)||void 0===r?void 0:r.id)==="rich-text-menu"||(null==e?void 0:null===(s=e.relatedTarget)||void 0===s?void 0:null===(d=s.parentElement)||void 0===d?void 0:d.id)==="rich-text-menu"||eb({})}),u.addEventListener("pasteImage",e=>{et([...e.detail.clipboardData.items],u)}),u.addEventListener("willPaste",e=>{var t,l,i;if(null===(t=e.detail)||void 0===t?void 0:t.fragment){let t=null===(l=e.detail)||void 0===l?void 0:l.fragment;(null===(i=t.querySelectorAll("table"))||void 0===i?void 0:i.length)||t.querySelectorAll("[style]").forEach(e=>{e.setAttribute("style",""),e.setAttribute("class","")})}}),u.setKeyHandler("".concat($,"d"),()=>null),u.setKeyHandler("".concat($,"Shift-").concat(o.V5?"x":"X"),(e,t)=>{t.preventDefault();let l=document.getElementById("rich-text-menu-strikethrough-button");null==l||l.click()}),u.setKeyHandler("".concat($,"b"),(e,t)=>{t.preventDefault();let l=document.getElementById("rich-text-menu-bold-button");null==l||l.click()}),u.setKeyHandler("".concat($,"i"),(e,t)=>{t.preventDefault();let l=document.getElementById("rich-text-menu-italic-button");null==l||l.click()}),u.setKeyHandler("".concat($,"u"),(e,t)=>{t.preventDefault();let l=document.getElementById("rich-text-menu-underline-button");null==l||l.click()}),u.setKeyHandler("".concat($,"Shift-6"),(e,t)=>{var l,i,n;t.preventDefault();let r=u.getCursorPosition(),o=null==ec?void 0:null===(n=ec.current)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.getBoundingClientRect();return setTimeout(()=>{eb(e=>{var t,l;return{...e,x:null!==(t=e.x)&&void 0!==t?t:r.x-o.left,y:null!==(l=e.y)&&void 0!==l?l:r.y-o.top,mode:"text"}})}),null}),u.setKeyHandler("".concat($,"Shift-7"),(e,t)=>{t.preventDefault(),(null==e?void 0:e.hasFormat("ul"))?null==e||e.removeList():null==e||e.makeUnorderedList()}),u.setKeyHandler("".concat($,"Shift-8"),(e,t)=>{t.preventDefault(),(null==e?void 0:e.hasFormat("ol"))?null==e||e.removeList():null==e||e.makeOrderedList()}),u.setKeyHandler("".concat($,"Shift-9"),(e,t)=>{t.preventDefault(),(null==e?void 0:e.hasFormat("blockquote"))?null==e||e.decreaseQuoteLevel():(null==e||e.decreaseQuoteLevel(),null==e||e.increaseQuoteLevel())}),u.setKeyHandler("".concat($,"k"),(e,t)=>{var l,i,n,r,o;t.preventDefault();let a=null==u?void 0:u.getSelectedText();if(a&&(0,F.P)(a,!0)){let e=a.includes("://")?a:"https://".concat(a);null==u||u.makeLink(e,{target:"_blank",rel:"noopener noreferrer"});let t=document.createRange(),l=null==u?void 0:u.getSelection();t.setEndAfter(null==l?void 0:l.startContainer),t.collapse(!1),null==u||u.setSelection(t);return}if(!a){M.setCommandMenuOpen(!0);return}let d=u.getSelection(),s=null==d?void 0:null===(i=d.startContainer)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.href,c=u.getCursorPosition(),v=null==ec?void 0:null===(o=ec.current)||void 0===o?void 0:null===(r=o.parentElement)||void 0===r?void 0:null===(n=r.parentElement)||void 0===n?void 0:n.getBoundingClientRect();eb(e=>{var t,l;return{...e,x:null!==(t=e.x)&&void 0!==t?t:c.x-v.left,y:null!==(l=e.y)&&void 0!==l?l:c.y-v.top,mode:"link",link:null!=s?s:null}})}),u.setKeyHandler("".concat($,"o"),(e,t)=>{var l,i,n;t.preventDefault();let r=u.getCursorPosition(),o=null==ec?void 0:null===(n=ec.current)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.getBoundingClientRect();setTimeout(()=>{eb(e=>{var t,l;return{...e,x:null!==(t=e.x)&&void 0!==t?t:r.x-o.left,y:null!==(l=e.y)&&void 0!==l?l:r.y-o.top,mode:"color"}})})}),u.setKeyHandler("".concat($,"Shift-").concat(o.V5?"h":"H"),(e,t)=>{var l,i,n;t.preventDefault();let r=u.getCursorPosition(),o=null==ec?void 0:null===(n=ec.current)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.getBoundingClientRect();setTimeout(()=>{eb(e=>{var t,l;return{...e,x:null!==(t=e.x)&&void 0!==t?t:r.x-o.left,y:null!==(l=e.y)&&void 0!==l?l:r.y-o.top,mode:"highlight"}})})}),u.setKeyHandler("".concat($,"\\"),(e,t)=>{t.preventDefault(),e.removeAllFormatting()}),u.setKeyHandler("Backspace",(e,t)=>{}),(null==W?void 0:W.selection)&&(null==W?void 0:null===(n=W.selection)||void 0===n?void 0:null===(i=n.anchorNode)||void 0===i?void 0:null===(t=i.firstChild)||void 0===t?void 0:t.tagName)!=="INPUT"){let e;if(null===(r=Array.from(null==ec?void 0:null===(a=ec.current)||void 0===a?void 0:a.childNodes))||void 0===r||r.forEach(t=>{var l,i,n;(null===(n=t.innerText)||void 0===n?void 0:n.includes(null==W?void 0:null===(i=W.selection)||void 0===i?void 0:null===(l=i.anchorNode)||void 0===l?void 0:l.textContent))&&(e=null==t?void 0:t.firstChild)}),e){let t=document.createRange();t.setStart(e,null==W?void 0:null===(d=W.selection)||void 0===d?void 0:d.anchorOffset),null==t||t.collapse(!0),setTimeout(()=>{j&&u.focus(),null==u||u.setSelection(t)},100)}}eh||ef(u)};return!ev.current&&(null==ec?void 0:ec.current)&&e(),()=>{ev.current=!0}},[]),(0,p.useEffect)(()=>{er(eh,W)},[!!eh]),(0,p.useEffect)(()=>{var e;let t=null===(e=document)||void 0===e?void 0:e.getElementById("subject-input"+(w?"-".concat(w):""));t&&(null==t?void 0:t.scrollHeight)>44&&(t.style.height="".concat(null==t?void 0:t.scrollHeight,"px"));let l=document.getElementById("recipient-input-group");l&&(null==ep?void 0:ep.current)&&(ep.current.style.top="".concat((null==l?void 0:l.offsetTop)+((null==l?void 0:l.offsetHeight)-28)/2,"px"))},[y]),(0,p.useEffect)(()=>{var e,t,l;(null===(e=W.recipient)||void 0===e?void 0:e.length)?eD(ei(W.recipient)):eD([]),(null===(t=W.cc)||void 0===t?void 0:t.length)?(Z(!0),eR(ei(W.cc))):(Z(!1),eR([])),(null===(l=W.bcc)||void 0===l?void 0:l.length)?(eo(!0),eF(ei(W.bcc))):(eo(!1),eF([]))},[null==W?void 0:W.type]),(0,p.useEffect)(()=>{if(eh){var e,t;(null==W?void 0:null===(e=W.type)||void 0===e?void 0:e.length)&&(null==W?void 0:W.type)!=="forward"&&(null==eh?void 0:null===(t=eh.getHTML())||void 0===t?void 0:t.includes("Forwarded Message"))?null==eh||eh.setHTML(""):(null==W?void 0:W.type)==="forward"?(ej(!1),setTimeout(()=>{var e,t,l,i;!eh||(null==eh?void 0:null===(e=eh.getHTML())||void 0===e?void 0:e.includes("Forwarded Message"))||(null===(i=eh.getRoot())||void 0===i?void 0:null===(l=i.querySelector(".gmail_attr"))||void 0===l?void 0:null===(t=l.textContent)||void 0===t?void 0:t.includes("Forwarded message"))||null==eh||eh.setHTML(null!=eX?eX:"")},10)):(null==W?void 0:W.type)==="draft"&&setTimeout(()=>{eh&&W.message&&(W.message.trim()!==Y?(null==eh||eh.setHTML(W.message),eM(!1),null==eh||eh.moveCursorToEnd()):eM(!0))},10)}},[null==W?void 0:W.type,!!eh]),(0,p.useEffect)(()=>{var e;(null===(e=W.message)||void 0===e?void 0:e.length)&&W.message.trim()!==Y&&(null==eh||eh.setHTML(W.message),eM(!1),er(eh,W))},[W.message]);let e0=async()=>{eu(!0);let e=null==eh?void 0:eh.getHTML();eT&&eG&&(e+=eG);let t=ea(eA),l=ea(eL),i=ea(eO),n={...(0,z.ZN)(W),recipient:t,cc:l.length>0?l:[],bcc:i.length>0?i:[],message:null!=e?e:""};if(G(n)!==B.xK.SUCCESS){switch(G(n)){case B.xK.RECIPIENT_REQUIRED:D.setAlertModalObj({alertMsg:"Recipient required!",alertDescription:"Please add a recipient before sending.",alertField:"recipient-input",alertCode:B.xK.RECIPIENT_REQUIRED,focusIdOnClose:"recipient-input",onClose:{title:"Add Recipient",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0);break;case B.xK.INVALID_RECIPIENT:D.setAlertModalObj({alertMsg:"Invalid email address!",alertDescription:"Please provide a valid email address",alertField:"recipient-input",alertCode:B.xK.INVALID_RECIPIENT,focusIdOnClose:"recipient-input",onClose:{title:"Edit Recipient",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0);break;case B.xK.INVALID_CC:D.setAlertModalObj({alertMsg:"Invalid email address!",alertDescription:"Please provide a valid email address",alertField:"cc-recipient-input",alertCode:B.xK.INVALID_RECIPIENT,focusIdOnClose:"cc-recipient-input",onClose:{title:"Edit Recipient",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0);break;case B.xK.INVALID_BCC:D.setAlertModalObj({alertMsg:"Invalid email address!",alertDescription:"Please provide a valid email address",alertField:"bcc-recipient-input",alertCode:B.xK.INVALID_RECIPIENT,focusIdOnClose:"bcc-recipient-input",onClose:{title:"Edit Recipient",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0);break;case B.xK.SUBJECT_MISSING:D.setAlertModalObj({alertMsg:"Subject missing?",alertDescription:"Your message doesn’t have a subject. Are you sure you want to send anyway?",alertField:"subject",alertCode:B.xK.SUBJECT_MISSING,focusIdOnClose:"subject-input",onConfirm:{title:"Send Anyway",onClick:async()=>{await m(n).catch(e=>{console.error(e)}).then(()=>{eu(!1)})}},onClose:{title:"Cancel",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0)}return}m(n).catch(e=>{console.error(e),D.setAlertModalObj({alertMsg:"Error sending email",alertDescription:"An error occurred while sending your email. Please try again later.",alertCode:B.xK.EMAIL_SEND_ERROR,focusIdOnClose:"compose-submit".concat(w?"-".concat(w):""),onClose:{title:"Retry",onClick:()=>{eu(!1)}}}),D.setAlertModalOpen(!0)}).finally(()=>{eu(!1)})};return(0,p.useEffect)(()=>{!D.alertModalOpen&&es&&eu(!1)},[D.alertModalOpen]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{id:"recipient-input-group",className:"body relative flex h-auto w-full items-start gap-2 px-5 pr-3",children:[(0,i.jsx)("span",{className:"flex h-11 w-7 shrink-0 items-center font-medium text-primary dark:text-primary-dark",children:"To"}),(0,i.jsxs)("div",{className:"w-full shrink pr-10",children:[(0,i.jsx)("label",{htmlFor:"recipient-input",className:"sr-only"}),(0,i.jsx)(k,{id:"recipient-input"+(w?"-".concat(w):""),name:"recipient-input",selectedContacts:eA,setSelectedContacts:eJ(eD,"recipient"),onBlur:e=>{eP.current=null==e?void 0:e.target},dragState:e_,setDragState:eH})]})]}),(0,i.jsx)("div",{className:v()("body flex h-auto w-full items-center justify-start px-5 duration-150",{"-mb-2 hidden max-h-0 opacity-0":!Q}),children:(0,i.jsxs)("div",{className:"relative flex w-full items-start gap-2",children:[(0,i.jsx)("span",{className:"flex h-11 w-7 shrink-0 items-center font-medium text-primary dark:text-primary-dark",children:"CC"}),(0,i.jsxs)("div",{className:"w-full shrink pr-10",children:[(0,i.jsx)("label",{htmlFor:"cc-recipient-input",className:"sr-only"}),(0,i.jsx)(k,{id:"cc-recipient-input"+(w?"-".concat(w):""),name:"cc-recipient-input",selectedContacts:eL,setSelectedContacts:eJ(eR,"cc"),onBlur:e=>{eP.current=null==e?void 0:e.target},dragState:e_,setDragState:eH})]})]})}),(0,i.jsx)("div",{className:v()("body flex h-auto w-full items-center justify-start px-5 duration-150",{"-mb-2 hidden max-h-0 opacity-0":!ee}),children:(0,i.jsxs)("div",{className:"relative flex w-full items-start gap-2",children:[(0,i.jsx)("span",{className:"flex h-11 w-7 shrink-0 items-center font-medium text-primary dark:text-primary-dark",children:"BCC"}),(0,i.jsxs)("div",{className:"w-full shrink pr-10",children:[(0,i.jsx)("label",{htmlFor:"bcc-recipient-input",className:"sr-only"}),(0,i.jsx)(k,{id:"bcc-recipient-input"+(w?"-".concat(w):""),name:"bcc-recipient-input",selectedContacts:eO,setSelectedContacts:eJ(eF,"bcc"),onBlur:e=>{eP.current=null==e?void 0:e.target},dragState:e_,setDragState:eH})]})]})}),(0,i.jsx)("textarea",{id:"subject-input"+(w?"-".concat(w):""),value:W.subject||"",onChange:e=>{var t,l;q({...W,subject:null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value}),(null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.scrollHeight)>44&&(e.target.style.height="auto",e.target.style.height="".concat(e.target.scrollHeight,"px"))},rows:1,className:v()("z-[2] w-full shrink-0 touch-none resize-none overflow-hidden bg-transparent px-5 py-3 text-body font-medium !leading-5 text-primary outline-none placeholder:text-quartery dark:text-primary-dark dark:placeholder:text-quartery-dark",{"max-md:caret-transparent":L.sidebarOpen}),placeholder:"Subject",onMouseDownCapture:()=>{if((0,a.b)()){let e=document.getElementById("editor"+(w?"-".concat(w):""));e&&(e.style.fontSize="16px",setTimeout(()=>{e.style.fontSize="13px"}))}},onFocusCapture:()=>{let e=document.getElementById("editor"+(w?"-".concat(w):""));e&&(e.style.fontSize="13px")},onFocus:e=>{T&&(eK.current=e.target.value)},onBlur:e=>{var t,l,i;!T||(null===(t=eV.current)||void 0===t?void 0:t.contains(e.relatedTarget))||eK.current===(null==e?void 0:null===(l=e.currentTarget)||void 0===l?void 0:l.value)||T(W,null!==(i=null==eh?void 0:eh.getHTML())&&void 0!==i?i:""),eP.current=null==e?void 0:e.target},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),null==eh||eh.focus())}}),(0,i.jsx)("div",{className:v()("relative",{"before:pointer-events-none before:absolute before:left-5 before:top-3.5 before:text-body before:text-quartery before:content-['Write_something_here...'] dark:before:text-quartery-dark":eE}),children:(0,i.jsx)("div",{className:v()("editor min-h-[44px] w-full touch-none overflow-auto bg-transparent px-5 py-3 text-body text-primary outline-none dark:text-primary-dark",(0,S.u)(),{"max-h-[50vh]":!eW&&!eq},{"max-md:caret-transparent":L.sidebarOpen}),id:"editor"+(w?"-".concat(w):""),style:{colorScheme:"light !important",lineHeight:"20px"},onMouseDownCapture:()=>{if((0,a.b)()){let e=document.getElementById("editor"+(w?"-".concat(w):""));e&&(e.style.fontSize="16px",setTimeout(()=>{e.style.fontSize="13px"}))}},onFocusCapture:()=>{let e=document.getElementById("editor"+(w?"-".concat(w):""));e&&(e.style.fontSize="13px")},onFocus:()=>{if(T){var e;eK.current=null!==(e=null==eh?void 0:eh.getHTML())&&void 0!==e?e:""}},onBlur:e=>{var t,l;!T||(null===(t=eV.current)||void 0===t?void 0:t.contains(e.relatedTarget))||eK.current===(null==eh?void 0:eh.getHTML())||T(W,null!==(l=null==eh?void 0:eh.getHTML())&&void 0!==l?l:""),eP.current=e.target},onContextMenu:e=>{if(null==eh?void 0:eh.hasFormat("a")){var t,l,i,n,r,o,a,d;let s=null!==(r=null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.href)&&void 0!==r?r:null===(n=eh.getSelection())||void 0===n?void 0:null===(i=n.startContainer)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.href;if(e.preventDefault(),s){let e=eh.getCursorPosition(),t=null==ec?void 0:null===(d=ec.current)||void 0===d?void 0:null===(a=d.parentElement)||void 0===a?void 0:null===(o=a.parentElement)||void 0===o?void 0:o.getBoundingClientRect();eN({x:e.x-t.left,y:e.y-t.top,link:s})}}},...e$,ref:ec,onKeyDown:e=>{var t,l,i,n,r,o,a,d,s,u,c,v,m,p,h,f,g,b,y,x,k,w,C,S,I,N,T,j,E,M,A;if(eh){if("Escape"===e.key&&setTimeout(()=>{eb(e=>{if(e.x&&e.mode)return{...e,mode:""};if(null==e?void 0:e.selection){var t,l,i,n,r;let o=null===(t=document)||void 0===t?void 0:t.createRange();o.setStart(null==e?void 0:null===(l=e.selection)||void 0===l?void 0:l.endContainer,null===(i=e.selection)||void 0===i?void 0:i.endOffset),o.setEnd(null==e?void 0:null===(n=e.selection)||void 0===n?void 0:n.endContainer,null===(r=e.selection)||void 0===r?void 0:r.endOffset),null==eh||eh.setSelection(o)}return{}}),ew(null),eS(null)}),"Enter"===e.key)setTimeout(()=>{var e,t,l;let i=null==eh?void 0:eh.getSelection();(null==i?void 0:null===(e=i.endContainer)||void 0===e?void 0:e.previousSibling)&&!(null==i?void 0:null===(t=i.endContainer)||void 0===t?void 0:t.nextSibling)&&(null==i||null===(l=i.endContainer)||void 0===l||l.scrollIntoView())},10);else if(" "===e.key){let t=!1;if(null==eh||eh.forEachBlock(l=>{var i,n,r,o,a,d,s,u,c,v,m;(null==l?void 0:null===(i=l.textContent)||void 0===i?void 0:i.slice(-2))==="--"&&l.textContent&&(l.textContent=l.textContent.substring(0,(null===(a=l.textContent)||void 0===a?void 0:a.length)-2)+"—",t=!0);let p=null==l?void 0:null===(n=l.textContent)||void 0===n?void 0:n.replace(/[\u200B-\u200D\uFEFF]/g,"");if("#"===p?(e.preventDefault(),eh.hasFormat("H1")?l.textContent=(null==p?void 0:p.slice(0,-1))+String.fromCharCode(8203):eQ("H1",eh,!0)):"##"===p?(e.preventDefault(),eh.hasFormat("H2")?l.textContent=(null==p?void 0:p.slice(0,-2))+String.fromCharCode(8203):eQ("H2",eh,!0)):"###"===p?(e.preventDefault(),eh.hasFormat("H3")?l.textContent=(null==p?void 0:p.slice(0,-3))+String.fromCharCode(8203):eQ("H3",eh,!0)):"####"===p&&(e.preventDefault(),eh.hasFormat("DIV")?l.textContent=(null==p?void 0:p.slice(0,-4))+String.fromCharCode(8203):eQ("H4",eh,!0)),null==l?void 0:null===(r=l.textContent)||void 0===r?void 0:r.startsWith("*")){let t=eh.getSelection();((null==t?void 0:null===(d=t.startContainer)||void 0===d?void 0:d.nodeName)==="#text"&&(null==t?void 0:t.startOffset)===1||(null===(s=l.textContent)||void 0===s?void 0:s.length)===1)&&(e.preventDefault(),l.textContent=l.textContent.slice(1),eh.makeUnorderedList())}if(null==l?void 0:null===(o=l.textContent)||void 0===o?void 0:o.match(/[0-9]+\..*$/)){let t=eh.getSelection();if((null==t?void 0:null===(u=t.startContainer)||void 0===u?void 0:u.nodeName)==="#text"&&(null==t?void 0:t.startOffset)<10||(null===(c=l.textContent)||void 0===c?void 0:c.length)<10){e.preventDefault();let t=null===(v=l.textContent.split("."))||void 0===v?void 0:v.at(0);l.textContent=l.textContent.slice(1+(null!==(m=null==t?void 0:t.length)&&void 0!==m?m:1)),eh.makeOrderedList(),"1"!==t&&setTimeout(()=>{var e;let l=(null===(e=eh.getSelection())||void 0===e?void 0:e.startContainer).closest("ol");l&&(l.start=Number(null!=t?t:1))})}}(null==l?void 0:l.textContent)===">"&&(e.preventDefault(),null==eh||eh.decreaseQuoteLevel(),null==eh||eh.increaseQuoteLevel(),l.textContent=String.fromCharCode(8203))},!1),t){let e=eh.getSelection();e.setEndAfter(e.startContainer),e.collapse(!1),eh.setSelection(e)}ek&&ew({...ek,active:!1}),eC&&setTimeout(()=>{var e,t,l,i;let n=eh.getSelection(),r=null==n?void 0:null===(e=n.startContainer)||void 0===e?void 0:e.textContent,o=null!==(i=null==r?void 0:null===(l=r.slice(0,null==n?void 0:n.startOffset))||void 0===l?void 0:null===(t=l.split("/"))||void 0===t?void 0:t.pop())&&void 0!==i?i:"";(!(null==o?void 0:o.trim())||o.includes(" ")||!["heading","attach","normal","bulleted","numbered"].find(e=>null==e?void 0:e.toLowerCase().includes(o.trim())))&&eS(null)},10)}else if("*"===e.key){let e,t=!1,l=!1;setTimeout(()=>{if(null==eh||eh.forEachBlock(i=>{var n,r,o,a,d,s,u,c,v,m,p,h,f,g,b;let y=null==i?void 0:null===(n=i.textContent)||void 0===n?void 0:n.match(/\*\*(.+?)\*\*/g),x=(null==i?void 0:null===(r=i.textContent)||void 0===r?void 0:r.match(/\*(.+?)\*/g))&&!(null==i?void 0:null===(o=i.textContent)||void 0===o?void 0:o.match(/\*\*(.+?)/g));if(y)i.innerHTML="".concat(null==i?void 0:null===(d=i.innerHTML)||void 0===d?void 0:null===(a=d.split("**"))||void 0===a?void 0:a[0],"<b>").concat(null==y?void 0:null===(s=y[0])||void 0===s?void 0:s.replaceAll("**",""),"</b>").concat(null==i?void 0:null===(c=i.innerHTML)||void 0===c?void 0:null===(u=c.split("**"))||void 0===u?void 0:u.pop()),t=!0,e=null==y?void 0:null===(v=y[0])||void 0===v?void 0:v.replaceAll("**","");else if(x){let t=null==i?void 0:null===(p=i.textContent)||void 0===p?void 0:null===(m=p.match(/\*(.+?)\*/g))||void 0===m?void 0:m[0];i.innerHTML="".concat(null==i?void 0:null===(f=i.innerHTML)||void 0===f?void 0:null===(h=f.split("*"))||void 0===h?void 0:h[0],"<i>").concat(null==t?void 0:t.replaceAll("*",""),"</i>").concat(null==i?void 0:null===(b=i.innerHTML)||void 0===b?void 0:null===(g=b.split("*"))||void 0===g?void 0:g.pop()),l=!0,e=null==t?void 0:t.replaceAll("*","")}},!1),t||l){var i;let l=eh.getSelection(),n=Array.from(null===(i=l.startContainer)||void 0===i?void 0:i.childNodes).find(l=>l.nodeName===(t?"B":"I")&&l.textContent===e);n&&l.setEndAfter(n),l.collapse(!1),eh.setSelection(l),t?eh.removeBold():eh.removeItalic()}},10)}else if("_"===e.key){let e;if(ek)return;let t=!1,l=!1;setTimeout(()=>{if(null==eh||eh.forEachBlock(i=>{var n,r,o,a,d,s,u,c,v,m,p,h,f,g,b;let y=null==i?void 0:null===(n=i.textContent)||void 0===n?void 0:n.match(/__(.+?)__/g),x=(null==i?void 0:null===(r=i.textContent)||void 0===r?void 0:r.match(/_(.+?)_/g))&&!(null==i?void 0:null===(o=i.textContent)||void 0===o?void 0:o.match(/__(.+?)/g));if(y)i.innerHTML="".concat(null==i?void 0:null===(d=i.innerHTML)||void 0===d?void 0:null===(a=d.split("__"))||void 0===a?void 0:a[0],"<b>").concat(null==y?void 0:null===(s=y[0])||void 0===s?void 0:s.replaceAll("_",""),"</b>").concat(null==i?void 0:null===(c=i.innerHTML)||void 0===c?void 0:null===(u=c.split("__"))||void 0===u?void 0:u.pop()),t=!0,e=null==y?void 0:null===(v=y[0])||void 0===v?void 0:v.replaceAll("__","");else if(x){let t=null==i?void 0:null===(p=i.textContent)||void 0===p?void 0:null===(m=p.match(/_(.+?)_/g))||void 0===m?void 0:m[0];i.innerHTML="".concat(null==i?void 0:null===(f=i.innerHTML)||void 0===f?void 0:null===(h=f.split("_"))||void 0===h?void 0:h[0],"<i>").concat(null==t?void 0:t.replaceAll("_",""),"</i>").concat(null==i?void 0:null===(b=i.innerHTML)||void 0===b?void 0:null===(g=b.split("_"))||void 0===g?void 0:g.pop()),l=!0,e=null==t?void 0:t.replaceAll("_","")}},!1),t||l){var i;let l=eh.getSelection(),n=Array.from(null===(i=l.startContainer)||void 0===i?void 0:i.childNodes).find(l=>l.nodeName===(t?"B":"I")&&l.textContent===e);n&&l.setEndAfter(n),l.collapse(!1),eh.setSelection(l),t?eh.removeBold():eh.removeItalic()}},10)}else if("~"===e.key){let e,t=!1;setTimeout(()=>{if(null==eh||eh.forEachBlock(l=>{var i,n,r,o,a,d,s,u,c;let v=null==l?void 0:null===(i=l.textContent)||void 0===i?void 0:i.match(/~~(.+?)~~/g),m=(null==l?void 0:null===(n=l.textContent)||void 0===n?void 0:n.match(/~(.+?)~/g))&&!(null==l?void 0:null===(r=l.textContent)||void 0===r?void 0:r.match(/~~(.+?)~/g));if(v||m){let i=v?v[0]:null==l?void 0:null===(a=l.textContent)||void 0===a?void 0:null===(o=a.match(/~(.+?)~/g))||void 0===o?void 0:o[0];l.innerHTML="".concat(null==l?void 0:null===(s=l.innerHTML)||void 0===s?void 0:null===(d=s.split(v?"~~":"~"))||void 0===d?void 0:d[0],"<s>").concat(null==i?void 0:i.replaceAll("~",""),"</s>").concat(null==l?void 0:null===(c=l.innerHTML)||void 0===c?void 0:null===(u=c.split(v?"~~":"~"))||void 0===u?void 0:u.pop()),t=!0,e=null==i?void 0:i.replaceAll("~","")}},!1),t){var l;let t=eh.getSelection(),i=Array.from(null===(l=t.startContainer)||void 0===l?void 0:l.childNodes).find(t=>"S"===t.nodeName&&t.textContent===e);i&&t.setEndAfter(i),t.collapse(!1),eh.setSelection(t),eh.removeStrikethrough()}},10)}else if(":"===e.key){let e=null==eh?void 0:eh.getSelection(),r=null==e?void 0:null===(t=e.startContainer)||void 0===t?void 0:t.textContent,o=null==e?void 0:e.startOffset,a=o>0&&(null==r?void 0:r[o-1]);if(!a||(null==a?void 0:a.trim())===""){let e=eh.getCursorPosition(),t=null==ec?void 0:null===(n=ec.current)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.getBoundingClientRect();ew({x:e.x-t.left,y:e.y-t.top,active:!1})}}else if("Backspace"!==e.key||ek||eC){if(ek){if((null===(m=e.key)||void 0===m?void 0:m.length)!==1&&"Backspace"!==e.key)return;let t=eh.getSelection(),l=null==t?void 0:null===(p=t.startContainer)||void 0===p?void 0:p.textContent,i=null!==(g=null==l?void 0:null===(f=l.slice(0,null==t?void 0:t.startOffset))||void 0===f?void 0:null===(h=f.split(":"))||void 0===h?void 0:h.pop())&&void 0!==g?g:"";if((null==l?void 0:l.includes(":"))&&" "!==l.slice(-1)&&!e.metaKey&&!e.ctrlKey&&!("Backspace"===e.key&&(null==l?void 0:l.slice(-1))===":")&&0>i.search(/\s/)){let t=(null==l?void 0:null===(x=l.split(":"))||void 0===x?void 0:null===(y=x.pop())||void 0===y?void 0:null===(b=y.split(" "))||void 0===b?void 0:b[0])+((null===(k=e.key)||void 0===k?void 0:k.length)===1?e.key:"");ew({...ek,active:!0,search:"Backspace"===e.key?t.slice(0,-1):t})}else(null==ek?void 0:ek.active)&&"Backspace"===e.key&&(null==l?void 0:l.slice(-1))===":"?ew(null):(null==l?void 0:l.slice(-1))!==":"&&ew(null)}else if("/"===e.key){if(e.metaKey||e.ctrlKey)return;let t=null==eh?void 0:eh.getSelection(),l=null==t?void 0:null===(w=t.startContainer)||void 0===w?void 0:w.textContent,i=null==t?void 0:t.startOffset,n=i>0&&(null==l?void 0:l[i-1]);if(!n||(null==n?void 0:n.trim())===""){let e=eh.getCursorPosition(),t=null==ec?void 0:null===(I=ec.current)||void 0===I?void 0:null===(S=I.parentElement)||void 0===S?void 0:null===(C=S.parentElement)||void 0===C?void 0:C.getBoundingClientRect();eS({x:e.x-t.left,y:e.y-t.top,active:!0}),eb({})}}else if(eC){if((null===(N=e.key)||void 0===N?void 0:N.length)!==1&&"Backspace"!==e.key)return;let t=eh.getSelection(),l=null==t?void 0:null===(T=t.startContainer)||void 0===T?void 0:T.textContent,i=null!==(M=null==l?void 0:null===(E=l.slice(0,null==t?void 0:t.startOffset))||void 0===E?void 0:null===(j=E.split("/"))||void 0===j?void 0:j.pop())&&void 0!==M?M:"";if((null==l?void 0:l.includes("/"))&&!e.metaKey&&!e.ctrlKey&&!("Backspace"===e.key&&(null==l?void 0:l.slice(-1))==="/")&&(i.trim()||(null==l?void 0:l.slice(-1))==="/")){let t=i+((null===(A=e.key)||void 0===A?void 0:A.length)===1?e.key:"");eS({...eC,active:!0,search:"Backspace"===e.key?t.slice(0,-1):t})}else(null==eC?void 0:eC.active)&&"Backspace"===e.key&&(null==l?void 0:l.slice(-1))==="/"?eS(null):(null==l?void 0:l.slice(-1))!=="/"&&ew(null)}}else{let e=eh.getSelection(),t=null==e?void 0:null===(r=e.startContainer)||void 0===r?void 0:r.textContent;if((null==t?void 0:t.includes(":"))&&(null==t?void 0:t.charAt(e.startOffset-2))===":"){let e=eh.getCursorPosition(),t=null==ec?void 0:null===(s=ec.current)||void 0===s?void 0:null===(d=s.parentElement)||void 0===d?void 0:null===(a=d.parentElement)||void 0===a?void 0:a.getBoundingClientRect();ew({x:e.x-t.left,y:e.y-t.top,active:!1})}else if((null==t?void 0:t.includes("/"))&&(null==t?void 0:t.charAt(e.startOffset-2))==="/"){let e=eh.getCursorPosition(),t=null==ec?void 0:null===(v=ec.current)||void 0===v?void 0:null===(c=v.parentElement)||void 0===c?void 0:null===(u=c.parentElement)||void 0===u?void 0:u.getBoundingClientRect();eS({x:e.x-t.left,y:e.y-t.top,active:!1})}if((null===(o=e.endContainer.lastChild)||void 0===o?void 0:o.nodeName)==="IMG"){let t=document.createRange();t.setStartBefore(e.startContainer),t.setEndAfter(e.endContainer),eh.setSelection(t)}}eI&&eN(null)}}})}),(0,i.jsxs)("div",{className:"relative flex w-full grow flex-col",children:[(0,i.jsx)("div",{className:"absolute inset-0",...e$}),eT&&(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsx)(O.z,{tabIndex:-1,id:"expand-nested-html-button",className:"peer ml-5 -translate-x-1 hover:translate-x-0",icon:g.N.ThreeDot,variant:"tertiary",size:"sm",onClick:()=>{let e=null==eh?void 0:eh.getSelection(),t=null==e?void 0:e.startContainer,l=null==e?void 0:e.startOffset;ej(!1),null==eh||eh.moveCursorToEnd(),null==eh||eh.insertHTML(null!=eG?eG:'<br/><br/>Sent from <a href="https://tatem.com" target="_blank" rel="noopener noreferrer">Tatem Mail</a>'),eP&&setTimeout(()=>{var i,n;null===(i=eP.current)||void 0===i||i.focus(),(null==eP?void 0:null===(n=eP.current)||void 0===n?void 0:n.id)==="editor"&&e&&setTimeout(()=>{if((null==t?void 0:t.innerText)||0!==l){let e=document.createRange();e.setStart(t,l),e.collapse(!0),null==eh||eh.setSelection(e)}else null==eh||eh.moveCursorToStart()},10)},10)}}),(0,i.jsx)(h.M,{...n.Wz.ShowMessageHistory,position:"-top-10 left-0",opaque:!0})]}),(0,i.jsxs)("div",{className:"mt-auto",children:[(null==W?void 0:null===(u=W.attachments)||void 0===u?void 0:u.length)>0&&(0,i.jsx)("div",{className:"ml-5 mr-1 grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-3 pb-1 pr-4",ref:em,children:null==W?void 0:null===(c=W.attachments)||void 0===c?void 0:c.map((e,t)=>{let l=(0,H.KN)(e);return(0,i.jsx)(r.Y,{attachment:l,isUploading:eB,idx:t,removeAttachment:eY},t)})}),(0,i.jsxs)("div",{className:"flex w-full items-center justify-between px-5 py-2 pr-5 text-body md:px-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-start",children:[(0,i.jsxs)("label",{className:"relative",children:[(0,i.jsx)(O.z,{id:"attachment-button"+(w?"-".concat(w):""),icon:g.N.AttachmentTilt,variant:"tertiary",className:"peer",onClick:()=>{var e;null===(e=document.getElementById("attachment-input"+(w?"-".concat(w):"")))||void 0===e||e.click()}}),(0,i.jsx)("input",{id:"attachment-input"+(w?"-".concat(w):""),className:"hidden",type:"file",multiple:!0,onChange:async e=>{eZ(e.target.files),en(!!(null==eA?void 0:eA.length),w),e.target.value=""}},"attachment-input"+(w?"-".concat(w):"")),(0,i.jsx)(h.M,{...n.Wz.AttachFile,position:"bottom-10 left-0"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Snippet,variant:"tertiary",onClick:()=>{},className:"peer"}),(0,i.jsx)(h.M,{...n.Wz.UseSnippet,position:"bottom-10 left-1/2 -translate-x-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{icon:g.N.Clock,variant:"tertiary",onClick:()=>{},className:"peer"}),(0,i.jsx)(h.M,{...n.Wz.RemindMe,position:"bottom-10 left-1/2 -translate-x-20"})]})]}),(0,i.jsxs)("div",{className:"ml-auto flex items-center gap-2",ref:eV,children:[f&&(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{className:"peer",variant:"tertiary",label:null!=C?C:"Cancel",onClick:()=>{f(),null==eh||eh.setHTML("")}}),(0,i.jsx)(h.M,{title:"".concat(null!=C?C:"Cancel"," Draft"),position:"bottom-10 left-1/2 -translate-x-12",opaque:!0})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.z,{label:"Send",submit:!0,onClick:async()=>{await e0()},disabled:es||!y||D.alertModalOpen,variant:"secondary",id:"compose-submit"+(w?"-".concat(w):""),className:"peer"}),(0,i.jsx)(h.M,{...n.Wz.SendMessage,position:"bottom-10 right-0",opaque:!0})]})]})]})]})]}),(0,i.jsx)(K,{...eg,editor:eh,editorRef:ec,setRichTextMenu:eb,selectedStyles:ey,setSelectedStyles:ex}),(0,i.jsx)(E,{...ek,editor:eh,editorRef:ec,setEmojiMenu:ew}),(0,i.jsx)(R,{...eC,editor:eh,editorRef:ec,setSlashMenu:eS,setEmojiMenu:ew}),(0,i.jsx)(A,{...eI,editor:eh,editorRef:ec,setLinkMenu:eN}),(0,i.jsxs)("div",{className:"absolute right-5"+(eq?" md:right-8":""),ref:ep,children:[(0,i.jsx)(O.z,{id:"show-cc-button"+(w?"-".concat(w):""),icon:Q?g.N.PageUp:g.N.PageDown,variant:"tertiary",size:"md",className:"peer shrink-0",onClick:()=>{if(eo(!ee),Q){var e,t;null===(t=document)||void 0===t||null===(e=t.getElementById("recipient-input"+(w?"-".concat(w):"")))||void 0===e||e.focus(),Z(!1)}else Z(!0),setTimeout(()=>{var e,t;null===(t=document)||void 0===t||null===(e=t.getElementById("cc-recipient-input"+(w?"-".concat(w):"")))||void 0===e||e.focus()})}}),(0,i.jsx)(h.M,{...Q?n.Wz.HideCC:n.Wz.ShowCC,position:"top-9 right-0"})]})]})})},31248:function(e,t,l){"use strict";l.d(t,{nx:function(){return S},ox:function(){return C}});var i=l(44003),n=l(93629),r=l(3984),o=l(63372),a=l(39359),d=l(50026),s=l(95470),u=l(74848),c=l(61808),v=l.n(c),m=l(1394),p=l(87767),h=l(62516),f=l(17115),g=l(29970),b=l(32930),y=l(27799),x=l(70137),k=l(60136),w=l(25441);let C={recipient:[],cc:[],bcc:[],subject:"",message:"",forwardedMessage:"",attachments:[],type:""},S=(0,m.Pi)(e=>{var t;let{isSelected:l,buttonProps:c,isHoverActive:m}=e,{uiStore:{preferences:C},toastStore:{addToast:S},keyboardStore:I,syncStore:N,sidebarStore:T,composeStore:j,inboxStore:E,labelStore:M,idbStore:A,gapiStore:D,transactionStore:L,supabaseStore:R}=(0,r.m)(),O=(0,k.H)(),[F,B]=(0,h.useState)(null),z=(0,p.useRouter)(),_=(0,h.useRef)(null),[H,P]=(0,h.useState)(!1),U=(0,p.usePathname)(),{mutate:W}=(0,g.r0)(M.currentLabel,N.isOfflineMode,N.syncStatus,N.setSyncStatus,A.db,D.gapiInitialized),q=async e=>{var t,l,i;let r={raw:(0,y.eK)({...e,sender:"".concat(null===(l=R.userData)||void 0===l?void 0:null===(t=l.user_metadata)||void 0===t?void 0:t.name," <").concat(null===(i=R.userData)||void 0===i?void 0:i.email,">"),addTatemWatermark:!!document.getElementById("expand-nested-html-button")}).asEncoded()};L.enqueue({transaction:{type:s.e.SendMail,parameters:{resource:r},actionTitle:n.t.constants.MessageSent.title}}),E.setComposeOpen(!1),S(n.t.constants.MessageSent),j.resetEmailData()},K=async()=>{var e,t,l,i,r,o,a,d,u;let c=null!==(u=null===(e=document.getElementById("editor"))||void 0===e?void 0:e.innerHTML)&&void 0!==u?u:"",v=!c.replace(/<[^>]*>/g,"").length&&!j.emailData.subject.length,m=(null===(l=j.emailData)||void 0===l?void 0:null===(t=l.recipient)||void 0===t?void 0:t.length)>0,p=(null===(r=j.emailData)||void 0===r?void 0:null===(i=r.attachments)||void 0===i?void 0:i.length)>0;if(v&&!m&&!p)return;let h="alias-"+window.crypto.randomUUID(),f={message:{raw:(0,y.eK)({...j.emailData,message:c,headers:{alias:h},sender:"".concat(null===(a=R.userData)||void 0===a?void 0:null===(o=a.user_metadata)||void 0===o?void 0:o.name," <").concat(null===(d=R.userData)||void 0===d?void 0:d.email,">")}).asEncoded()}};E.setComposeOpen(!1),L.enqueue({transaction:{type:s.e.CreateDraft,alias:h,parameters:{resource:f},actionTitle:"Draft Saved"}}),S(n.t.constants.DraftSaved)},V=e=>{if("Escape"===e.key){var t,l,i,n,r;let o=null===(t=document)||void 0===t?void 0:t.getElementById("editor"),a=null===(l=document)||void 0===l?void 0:l.getElementById("recipient-input");if(!0===_.current&&!(null==o?void 0:o.textContent)&&!(null==a?void 0:a.value)){E.setComposeOpen(!1);return}"INPUT"===e.target.tagName||(null===(i=e.target)||void 0===i?void 0:i.tagName)==="TEXTAREA"||(null===(r=e.target)||void 0===r?void 0:null===(n=r.className)||void 0===n?void 0:n.includes("editor"))?(e.preventDefault(),e.target.blur(),P(!0)):(E.setComposeOpen(!1),j.resetEmailData())}};return(0,h.useEffect)(()=>{if(visualViewport){let e=e=>{var t,l;B({y:null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.height,x:null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.width})};return visualViewport.addEventListener("resize",e),B({y:visualViewport.height,x:visualViewport.width}),()=>{var t;null===(t=visualViewport)||void 0===t||t.removeEventListener("resize",e)}}},[]),(0,h.useEffect)(()=>{if(E.composeOpen)return window.addEventListener("keydown",V),()=>{window.removeEventListener("keydown",V)}},[E.composeOpen]),(0,h.useEffect)(()=>{var e,t,l,i,n,r,o;(null===(t=j.emailData)||void 0===t?void 0:null===(e=t.recipient)||void 0===e?void 0:e.length)||(null===(l=j.emailData)||void 0===l?void 0:l.subject)||(null===(n=j.emailData)||void 0===n?void 0:null===(i=n.cc)||void 0===i?void 0:i.length)||(null===(o=j.emailData)||void 0===o?void 0:null===(r=o.bcc)||void 0===r?void 0:r.length)?_.current=!1:_.current=!0},[j.emailData]),(0,i.jsxs)(u.fC,{open:E.composeOpen,onOpenChange:E.setComposeOpen,modal:!1,children:[(0,i.jsx)(u.xz,{className:"peer w-full outline-offset-0",asChild:!0,children:(0,i.jsx)(a.z,{className:v()("peer w-full !justify-start text-left !duration-0",{"!shadow-control dark:!shadow-control-dark":m}),fill:!0,id:"compose-button",label:"Compose",tabIndex:-1,variant:"secondary",ref:e=>{var t,i;E.composeOpen&&(null===(i=window)||void 0===i?void 0:null===(t=i.location)||void 0===t?void 0:t.pathname.includes("/compose"))||(0,f.W_)(e,l&&!!e&&!E.composeOpen)},...c,onClick:e=>{var t,l,i,n;if((null===(t=window)||void 0===t?void 0:t.innerWidth)<1024&&setTimeout(()=>{T.setLeftSidebarOpen(!1)},50),null===(i=window)||void 0===i?void 0:null===(l=i.location)||void 0===l?void 0:l.pathname.includes("/compose")){e.preventDefault();return}!E.composeOpen&&((null==C?void 0:C.composePageDefault)||!C)&&(e.preventDefault(),z.push(O+"/compose"),null===(n=document.getElementById("recipient-input"))||void 0===n||n.focus()),I.setCurrentIndex([])}})}),(0,i.jsx)(u.h_,{container:null===(t=document)||void 0===t?void 0:t.getElementById("main-page"),children:!U.includes("compose")&&(0,i.jsxs)(u.VY,{className:v()("fixed bottom-5 z-50 rounded-lg shadow-layer-sm focus-within:shadow-layer-md focus-within:dark:shadow-control-dark",{"right-[328px]":T.rightSidebarOpen},{"right-7":!T.rightSidebarOpen},{"[&:not(:focus-within)]:shadow-[0px_0px_0px_1px_#0C4BE9] [&:not(:focus-within)]:ring-4":H}),onCloseAutoFocus:e=>{e.preventDefault()},onEscapeKeyDown:e=>{e.preventDefault();let t=document.getElementById("rich-text-menu-link-input"),l=!!document.querySelector(".rte-modal");if(t||l){e.stopPropagation();return}H&&K().then(()=>{W(),j.resetEmailData()})},onFocusCapture:()=>{P(!1)},onInteractOutside:e=>{e.preventDefault()},onKeyDown:e=>{var t,l,i,n,r,o,a;switch((null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key){case"Enter":if((0,f.SE)(e)&&!e.shiftKey){e.preventDefault();let t=document.getElementById("compose-submit");t&&t.click()}break;case"a":(0,f.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(i=document)||void 0===i||null===(l=i.getElementById("attachment-button"))||void 0===l||l.click());break;case"f":e.ctrlKey&&e.shiftKey&&(e.preventDefault(),null===(r=document)||void 0===r||null===(n=r.getElementById("expand-compose-button"))||void 0===n||n.click());break;case"b":(0,f.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(a=document)||void 0===a||null===(o=a.getElementById("show-cc-button"))||void 0===o||o.click())}},children:[(0,i.jsx)("div",{className:v()((0,b.u)(),"body flex w-[520px] max-w-[calc(100vw-24px)] flex-col gap-2 overflow-y-auto overflow-x-visible rounded-lg py-3 before:absolute before:inset-0 before:-z-10 before:rounded-lg before:bg-white before:backdrop-blur-modal before:dark:bg-fill-dark-base"),style:{maxHeight:F?(null==F?void 0:F.y)-((null==F?void 0:F.x)>768?200:24):400,minHeight:492},children:(0,i.jsx)(w.NL,{emailData:j.emailData,setEmailData:j.updateEmailData,sendMail:q,open:E.composeOpen,initialEmailData:j.emailData,exitFn:()=>{S(n.t.constants.DraftDeleted),E.setComposeOpen(!1),j.resetEmailData()},exitText:"Discard"})}),(0,i.jsxs)("div",{className:"peer absolute -top-11 right-0 flex flex-row-reverse items-center justify-center gap-1 p-1 before:absolute before:inset-0 before:rounded-lg before:bg-white before:shadow-layer-sm before:backdrop-blur-modal before:dark:bg-fill-dark-base before:dark:shadow-control-dark",children:[(0,i.jsx)(u.x8,{tabIndex:-1,onClick:()=>{K().then(()=>{W(),j.resetEmailData()})},children:(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(a.z,{icon:d.N.Close,variant:"tertiary",size:"md",className:"peer"}),(0,i.jsx)(o.M,{...x.Wz.Close,position:"top-10 -right-2"})]})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(a.z,{id:"expand-compose-button",icon:d.N.ExpandDiagonal,size:"md",variant:"tertiary",className:"peer",href:O+"/compose",onClick:()=>{var e,t,l,i,n;let r=document.getSelection(),o=null===(e=document)||void 0===e?void 0:e.getElementById("editor"),a=null===(t=document)||void 0===t?void 0:t.getElementById("recipient-input");j.updateEmailData({...j.emailData,message:(null==o?void 0:o.textContent)?null==o?void 0:o.innerHTML:"",recipient:null!==(n=null===(l=j.emailData)||void 0===l?void 0:l.recipient)&&void 0!==n?n:a,selection:{anchorNode:null==r?void 0:r.anchorNode,anchorOffset:null==r?void 0:r.anchorOffset}});let d=null===(i=document.getElementsByClassName("fixed-list")[0])||void 0===i?void 0:i.scrollTop;d&&setTimeout(()=>{localStorage.setItem("scrollPos",String(null!=d?d:0))},500)}}),(0,i.jsx)(o.M,{...x.Wz.ExpandCompose,position:"top-10 -right-10"})]})]})]})})]})})},17115:function(e,t,l){"use strict";l.d(t,{KeyboardNavWrapper:function(){return k},Oh:function(){return h},SE:function(){return b},V5:function(){return x},W_:function(){return g},xN:function(){return y}});var i,n,r,o=l(44003),a=l(93629),d=l(3984),s=l(1394),u=l(87767),c=l(62516),v=l(80672),m=l(70137),p=l(60136);let h=["INPUT","TEXTAREA"],f=(e,t)=>{if(e.includes("/search")||e.includes("/labels/"))return!0;if(e.includes("/mail/")&&(!t||t&&"/labels"!==e.slice(-7))){var l;let t=e.split("/").at(-1);return m.je.find(e=>{var l;return(null===(l=e.name)||void 0===l?void 0:l.toLowerCase())===t})||(null===(l=e.split("/"))||void 0===l?void 0:l.at(-2))==="inbox"}return!1},g=(e,t,l)=>{var i,n,r,o,a,d,s,u,c,v;if(t){if((null===(o=document)||void 0===o?void 0:null===(r=o.activeElement)||void 0===r?void 0:null===(n=r.role)||void 0===n?void 0:n.includes("menu"))||h.includes(null!==(v=null===(d=document)||void 0===d?void 0:null===(a=d.activeElement)||void 0===a?void 0:a.tagName)&&void 0!==v?v:"")||(null===(c=document)||void 0===c?void 0:null===(u=c.activeElement)||void 0===u?void 0:null===(s=u.className)||void 0===s?void 0:s.includes("editor")))return;null==e||e.focus(null!=l?l:void 0)}else(null===(i=document)||void 0===i?void 0:i.activeElement)===e&&(null==e||e.blur())},b=e=>{var t,l,i,n,r,o;return e.metaKey&&(null===(i=window)||void 0===i?void 0:null===(l=i.navigator)||void 0===l?void 0:null===(t=l.platform)||void 0===t?void 0:t.indexOf("Mac"))===0||e.ctrlKey&&!(null===(o=window)||void 0===o?void 0:null===(r=o.navigator)||void 0===r?void 0:null===(n=r.platform)||void 0===n?void 0:n.includes("Mac"))},y=e=>e.metaKey||e.ctrlKey||e.altKey,x=(null===(r=window)||void 0===r?void 0:null===(n=r.navigator)||void 0===n?void 0:null===(i=n.platform)||void 0===i?void 0:i.indexOf("Mac"))===0,k=(0,s.Pi)(e=>{let{children:t}=e,[l,i]=(0,c.useState)(null),[,n]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),g=(0,c.useRef)(null),{uiStore:{theme:k,setTheme:w},toastStore:{addToast:C},sidebarStore:S,keyboardStore:I,labelStore:N,idbStore:T,searchStore:j,inboxStore:E,modalsStore:M}=(0,d.m)(),A=(0,u.useRouter)(),D=(0,u.usePathname)(),L=(0,c.useRef)(k),R=["system","light","dark"],O=(0,p.H)(),F=e=>{var t,l,i,n,r;return h.includes(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.tagName)||(null===(l=e.target.className)||void 0===l?void 0:l.includes("editor"))||E.composeOpen||(null===(r=window)||void 0===r?void 0:null===(n=r.location)||void 0===n?void 0:null===(i=n.pathname)||void 0===i?void 0:i.includes("/compose"))},B=(0,c.useCallback)(e=>{e.shiftKey&&("ArrowDown"===e.key||"J"===e.key?I.setCurrentIndex(t=>{var l,i,n;if(1!==t[0])return[t[0],t[1]+(t[1]<(null===(l=I.currentArr[t[0]])||void 0===l?void 0:l.length)-1?1:0)];if(b(e)){if("ArrowDown"!==e.key)return[t[0],t[1]];{I.setSelectedIndices(Array.from({length:I.currentArr[t[0]].length-t[1]},(e,t)=>t).map(e=>[t[0],t[1]+e]));let e=null===(n=document.getElementsByClassName("fixed-list"))||void 0===n?void 0:n[0];return null==e||e.scrollTo({top:e.scrollHeight}),[t[0],I.currentArr[t[0]].length-1]}}if(t[1]<I.currentArr[t[0]].length-1){if(JSON.stringify(r).includes(JSON.stringify([t[0],t[1]+1])))s([...r].filter(e=>e[1]!==t[1]));else{if(!JSON.stringify(r).includes(JSON.stringify([t[0],t[1]]))&&!JSON.stringify(I.selectedIndices).includes(JSON.stringify([t[0],t[1]])))return s([...r,[t[0],t[1]]]),[t[0],t[1]];s([...r,[t[0],t[1]+1]])}}else JSON.stringify(r).includes(JSON.stringify([t[0],t[1]]))||s([...r,[t[0],t[1]]]);return[t[0],t[1]+(t[1]<(null===(i=I.currentArr[t[0]])||void 0===i?void 0:i.length)-1?1:0)]}):("ArrowUp"===e.key||"K"===e.key)&&I.setCurrentIndex(t=>{if(1!==t[0])return[t[0],t[1]-(t[1]>0?1:0)];if(b(e)){if("ArrowUp"!==e.key)return[t[0],t[1]];{var l;I.setSelectedIndices(Array.from({length:t[1]+1},(e,t)=>t).map(e=>[t[0],t[1]-e]));let e=null===(l=document.getElementsByClassName("fixed-list"))||void 0===l?void 0:l[0];return null==e||e.scrollTo({top:0}),[t[0],0]}}if(t[1]>0){if(JSON.stringify(r).includes(JSON.stringify([t[0],t[1]-1])))s([...r].filter(e=>e[1]!==t[1]));else{if(!JSON.stringify(r).includes(JSON.stringify([t[0],t[1]]))&&!JSON.stringify(I.selectedIndices).includes(JSON.stringify([t[0],t[1]])))return s([...r,[t[0],t[1]]]),[t[0],t[1]];s([...r,[t[0],t[1]-1]])}}else JSON.stringify(r).includes(JSON.stringify([t[0],t[1]]))||s([...r,[t[0],t[1]]]);return[t[0],t[1]-(t[1]>0?1:0)]}))},[s,r,I.setCurrentIndex,I.setSelectedIndices]),z=(0,c.useCallback)(async e=>{var t,n,r;let o=(null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key;if(!F(e)&&!_(e)){if("ArrowDown"===o||"j"===o){if((0,v._f)(window.location.pathname)&&"j"===o||e.shiftKey)return;if(b(e)){if("ArrowDown"!==o)return;{e.preventDefault();let t=null===(n=document.getElementsByClassName("fixed-list"))||void 0===n?void 0:n[0];I.setCurrentIndex(e=>{var l;return 1===e[0]&&t&&t.scrollTo({top:t.scrollHeight}),[e[0],(null===(l=I.currentArr[e[0]])||void 0===l?void 0:l.length)-1]})}}else y(e)||I.setCurrentIndex(t=>{var l,i;return void 0===t[0]?(e.preventDefault(),[1,0]):(t[1]<(null===(l=I.currentArr[t[0]])||void 0===l?void 0:l.length)-1&&e.preventDefault(),[t[0],t[1]+(t[1]<(null===(i=I.currentArr[t[0]])||void 0===i?void 0:i.length)-1?1:0)])})}else if("ArrowUp"===o||"k"===o){if(!window.location.pathname.includes("thread")&&1===I.currentIndex[0]&&0===I.currentIndex[1]){I.setCurrentIndex(e=>{if(1===e[0]&&0===e[1]){let t=document.getElementById("search-page-input");return null==t||t.setSelectionRange(0,null==t?void 0:t.value.length),setTimeout(()=>{null==t||t.focus()},0),[e[0],-1]}return[e[0],0===e[1]?0:e[1]-1]});return}if((0,v._f)(window.location.pathname)&&"k"===o||e.shiftKey)return;if(b(e)){if("ArrowUp"!==o)return;{e.preventDefault();let t=null===(r=document.getElementsByClassName("fixed-list"))||void 0===r?void 0:r[0];t&&1===I.currentIndex[0]&&t.scrollTo({top:0}),setTimeout(()=>{I.setCurrentIndex([I.currentIndex[0],0])},1)}}else y(e)||I.setCurrentIndex(t=>void 0===t[0]?[1,0]:(t[1]>0&&e.preventDefault(),[t[0],t[1]-(t[1]>0?1:0)]))}else if("ArrowLeft"===o)E.setQuickPreviewOpen(!1),I.setCurrentIndex(e=>{var t,l;return e[0]>0?1===e[0]?(i(e[1]),[0,3]):[e[0]-1,(null===(t=I.currentArr[e[0]-1])||void 0===t?void 0:t.length)-1<e[1]?(null===(l=I.currentArr[e[0]-1])||void 0===l?void 0:l.length)-1:e[1]]:[e[0],e[1]]});else if("ArrowRight"===o)I.setCurrentIndex(e=>{var t,n;if(window.location.pathname.includes("/mail/search")&&0===j.threads.length){let e=document.getElementById("search-page-input");return null==e||e.focus(),[1,-1]}return e[0]<I.currentArr.length-1?null!==l?(i(null),[e[0]+1,l]):[e[0]+1,(null===(t=I.currentArr[e[0]+1])||void 0===t?void 0:t.length)-1<e[1]?(null===(n=I.currentArr[e[0]+1])||void 0===n?void 0:n.length)-1:e[1]]:[e[0],e[1]]});else if("c"===o&&b(e)&&e.shiftKey&&!e.repeat){e.preventDefault();let t=window.location.href;navigator.clipboard.writeText(t),C(a.t.lambdas.CurrentUrlCopied({primaryText:t}))}}},[I.setCurrentIndex,I.currentArr,l]),_=(0,c.useCallback)(e=>{var t,l,i,n,r,o,d;if(F(e))return!1;let s=(null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key;if("g"!==s||y(e)){if(I.isNavigationActivated&&!y(e)){let e=!0;switch(s){case"i":A.push(O+"/inbox");break;case"s":A.push(O+"/starred");break;case"d":A.push(O+"/drafts");break;case"e":A.push(O+"/sent");break;case"p":A.push(O+"/spam");break;case"t":A.push(O+"/trash");break;case"a":A.push(O+"/archive");break;case"l":A.push(O+"/labels");break;case"n":A.push(O+"/settings/account/profile");break;default:e=!1}return e&&(I.setIsNavigationActivated(!1),null!==g.current&&(clearTimeout(g.current),g.current=null)),e}switch(s){case"/":N.setCurrentLabel("SEARCH"),A.push(O+"/search");break;case"[":if((null===(i=window)||void 0===i?void 0:null===(l=i.location)||void 0===l?void 0:l.pathname.includes("/settings/"))||e.repeat)break;y(e)||S.toggleLeftSidebar();break;case"]":if((null===(r=window)||void 0===r?void 0:null===(n=r.location)||void 0===n?void 0:n.pathname.includes("/settings/"))||e.repeat)break;y(e)||S.toggleRightSidebar();break;case"c":if(!y(e)&&!e.repeat){e.preventDefault();let t=document.getElementById("compose-button");t?null==t||t.click():E.setComposeOpen(!E.composeOpen)}break;case"v":if(!y(e)&&!e.repeat){e.preventDefault();let t=new MouseEvent("pointerdown",{view:window,ctrlKey:!1,bubbles:!0,cancelable:!0,metaKey:!1,button:0,buttons:1});null===(d=document)||void 0===d||null===(o=d.getElementById("view-dropdown-button"))||void 0===o||o.dispatchEvent(t)}break;case"?":y(e)||M.setHelpCenterModalOpen(!0);break;case x?"∂":"d":if(e.ctrlKey&&e.altKey){e.preventDefault();let t=(R.indexOf(L.current)+1)%R.length,l=R[t];w(l),C(a.t.lambdas.ThemeChanged({primaryText:l}))}break;case"Escape":window.location.pathname.includes("/settings/")?A.push(O+"/inbox"):window.location.pathname.includes("/labels/")&&A.push(O+"/labels")}}else null!==g.current&&clearTimeout(g.current),I.setIsNavigationActivated(!0),g.current=setTimeout(()=>{I.setIsNavigationActivated(!1),g.current=null},1100);return!1},[I.isNavigationActivated,E.composeOpen]);(0,c.useEffect)(()=>{0!==I.currentIndex[0]||S.sidebarOpen?1===I.currentIndex[0]&&S.sidebarOpen&&window.innerWidth<1024&&S.setLeftSidebarOpen(!1):S.setLeftSidebarOpen(!0)},[I.currentIndex]),(0,c.useEffect)(()=>{L.current=k},[k]),(0,c.useEffect)(()=>{var e;return M.isModalOpen?void 0:(null===(e=I.currentArr)||void 0===e?void 0:e.length)&&T.isDbInitialized?(window.addEventListener("keydown",z),()=>{null!==g.current&&(clearTimeout(g.current),g.current=null),window.removeEventListener("keydown",z)}):(window.addEventListener("keydown",_),()=>{null!==g.current&&(clearTimeout(g.current),g.current=null),window.removeEventListener("keydown",_)})},[z,_,I.currentArr,T.isDbInitialized,M.isModalOpen]),(0,c.useEffect)(()=>{i(0)},[N.currentLabel]),(0,c.useEffect)(()=>{if(!S.sidebarOpen&&0===I.currentIndex[0]){var e;I.setCurrentIndex([1,null===(e=I.currentIndex)||void 0===e?void 0:e[1]])}},[S.sidebarOpen]);let H=e=>{!F(e)&&f(window.location.pathname)&&(e.shiftKey||(r.length>0&&s([]),n([])))};return(0,c.useEffect)(()=>{var e;if((null===(e=I.currentArr)||void 0===e?void 0:e.length)&&!M.isModalOpen)return window.addEventListener("keyup",H),window.addEventListener("keydown",B),()=>{window.removeEventListener("keyup",H),window.removeEventListener("keydown",B)}},[r,I.selectedIndices,I.currentArr,E.composeOpen,B,M.isModalOpen]),(0,c.useEffect)(()=>{(null==r?void 0:r.length)>0&&n(e=>{let t=0===e.length?I.selectedIndices:e,l=[...t,...r],i=l.map(e=>e[1]),n=l.filter((e,t)=>i.indexOf(e[1])===t);return I.setSelectedIndices(n),t})},[r]),(0,c.useEffect)(()=>{I.setSelectedIndices([])},[N.currentLabel]),(0,c.useEffect)(()=>{if(f(D,!0)&&!D.includes("/search")){var e;let t=null===(e=E.emailData)||void 0===e?void 0:e.map(e=>e.id);I.setCurrentArr([["ACCOUNT","COMPOSE","SEARCH",...m.je.map(e=>null==e?void 0:e.id)],null==t?void 0:t.filter(e=>!!e)])}},[E.emailData,D]),(0,o.jsx)(o.Fragment,{children:t})})},46203:function(e,t,l){"use strict";l.d(t,{W:function(){return v},Z:function(){return m}});var i=l(93629),n=l(3984),r=l(95470),o=l(17157),a=l(87767),d=l(62516),s=l(61722),u=l(80672),c=l(49222);function v(e,t,l){let i=new Set(e),n=new Set(t);return!!(function(e,t,l){for(let i of["SPAM","TRASH"])if(e.has(i)&&l!==i||l===i&&(t.has(i)||e.has("INBOX")))return!0;return!1}(i,n,l)||l.startsWith("INBOX")&&n.has("INBOX")||"ARCHIVE"===l&&i.has("INBOX"))}function m(e){let{mutateList:t,mutateLabel:l,isSingleThreadView:m=!1}=e,{toastStore:{addToast:p},labelStore:h,syncStore:f,inboxStore:g,keyboardStore:b,idbStore:y,peopleStore:x,transactionStore:k}=(0,n.m)(),w=(0,a.useRouter)(),{mutate:C}=(0,s.kY)(),S=(0,d.useCallback)(function(e,t,l){var i;let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return{isOfflineMode:f.isOfflineMode,enqueue:k.enqueue,actionTitle:l.title,threadSubject:"primaryText"in t?t.primaryText:void 0,threadCount:"count"in t?t.count:void 0,threadIds:e,returnThread:m&&n?{id:null!==(i=e.at(0))&&void 0!==i?i:"",label:null==h?void 0:h.currentLabel}:void 0}},[k.enqueue,f.isOfflineMode,m,null==h?void 0:h.currentLabel]),I=(0,d.useCallback)(e=>{l&&l(t=>(t&&(t.threadsTotal=t.threadsTotal-e),t),{revalidate:!1})},[m,l]),N=(0,d.useCallback)((e,l,i)=>{var n,r,a,d,s,p,f,x,k,w;if(m){let a=(0,u.lp)(g.currentThread,l,[null!==(r=null===(n=g.currentThread)||void 0===n?void 0:n.id)&&void 0!==r?r:""],!1);(0,c.rK)({...l,mutate:(e,t)=>{var l;return C(null===(l=(0,o.ZN)(g.currentThread))||void 0===l?void 0:l.id,e,t)},optimisticData:e=>(e&&(e.messages=a.messages,e.historyId=Math.random().toString()),e),revalidate:!1,db:y.db?y.db:void 0,threadIds:e},i),t(t=>(0,u.lp)(t,l,e,!0,h.currentLabel),{revalidate:!1})}else(0,c.rK)({...l,revalidate:!1,mutate:t,optimisticData:t=>(0,u.lp)(t,l,e,!0,h.currentLabel),optimisticRollback:t=>(0,u.lp)(t,{emailIds:l.emailIds,addLabelIds:l.removeLabelIds,removeLabelIds:l.addLabelIds},e,!0,h.currentLabel),db:y.db?y.db:void 0,threadIds:e},i);l.removeLabelIds.includes(null==h?void 0:h.currentLabel)||v(l.addLabelIds,l.removeLabelIds,h.currentLabel)?(I(e.length),!m&&(null===(a=b.currentIndex)||void 0===a?void 0:a.at(0))===1&&(null!==(p=null===(d=b.currentIndex)||void 0===d?void 0:d.at(1))&&void 0!==p?p:0)>=(null===(s=g.emailData)||void 0===s?void 0:s.length)-1&&b.setCurrentIndex(e=>{var t;return[null==e?void 0:e.at(0),(null!==(t=null==e?void 0:e.at(1))&&void 0!==t?t:1)-1]})):(l.addLabelIds.includes(null==h?void 0:h.currentLabel)||v(l.removeLabelIds,l.addLabelIds,h.currentLabel))&&(I(-e.length),!m&&(null===(f=b.currentIndex)||void 0===f?void 0:f.at(0))===1&&(null!==(w=null===(x=b.currentIndex)||void 0===x?void 0:x.at(1))&&void 0!==w?w:0)>=(null===(k=g.emailData)||void 0===k?void 0:k.length)-1&&b.setCurrentIndex(e=>{var t;return[null==e?void 0:e.at(0),(null!==(t=null==e?void 0:e.at(1))&&void 0!==t?t:1)+1]}))},[m,g.currentThread,t,c.rK,null==h?void 0:h.currentLabel,I,y.db]),T=(0,d.useCallback)(e=>{let{hasLabel:t,threadIds:l,emailIds:n,toastProps:r}=e,o=i.t.lambdas.ConversationArchived(r),a=S(l,r,o);N(l,{emailIds:n,addLabelIds:t?["INBOX"]:[],removeLabelIds:t?[]:["INBOX"]},a),p(o)},[null==h?void 0:h.currentLabel,p,S,I,c.rK,N]),j=(0,d.useCallback)(e=>{let{hasLabel:t,threadIds:l,emailIds:n,toastProps:r}=e,o=i.t.lambdas.ConversationStarred(r),a=S(l,r,o,!1);N(l,{emailIds:n,addLabelIds:t?[]:["STARRED"],removeLabelIds:t?["STARRED"]:[]},a),p(o)},[p,S,N]),E=(0,d.useCallback)(e=>{let{hasLabel:t,threadIds:l,emailIds:n,toastProps:r}=e,o=i.t.lambdas.ConversationRead(r),a=S(l,r,o);N(l,{emailIds:n,addLabelIds:t?[]:["UNREAD"],removeLabelIds:t?["UNREAD"]:[]},a),p(o)},[p,N,t,S]),M=(0,d.useCallback)(e=>{let{isTrash:t,threadIds:l,emailIds:n,toastProps:r,isArchived:o,isSpam:a,transactionLink:d}=e,s=i.t.lambdas.ConversationDeleted(r),u={...S(l,r,s),transactionLink:d};N(l,{emailIds:n,addLabelIds:t?["INBOX"]:["TRASH"],removeLabelIds:t?["TRASH"]:o?a?["SPAM"]:[]:["INBOX"]},u),p(s)},[p,S,c.rK,null==h?void 0:h.currentLabel,N]),A=(0,d.useCallback)(e=>{let{isTrash:t,threadIds:l,emailIds:n,toastProps:r,isArchived:o,isSpam:a}=e,d=i.t.lambdas.ConversationSpam(r),s=S(l,r,d);N(l,{emailIds:n,addLabelIds:a?["INBOX"]:["SPAM"],removeLabelIds:a?["SPAM"]:o?t?["TRASH"]:[]:["INBOX"]},s),p(d)},[S,N,p,null==h?void 0:h.currentLabel]),D=(0,d.useCallback)(e=>{let{hasLabel:t,threadIds:l,emailIds:n,labelIds:r,subject:o,doesAddToast:a=!1}=e,d={isOfflineMode:f.isOfflineMode,enqueue:k.enqueue,actionTitle:"Label Updated",threadSubject:o,threadIds:l};N(l,{emailIds:n,addLabelIds:t?[]:r,removeLabelIds:t?r:[]},d),a&&p(i.t.lambdas.LabeledConversation({isActive:t,count:l.length,primaryText:o}))},[f.isOfflineMode,k.enqueue,N,p]),L=(0,d.useCallback)(e=>{var t,l;let{email:n,isSenderBlocked:a,isUndoOrRedo:d}=e,s=window.crypto.randomUUID(),u="".concat(a?"un":"","block-").concat(n,"-").concat(s),v=(null==x?void 0:null===(t=x.blockedSenders)||void 0===t?void 0:t.length)?[...(0,o.ZN)(null==x?void 0:x.blockedSenders)]:[];k.enqueue({transaction:{type:a?r.e.UnblockSender:r.e.BlockSender,parameters:{email:n},actionTitle:null===(l=i.t.lambdas.BlockedSender({primaryText:n,count:1,isActive:a}))||void 0===l?void 0:l.title,transactionLink:u},rollbackFn:()=>{x.setBlockedSenders(v)},isUndoOrRedo:d}),p(i.t.lambdas.BlockedSender({primaryText:n,count:1,isActive:a})),x.setBlockedSenders(a?null==v?void 0:v.filter(e=>e!==n):[...v,n]),a||d||(0,c.jD)("from:".concat(n," -label:TRASH")).then(e=>{let{emailIds:t,threadIds:l}=e;(null==t?void 0:t.length)&&M({threadIds:l,emailIds:t,toastProps:{isActive:!1,count:null==l?void 0:l.length,primaryText:""},isTrash:!1,isArchived:!1,isSpam:!1,transactionLink:u})})},[k.enqueue,x.blockedSenders]);return{executeLabelUndoAction:(0,d.useCallback)(e=>{var t,l,n,r,o,a,d,s,u,c,y,x,C,S;let{transactionCall:{transaction:I,setReturnThread:T},isRedo:j,threadList:E,workspaceUrl:M,currThreadInViewRemovedRef:A,nextButtonRef:D,escapeButtonRef:L}=e,R={isOfflineMode:f.isOfflineMode,enqueue:k.enqueue,actionTitle:(j?'Redo: "':'Undo: "')+I.actionTitle+'"',threadSubject:I.threadSubject,threadCount:I.threadCount,threadIds:I.threadIds,isUndoOrRedo:!0};j?p(i.t.lambdas.Redo({primaryText:I.actionTitle.at(0)+I.actionTitle.slice(1).toLowerCase()+"."})):p(i.t.lambdas.Undo({primaryText:(0,i.I)(I.actionTitle)}));let O=m&&I.threadIds.includes(null!==(l=null===(t=g.currentThread)||void 0===t?void 0:t.id)&&void 0!==l?l:"");if(v(I.resource.addLabelIds,I.resource.removeLabelIds,null==h?void 0:h.currentLabel))O&&(null===(n=g.currentThread)||void 0===n?void 0:n.id)&&(null==h?void 0:h.currentLabel)&&!I.returnThread&&T({id:g.currentThread.id,label:h.currentLabel}),N(I.threadIds,I.resource,R),O&&A&&(A.current=!0,null==D||D.click());else if(m){if(N(I.threadIds,I.resource,R),null===(r=I.resource.addLabelIds)||void 0===r?void 0:r.includes("UNREAD"))null==L||L.click();else if(I.returnThread){g.setCurrentThread(I.returnThread);let e=null===(u=window)||void 0===u?void 0:null===(s=u.location)||void 0===s?void 0:null===(d=s.pathname)||void 0===d?void 0:null===(a=d.split("/"))||void 0===a?void 0:null===(o=a.slice(0,-1))||void 0===o?void 0:o.join("/");w.push(e+"/"+(null===(c=I.returnThread)||void 0===c?void 0:c.id))}}else if(!I.threadIds.includes(null!==(x=null===(y=g.currentThread)||void 0===y?void 0:y.id)&&void 0!==x?x:"")&&(N(I.threadIds,I.resource,R),I.returnThread&&(null===(C=I.resource.removeLabelIds)||void 0===C?void 0:C.includes("UNREAD"))&&I.returnThread.label===(null==h?void 0:h.currentLabel))){let e=null==E?void 0:E.findIndex(e=>{var t;return e.id===(null===(t=I.returnThread)||void 0===t?void 0:t.id)});E&&void 0!==e&&e>=0&&(b.setCurrentThreadIndex(e),g.setCurrentThread(E[e]),w.push(M+"/thread/"+(null===(S=I.returnThread)||void 0===S?void 0:S.id)))}},[b.setCurrentThreadIndex,g.setCurrentThread,p,f.isOfflineMode,m,null==h?void 0:h.currentLabel,N]),spamToggleThreads:A,deleteToggleThreads:M,unreadToggleThreads:E,starToggleThreads:j,archiveToggleThreads:T,changeThreadLabels:D,blockSenderAction:L}}},29970:function(e,t,l){"use strict";l.d(t,{C1:function(){return v},Ln:function(){return g},Rp:function(){return c},mE:function(){return m},r0:function(){return b},rm:function(){return y},sk:function(){return u},vv:function(){return k}});var i=l(71451),n=l(3984),r=l(62516),o=l(61722),a=l(57802),d=l(80672),s=l(70137);let u=25,c=30,v=20,m="-label:INBOX -label:DRAFT (-label:SENT OR (label:SENT to:me))",p=(e,t,l)=>{var i;return!(null==t?void 0:t.token)&&e>0||t&&(null==t?void 0:null===(i=t.messages)||void 0===i?void 0:i.length)<u?null:e>0?"".concat(e,"-").concat(null==t?void 0:t.token,"-").concat(l):"/".concat(l)},h=async()=>{var e,t,l,i;let n=null===(e=window)||void 0===e?void 0:e.gapi,r=localStorage.getItem("historyId"),{result:{historyId:o}}=await (null==n?void 0:null===(i=n.client)||void 0===i?void 0:null===(l=i.gmail)||void 0===l?void 0:null===(t=l.users)||void 0===t?void 0:t.getProfile({userId:"me"}));return{current:!!r&&r===o,newHistoryId:o}},f=async e=>{var t,l,i,n,r,o,a,s,u;let{db:c,label:v}=e,m=null===(t=window)||void 0===t?void 0:t.gapi;try{if(!v)return!1;let{result:e}=await (null==m?void 0:null===(r=m.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.history)||void 0===l?void 0:l.list({userId:"me",labelId:"ARCHIVE"===v?"INBOX":v,startHistoryId:null!==(s=null!==(a=localStorage.getItem("history-".concat(v)))&&void 0!==a?a:localStorage.getItem("historyId"))&&void 0!==s?s:"",historyTypes:["labelAdded","labelRemoved","messageDeleted"]}));if(null==e?void 0:e.history){let t=new Map,l=null==e?void 0:e.history.map(async e=>{var l,i;let n=null!==(i=null==e?void 0:e.labelsRemoved)&&void 0!==i?i:null==e?void 0:e.labelsAdded;if(null==n?void 0:n.length){let e=n.map(async e=>{var l,i;if(!(null==e?void 0:null===(l=e.message)||void 0===l?void 0:l.threadId))return;let n=null!==(i=t.get(e.message.threadId))&&void 0!==i?i:await (null==c?void 0:c.get("mail",e.message.threadId));if(n){n.messages.find((t,l)=>t.id===e.message.id&&(n.messages[l].labelIds=e.message.labelIds,!0));let l=(0,d.CF)(n);t.set(e.message.threadId,{...n,...l})}});await Promise.all(e)}if(null==e?void 0:null===(l=e.messagesDeleted)||void 0===l?void 0:l.length){let l=null==e?void 0:e.messagesDeleted.map(async e=>{var l,i,n;if(null==e?void 0:null===(l=e.message)||void 0===l?void 0:l.threadId){if(null===(i=e.message.labelIds)||void 0===i?void 0:i.includes("DRAFT")){let l=null!==(n=t.get(e.message.threadId))&&void 0!==n?n:await (null==c?void 0:c.get("mail",e.message.threadId));if(l){let i=!1;if(l.messages=l.messages.filter(t=>t.id!==e.message.id||(i=!0,!1)),0===l.messages.length)null==c||c.delete("mail",e.message.threadId),t.delete(e.message.threadId);else if(i){let i=(0,d.CF)(l);t.set(e.message.threadId,{...l,...i})}}}else null==c||c.delete("mail",e.message.threadId),t.delete(e.message.threadId)}});await Promise.all(l)}});await Promise.all(l),t.forEach(e=>{null==c||c.put("mail",e)})}return e&&v&&localStorage.setItem("history-".concat(v),null==e?void 0:e.historyId),!!(null==e?void 0:null===(o=e.history)||void 0===o?void 0:o.length)}catch(t){console.error(t);let e=null===(u=localStorage)||void 0===u?void 0:u.getItem("historyId");v&&e&&localStorage.setItem("history-".concat(v),e)}return!1},g=async e=>{var t,l,i,n,r,o,a,s,v,p,h;let{currentLabel:g,db:b,pageToken:y}=e,x=null===(t=window)||void 0===t?void 0:t.gapi,k=[];if((null==y?void 0:y.charAt(0))!=="/"&&!(null==y?void 0:y.includes("-")))return{messages:[],pageToken:null};try{let e=g.includes("INBOX-split-"),t=e?(null==g?void 0:null===(l=g.split("-split-"))||void 0===l?void 0:l.at(1))+" in:inbox":"",p=e?"INBOX":g,h=null==(k=await (null==x?void 0:null===(r=x.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:i.threads.list({userId:"me",maxResults:u,pageToken:(null==y?void 0:y.charAt(0))!=="/"?y.split("-")[1]:null,labelIds:g&&"ARCHIVE"!==g?[p]:null,q:"ARCHIVE"===g?m:t})))?void 0:null===(a=k.result)||void 0===a?void 0:null===(o=a.threads)||void 0===o?void 0:o.map(async e=>{var l,i,n;let r=await (null==b?void 0:b.get("mail",null==e?void 0:e.id));if(r&&r.historyId===e.historyId){let e=!!t&&!r.labelIds.includes(g);return{result:r,cached:!e}}return null==x?void 0:null===(n=x.client)||void 0===n?void 0:null===(i=n.gmail)||void 0===i?void 0:null===(l=i.users)||void 0===l?void 0:l.threads.get({userId:"me",id:null==e?void 0:e.id,fields:"historyId,id,messages(id,internalDate,labelIds,payload,snippet,threadId)"})}),w=h&&(await Promise.all(h)).filter(e=>!!e),C=(null==y?void 0:y.charAt(0))==="/"?0:Number(y.split("-")[0]);return((null==y?void 0:y.charAt(0))==="/"||C<c)&&w&&(null==b?void 0:null===(s=b.objectStoreNames)||void 0===s?void 0:s.contains("mail"))&&(null==w||w.map(e=>{var l,i;if(!(null==e?void 0:e.cached)){let l=(0,d.CF)(null==e?void 0:e.result,t&&g);null==b||b.put("mail",{...null==e?void 0:e.result,...l})}null==e||null===(i=e.result)||void 0===i||null===(l=i.messages)||void 0===l||l.forEach(e=>{var t,l,i;let n=null!==(i=null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.parts)||void 0===t?void 0:t.filter(e=>"text/html"!==e.mimeType||!e.body.data))&&void 0!==i?i:[];e.payload.parts=n})}),await f({db:b,label:p})),{messages:w,token:null==k?void 0:null===(v=k.result)||void 0===v?void 0:v.nextPageToken}}catch(e){throw console.error(e),Error(null==e?void 0:null===(h=e.result)||void 0===h?void 0:null===(p=h.error)||void 0===p?void 0:p.message)}};function b(e,t,l,i,n,r){let o=async t=>{if(!t||!e)return null;let r=e;if(!s.TF.includes(e)&&e.startsWith("Label_")){var o,a;let t=await (null==n?void 0:n.getAll("label-users"));r=null!==(a=null==t?void 0:null===(o=t.find(t=>t.name===e||t.name==="[Tatem]/".concat(e)||t.id===e))||void 0===o?void 0:o.id)&&void 0!==a?a:""}else if(!s.TF.includes(e)&&!e.includes("INBOX"))return null;let d=await h();d.current||localStorage.setItem("historyId",d.newHistoryId);let u=await g({pageToken:t,currentLabel:r,db:n});return"SYNCING"===l&&i("ONLINE"),u};return(0,a.ZP)(r&&n?(t,l)=>p(t,l,e):()=>null,o,{revalidateAll:!1,revalidateFirstPage:!0,refreshInterval:t||"SEARCH"===e?0:1e4,...k})}function y(e,t){let{gapiStore:l,idbStore:i,labelStore:a}=(0,n.m)(),[d,u]=(0,r.useState)(null),c=async e=>{var l,i,n,r,o,a,d,u,c,v,p,h,f,g,b;let y=null===(l=window)||void 0===l?void 0:l.gapi,x=!s.TF.includes(e)&&(null==t?void 0:null===(i=t.find(t=>t.name===e||(null==t?void 0:t.id)===e))||void 0===i?void 0:i.id)||(null==e?void 0:null===(n=e.split("-"))||void 0===n?void 0:n.at(0)),k=e.includes("INBOX-split-")?null==e?void 0:null===(r=e.split("-split-"))||void 0===r?void 0:r.at(1):"";if("ARCHIVE"===e||k){let e=0,t="/",l=0;for(;t&&e++<10;)try{let e=k?["INBOX"]:null,i=await (null==y?void 0:null===(v=y.client)||void 0===v?void 0:null===(c=v.gmail)||void 0===c?void 0:null===(u=c.users)||void 0===u?void 0:u.threads.list({userId:"me",maxResults:500,pageToken:"/"!==t?t:null,labelIds:e,q:null!=k?k:m,fields:"threads(historyId),nextPageToken"}));l+=(null==i?void 0:i.result)?null==i?void 0:null===(h=i.result)||void 0===h?void 0:null===(p=h.threads)||void 0===p?void 0:p.length:0,t=null==i?void 0:null===(f=i.result)||void 0===f?void 0:f.nextPageToken}catch(e){throw console.error(e),t=null,Error(null==e?void 0:null===(b=e.result)||void 0===b?void 0:null===(g=b.error)||void 0===g?void 0:g.message)}return{id:k?"INBOX-split-".concat(k):"ARCHIVE",threadsTotal:l}}if("SEARCH"===e)return{id:e};let w=x&&await (null==y?void 0:null===(d=y.client)||void 0===d?void 0:null===(a=d.gmail)||void 0===a?void 0:null===(o=a.users)||void 0===o?void 0:o.labels.get({userId:"me",id:x,fields:"threadsTotal,name,id,type"}));return null==w?void 0:w.result},{data:v,error:p,mutate:h}=(0,o.ZP)(l.gapiInitialized?e:null,c,k);return(0,r.useEffect)(()=>{if(!p){if(v){u({...v});let t=a.cachedLabelArr.findIndex(t=>t.id===e);if(t>=0){let e=[...a.cachedLabelArr];e[t].count=null==v?void 0:v.threadsTotal,a.setCachedLabelArr(e)}}else if(i.isDbInitialized&&e){var t;null===(t=i.db)||void 0===t||t.get("label-users",e).then(t=>{u({id:e,threadsTotal:null==t?void 0:t.count})})}}},[v,null==v?void 0:v.threadsTotal,i.isDbInitialized,!!e]),{data:d,mutate:h}}let x=async()=>{var e,t,l,n,r,o;let a=(0,i.e)(),d=null===(e=window)||void 0===e?void 0:e.gapi,{data:{session:s}}=await a.auth.getSession(),u="",c=null!==(o=null==s?void 0:s.provider_refresh_token)&&void 0!==o?o:null==s?void 0:null===(l=s.user)||void 0===l?void 0:null===(t=l.user_metadata)||void 0===t?void 0:t.prt,v=await a.functions.invoke("gapi-token-refresh",{body:{refreshToken:c}});u=null==v?void 0:null===(n=v.data)||void 0===n?void 0:n.access_token,null==d||null===(r=d.client)||void 0===r||r.setToken({refresh_token:c,access_token:u}),await a.auth.updateUser({data:{pt:u,prt:c}}),await a.auth.refreshSession()},k={shouldRetryOnError:e=>(null==e?void 0:e.status)!==400&&(null==e?void 0:e.status)!==403,onErrorRetry:(e,t,l,i,n)=>{let{retryCount:r}=n;r>3||((null==e?void 0:e.status)===401?x().then(()=>{i({retryCount:r})}):(null==e?void 0:e.status)===429?setTimeout(()=>i({retryCount:r}),(2^r)*2e3):setTimeout(()=>i({retryCount:r}),2e3))}}},6313:function(e,t,l){"use strict";l.d(t,{T:function(){return d}});var i=l(3984),n=l(87767),r=l(62516),o=l(70137),a=l(60136);let d=()=>{let{labelStore:e,supabaseStore:t}=(0,i.m)(),l=(0,n.usePathname)(),d=(0,a.H)(),s=(0,n.useRouter)();(0,r.useEffect)(()=>{var i,r,a,u,c,v,m;let p=l.includes("/mail/search"),h=l.includes("/thread/"),f=l.endsWith("/compose");if(p||h&&e.currentLabel||f)return;let g=l.split("/"),b=g.indexOf("mail"),y=(null==g?void 0:g.at(b+1))==="inbox"&&!!(null==g?void 0:g.at(b+2))&&(null==g?void 0:g.at(b+2))!=="thread",x=(null==g?void 0:g.at(b+1))==="labels"&&!!(null==g?void 0:g.at(b+2))&&(null==g?void 0:g.at(b+2))!=="thread",k=decodeURI(null!==(i=null==g?void 0:g.at(b+(y||x?2:1)))&&void 0!==i?i:"");if(k){let i=o.je.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===k}),p=l.includes("/inbox/")&&(null==t?void 0:null===(r=t.inboxSplits)||void 0===r?void 0:r.find(e=>e.name.toLowerCase()===k)),h=!!(null==t?void 0:null===(a=t.inboxSplits)||void 0===a?void 0:a.length);if(i||k.includes("Label")||p){if((null==i?void 0:i.id)==="INBOX"){let l=null===(v=t.inboxSplits)||void 0===v?void 0:v.find(e=>e.active);l&&e.setCurrentLabel("INBOX-split-".concat(null==l?void 0:l.value))}else p?e.setCurrentLabel("INBOX-split-".concat(null==p?void 0:p.value)):e.setCurrentLabel(null!==(m=null==i?void 0:i.id)&&void 0!==m?m:k)}else{if(!h)return;if(e.currentLabel.startsWith("INBOX-split-")){let l=e.currentLabel.replace("INBOX-split-","");if(t.inboxSplits.find(e=>e.value===l&&e.active))return}"mail"===k&&(null===(c=l.split("/"))||void 0===c?void 0:null===(u=c.filter(e=>!!e))||void 0===u?void 0:u.length)<=2?s.replace(d+"/inbox"):(0,n.notFound)()}}else e.setCurrentLabel("INBOX")},[l,null==t?void 0:t.inboxSplits])}},32930:function(e,t,l){"use strict";l.d(t,{u:function(){return r},v:function(){return n}});var i=l(62516);let n=e=>{let[t,l]=(0,i.useState)(!1),n=t=>{var i,n;(e?null==t?void 0:null===(i=t.target)||void 0===i?void 0:i.scrollTop:null===(n=window)||void 0===n?void 0:n.scrollY)>1?l(!0):l(!1)};return(0,i.useEffect)(()=>{var t;let l=e&&null!==(t=document.querySelector(e))&&void 0!==t?t:window;return l.addEventListener("scroll",n),()=>{l.removeEventListener("scroll",n)}},[e]),t},r=()=>{var e,t,l;return(null===(l=window)||void 0===l?void 0:null===(t=l.navigator)||void 0===t?void 0:null===(e=t.platform)||void 0===e?void 0:e.indexOf("Mac"))===0?null:"custom-scroll"}},9112:function(e,t,l){"use strict";l.d(t,{q:function(){return B},V:function(){return L}});var i=l(44003),n=l(25441),r=l(71451),o=l(93629),a=l(3984),d=l(40911),s=l(83015),u=l(95470),c=l(74848),v=l(61808),m=l.n(v),p=l(17157),h=l(1394),f=l(87767),g=l(62516),b=l(19959),y=l(44424),x=l(63372),k=l(39359),w=l(50026),C=l(31248),S=l(17115),I=l(27799),N=l(80672),T=l(70137),j=l(60136);let E=e=>{let{contact:t,userEmail:l,type:n}=e,{toastStore:{addToast:r},composeStore:s}=(0,a.m)(),u=(0,I.eE)(t,l),c="from"===n?o.t.lambdas.SenderAddressCopied:o.t.lambdas.RecipientAddressCopied,v="from"===n?T.Wz.CopySendersAddress.title:T.Wz.CopyRecipientAddress.title;return u.map((e,t)=>{let{name:l,email:o}=e,a=t===u.length-1;return(0,i.jsx)(d.l,{onClick:()=>{window.navigator.clipboard.writeText(o),r(c({primaryText:o,count:1}))},tooltip:{title:v,keys:"from"===n?T.Wz.CopySendersAddress.keys:void 0,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"cursor-pointer whitespace-pre text-left text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",onMouseEnter:()=>{s.setCurrentFocusedContact({name:""===l.trim()?o:l,emailAddress:o,sourceType:"manual"})},children:(l?"".concat(l," <").concat(o,">"):o)+(a?"":", ")})},o)})};E.displayName="ContactWithClickToCopy";var M=(0,h.Pi)(E),A=l(27406);l(59613);var D=l(50864);let L={weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0},R=(e,t)=>{var l,i,n,r,o,a,d,s,u,c;let v=null!==(c=null==e?void 0:null===(n=e.payload)||void 0===n?void 0:null===(i=n.headers)||void 0===i?void 0:null===(l=i.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="reply-to"}))||void 0===l?void 0:l.value)&&void 0!==c?c:null==e?void 0:null===(a=e.payload)||void 0===a?void 0:null===(o=a.headers)||void 0===o?void 0:null===(r=o.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===r?void 0:r.value;return(null==v?void 0:v.includes(t))?null==e?void 0:null===(u=e.payload)||void 0===u?void 0:null===(s=u.headers)||void 0===s?void 0:null===(d=s.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="to"}))||void 0===d?void 0:d.value:v},O=(e,t)=>{var l,i;if(!e)return[];let n=null==t?void 0:null===(l=t.reduce((e,t)=>null==e?void 0:e.replaceAll(t,""),e))||void 0===l?void 0:l.split(","),r=null==n?void 0:null===(i=n.filter(e=>!!(null==e?void 0:e.trim())&&!e.includes("<>")))||void 0===i?void 0:i.toString();return(null==r?void 0:r.length)?r:[]},F=e=>(e.includes("Re: ")?"":"Re: ")+e,B=(0,h.Pi)(e=>{var t,l,r,v,h,E,D,B,_,H,P,U,W,q,K,V,J,X,G,Q;let{itemIndex:Z,message:Y,html:$,mutate:ee,mutateInbox:et,updateThreadMessages:el,rawThreadMessages:ei,messageThreadIndex:en,isOpen:er=!1,isLastMessage:eo,draftReplies:ea}=e,ed=!!Y&&new Date(parseInt(null==Y?void 0:Y.internalDate)),[es,eu]=(0,g.useState)(er),[ec,ev]=(0,g.useState)({id:"",current:!0}),[em,ep]=(0,g.useState)(!1),[eh,ef]=(0,g.useState)(!1),[eg,eb]=(0,g.useState)(!1),[ey,ex]=(0,g.useState)(0),ek=null==Y?void 0:null===(t=Y.labelIds)||void 0===t?void 0:t.includes("DRAFT"),ew=(0,f.useSearchParams)(),eC=(0,f.useRouter)(),eS=(0,f.usePathname)(),[eI,eN]=(0,g.useState)(ea),eT=()=>"".concat(null==Y?void 0:Y.threadId,"-").concat(null==Y?void 0:Y.id,"-").concat(null==eI?void 0:eI.id),[ej,eE]=(0,g.useState)(eT()),{toastStore:{addToast:eM},uiStore:eA,supabaseStore:eD,gapiStore:eL,keyboardStore:eR,inboxStore:eO,labelStore:eF,composeStore:eB,transactionStore:ez,idbStore:e_}=(0,a.m)(),eH=(0,g.useMemo)(()=>Z===eR.currentIndex[1]&&1===eR.currentIndex[0],[Z,eR.currentIndex]),[eP,eU]=(0,g.useState)(C.ox),[eW,eq]=(0,g.useState)(!1),eK=(0,g.useMemo)(()=>eh&&eW,[eW,eh]),eV=(0,g.useRef)(!1),eJ=(0,g.useRef)(!1),eX=(0,j.H)(),eG=(0,g.useRef)(null),eQ=(0,g.useMemo)(()=>(0,I.Uq)(Y,"from",!1),[Y]),eZ=(0,g.useMemo)(()=>(0,I.Uq)(Y,"to",!1),[Y]),eY=(0,g.useMemo)(()=>(0,I.Uq)(Y,"Cc"),[Y]),e$=(0,g.useMemo)(()=>(0,I.Uq)(Y,"Bcc"),[Y]),e0=(0,g.useMemo)(()=>eY.length?eZ+", "+eY:eZ,[eZ,eY]),e1=(0,g.useMemo)(()=>(0,y.dt)(Y,!1),[Y]),e2=(0,g.useMemo)(()=>{var e,t,l;return null==Y?void 0:null===(l=Y.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:null===(e=t.find(e=>"Subject"===e.name))||void 0===e?void 0:e.value},[Y]),e5=e=>{var t;return null===(t=Object.entries(e))||void 0===t?void 0:t.map(e=>{var t,l;let[i,n]=e;return{name:i,value:"From"===i?null===(t=eD.userData)||void 0===t?void 0:t.email:"To"===i||"Cc"===i||"Bcc"===i?null==n?void 0:null===(l=n.map(e=>(null==e?void 0:e.name)?"".concat(null==e?void 0:e.name," <").concat(e.addr,">"):null==e?void 0:e.addr))||void 0===l?void 0:l.join(", "):n}})},e3=()=>{let e=ek?Y:eI,t=e?(0,I.Uq)(e,"alias"):void 0;return(null==t?void 0:t.length)?t:"alias-"+window.crypto.randomUUID()},e6=async e=>{var t,l,i;let n=null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.parts)||void 0===t?void 0:t.find(e=>"text/plain"===e.mimeType),r=(0,I.Gr)(null==e?void 0:e.payload,!!n),o=(0,I.K9)(r),a=null!==(i=o&&new TextDecoder("utf-8").decode(o))&&void 0!==i?i:"",d=e=>(null==e?void 0:e.length)?null==e?void 0:e.split(", "):[],s=d((0,I.Uq)(e,"Cc")),u=d((0,I.Uq)(e,"Bcc")),c=d(ek?eZ:(0,I.Uq)(e,"to",!1)),v=(0,I.Uq)(e,"Subject");eU({...C.ox,recipient:c,cc:s,bcc:u,subject:ek?null!=e2?e2:"":v,message:a,threadId:null==e?void 0:e.threadId,messageId:null==e?void 0:e.id,type:ek?"draft":v.startsWith("Fwd: ")?"forward":"reply"})};(0,g.useEffect)(()=>{(async e=>{var t,l,i,n,r,o,a;if(eJ.current)return;let d=null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.parts)||void 0===t?void 0:t.some(e=>{var t;return!(null===(t=e.filename)||void 0===t?void 0:t.length)&&("text/html"===e.mimeType||"multipart/alternative"===e.mimeType||"multipart/related"===e.mimeType)}),s=null==e?void 0:null===(n=e.payload)||void 0===n?void 0:null===(i=n.parts)||void 0===i?void 0:i.length;if(s&&s>1&&d){let t=null==e?void 0:null===(o=e.payload)||void 0===o?void 0:null===(r=o.parts)||void 0===r?void 0:r.find(e=>"text/plain"===e.mimeType),l=(0,I.Gr)(null==e?void 0:e.payload,!!t),i=(0,I.K9)(l),n=null!==(a=i&&new TextDecoder("utf-8").decode(i))&&void 0!==a?a:"",d=(0,y.dt)(e,!0),s=d&&(await Promise.all(null==d?void 0:d.map(async t=>{var l,i,r,o,a,d,s,u,c;let v=await (0,y.ce)({part:t,message:e}),m=null==t?void 0:null===(i=t.headers)||void 0===i?void 0:null===(l=i.find(e=>"CONTENT-ID"===e.name.toUpperCase()))||void 0===l?void 0:l.value;return m&&n.includes(null==m?void 0:null===(r=m.replaceAll("<",""))||void 0===r?void 0:r.replaceAll(">",""))?(n=n.replace('src="cid:'.concat(null==m?void 0:null===(o=m.replaceAll("<",""))||void 0===o?void 0:o.replaceAll(">","")),'src="data:image/png;base64,'+(null==v?void 0:null===(d=v.result)||void 0===d?void 0:null===(a=d.data)||void 0===a?void 0:a.replace(/-/g,"+").replace(/_/g,"/"))),null):v?{contentType:t.mimeType,data:null==v?void 0:null===(u=v.result)||void 0===u?void 0:null===(s=u.data)||void 0===s?void 0:s.replace(/-/g,"+").replace(/_/g,"/"),filename:t.filename,body:{size:null==t?void 0:null===(c=t.body)||void 0===c?void 0:c.size}}:void 0}))).filter(e=>!!e);eU(e=>({...e,message:n,attachments:s}))}})(ek?Y:eI)},[null==eI?void 0:null===(l=eI.payload)||void 0===l?void 0:l.parts,null==Y?void 0:null===(r=Y.payload)||void 0===r?void 0:r.parts]);let e4=(e,t,l,i)=>{var n,r,o,a,d;if(!e)return e;let s=e5(l.getHeaders()),u={id:null!=i?i:"new-message",internalDate:String(Date.now()),labelIds:["DRAFT"],payload:{headers:s,body:{data:l.toBase64(null==t?void 0:t.message),size:0}},snippet:(null==t?void 0:t.message.slice(0,100))+((null==t?void 0:null===(n=t.message)||void 0===n?void 0:n.length)>100?"...":"")},c=e.findIndex(e=>!!e&&("threadResults"in e?e.threadResults.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):e.messages.find(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}))),v=e[c];if(!v)return e;let m="threadResults"in v,p=m?null===(r=v.threadResults)||void 0===r?void 0:r.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):null===(o=v.messages)||void 0===o?void 0:o.findIndex(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}),h=m?null===(a=v.threadResults)||void 0===a?void 0:a[p]:null===(d=v.messages)||void 0===d?void 0:d[p].result;h.messages.push(u);let f=[...m?null==v?void 0:v.threadResults:null==v?void 0:v.messages],g=[...e];return m?(f[p]=h,g[c]={...v,threadResults:f}):(f[p].result=h,g[c]={...v,messages:f}),[...g,{}]},e8=function(e,t,l,i,n){var r,o,a,d,s,u,c,v,m;let p=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!e)return e;let h=e5(l.getHeaders()),f=e.findIndex(e=>!!e&&("threadResults"in e?e.threadResults.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):e.messages.find(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}))),g=e[f];if(!g)return e;let b="threadResults"in g,y=b?null===(r=g.threadResults)||void 0===r?void 0:r.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):null===(o=g.messages)||void 0===o?void 0:o.findIndex(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}),x=b?null===(a=g.threadResults)||void 0===a?void 0:a[y]:null===(d=g.messages)||void 0===d?void 0:d[y].result,k=null==x?void 0:null===(s=x.messages)||void 0===s?void 0:s.findIndex(e=>(null==e?void 0:e.id)===(null==eI?void 0:eI.id)||!eI&&(null==e?void 0:e.id)===(null==Y?void 0:Y.id)||(0,I.Uq)(e,"alias")===n);if(k>=0){let e={...x.messages[k],id:i,payload:{...null===(u=x.messages[k])||void 0===u?void 0:u.payload,headers:h,body:{...null===(v=x.messages[k])||void 0===v?void 0:null===(c=v.payload)||void 0===c?void 0:c.body,data:l.toBase64(null==t?void 0:t.message)}},snippet:(null==t?void 0:t.message.slice(0,100))+((null==t?void 0:null===(m=t.message)||void 0===m?void 0:m.length)>100?"...":"")};p?e.labelIds=["SENT"]:e.internalDate=String(Date.now()),x.messages[k]=e}let w=[...b?null==g?void 0:g.threadResults:null==g?void 0:g.messages],C=[...e];return b?(w[y]=x,C[f]={...g,threadResults:w}):(w[y]&&(w[y].result=x),C[f]={...g,messages:w}),[...C,{}]},e9=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&et&&et(()=>{},{optimisticData:l=>l?(!l.some(t=>{var l,i;return!!t&&("threadResults"in t?null===(l=t.threadResults)||void 0===l?void 0:l.some((l,i)=>(null==l?void 0:l.id)===(null==Y?void 0:Y.threadId)&&(t.threadResults[i]=e,!0)):null===(i=t.messages)||void 0===i?void 0:i.some((l,i)=>{var n;return(null==l?void 0:null===(n=l.result)||void 0===n?void 0:n.id)===(null==Y?void 0:Y.threadId)&&(t.messages[i].result=e,!0)}))})&&t&&l.findIndex(t=>!!t&&("threadResults"in t?t.threadResults.push(e):t.messages.push({result:e,cached:!1}),!0)),[...l,{}]):l,revalidate:!0,populateCache:!1})},e7=(e,t,l,i,n)=>{ee&&ee(()=>{},{optimisticData:r=>{if(!(null==r?void 0:r.messages))return r;let o={...e,id:l,labelIds:t},a=(0,I.Uq)(e,"alias"),d=r.messages.findLastIndex(t=>(null==t?void 0:t.id)===e.id||(0,I.Uq)(t,"alias")===a),s=r.messages,u=r.decodedMessages;d>=0&&(s.splice(d,1),u.splice(d,1));let c={...r,messages:[...s,o],decodedMessages:[...u,n]};return i&&(c.historyId=i),c},revalidate:!1,populateCache:!1})},te=(e,t)=>{var l,i,n;if(!e)return e;let r=(null!=t?t:ek)?null==Y?void 0:Y.id:null==eI?void 0:eI.id;return{messages:[...null!==(i=null===(l=e.messages)||void 0===l?void 0:l.filter(e=>{var t;return(null==e?void 0:e.id)!==r||!(null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes("DRAFT"))}))&&void 0!==i?i:[]],decodedMessages:[...null!==(n=e.decodedMessages)&&void 0!==n?n:[]]}},tt=(e,t,l)=>{var i,n,r,o,a,d,s;if(!e)return e;let u=e.findIndex(e=>!!e&&("threadResults"in e?e.threadResults.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):e.messages.find(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}))),c=u>=0?e[u]:void 0;if(!c)return e;let v="threadResults"in c,m=[...e];if(ek)v?(c.threadResults=null===(i=c.threadResults)||void 0===i?void 0:i.filter(e=>(null==e?void 0:e.id)!==(null==Y?void 0:Y.threadId)),m[u]={...c,threadResults:[...c.threadResults]}):(c.messages=null===(n=c.messages)||void 0===n?void 0:n.filter(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)!==(null==Y?void 0:Y.threadId)}),m[u]={...c,messages:[...c.messages]});else{let i=null!=l?l:null==eI?void 0:eI.id,n=v?null===(r=c.threadResults)||void 0===r?void 0:r.findIndex(e=>(null==e?void 0:e.id)===(null==Y?void 0:Y.threadId)):null===(o=c.messages)||void 0===o?void 0:o.findIndex(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===(null==Y?void 0:Y.threadId)}),p=v?null===(a=c.threadResults)||void 0===a?void 0:a[n]:null===(d=c.messages)||void 0===d?void 0:d[n].result;if(!p)return e;p.messages=null==p?void 0:null===(s=p.messages)||void 0===s?void 0:s.filter(e=>(null==e?void 0:e.id)!==i&&(0,I.Uq)(e,"alias")!==t);let h=[...v?null==c?void 0:c.threadResults:null==c?void 0:c.messages];v?(h[n]=p,m[u]={...c,threadResults:h}):(h[n].result=p,m[u]={...c,messages:h})}return[...m,{}]},tl=async e=>{var t,l,i,n,r,o,a,d,c,v,m,h,f,g,b,y,x;let k=ek?Y:eI,w={hasDraftSaved:eJ.current,draftMessageId:null==k?void 0:k.id,rollbackThread:(0,p.ZN)(eO.currentThread)};eJ.current=!0;let C=!w.hasDraftSaved&&!k,S="swr-"+window.crypto.randomUUID(),T=(0,I.Uq)(k,"message-id",!1),j=(0,I.Uq)(k,"draft-id"),E=e3(),M={};ek||(M.References=(null==Y?void 0:null===(a=Y.payload)||void 0===a?void 0:null===(o=a.headers)||void 0===o?void 0:null===(r=o.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="message-id"}))||void 0===r?void 0:r.value)+(null!==(g=null==Y?void 0:null===(v=Y.payload)||void 0===v?void 0:null===(c=v.headers)||void 0===c?void 0:null===(d=c.find(e=>"References"===e.name))||void 0===d?void 0:d.value)&&void 0!==g?g:""),M["In-Reply-To"]=null==Y?void 0:null===(f=Y.payload)||void 0===f?void 0:null===(h=f.headers)||void 0===h?void 0:null===(m=h.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="message-id"}))||void 0===m?void 0:m.value),M.alias=E,j.length?M["draft-id"]=j:j=void 0;let A={...e,sender:"".concat(null===(l=eD.userData)||void 0===l?void 0:null===(t=l.user_metadata)||void 0===t?void 0:t.name," <").concat(null===(i=eD.userData)||void 0===i?void 0:i.email,">"),headers:M,addTatemWatermark:!1},D=(0,I.eK)(A),L=e5(D.getHeaders()),R={...s.M,id:S,payload:{...s.M.payload,headers:L,body:{...s.M.payload.body,data:D.toBase64(null==e?void 0:e.message)}},snippet:(null==e?void 0:e.message.slice(0,100))+((null==e?void 0:null===(n=e.message)||void 0===n?void 0:n.length)>100?"...":""),threadId:Y.threadId,internalDate:Date.now().toString(),labelIds:["DRAFT"]};try{if(C){if(ee(()=>{},{optimisticData:t=>{var l,i,n;if(!(null==t?void 0:null===(l=t.messages)||void 0===l?void 0:l[0])||t.messages[0].threadId!==(null==Y?void 0:Y.threadId))return t;let r=null!==(i=null==t?void 0:t.messages)&&void 0!==i?i:[],o=null!==(n=null==t?void 0:t.decodedMessages)&&void 0!==n?n:[];return{messages:[...r,R],decodedMessages:[...o,null==e?void 0:e.message],historyId:"0"+t.historyId}},populateCache:!1,revalidate:!1}),et(t=>e4(t,e,D,S),{revalidate:!1}),w.rollbackThread){let e={...w.rollbackThread,messages:[...w.rollbackThread.messages,R]},t=(0,N.CF)(e);await (null===(b=e_.db)||void 0===b?void 0:b.put("mail",{...e,...t}))}ez.enqueue({transaction:{type:u.e.CreateDraft,parameters:{resource:{message:{raw:D.asEncoded(),threadId:null==Y?void 0:Y.threadId}}},alias:E,actionTitle:"Draft Saved"},rollbackFn:async()=>{if(eJ.current=!1,et&&et(()=>{},{optimisticData:e=>tt(e,S),revalidate:!0,populateCache:!1}),ee&&ee(()=>{},{optimisticData:e=>te(e,S),revalidate:!1,populateCache:!1}),w.rollbackThread){var e;let t=(0,N.CF)(w.rollbackThread);await (null===(e=e_.db)||void 0===e?void 0:e.put("mail",{...w.rollbackThread,...t}))}},revalidateFn:ee})}else{let t=(0,N.CF)(null!==(y=w.rollbackThread)&&void 0!==y?y:null);if(ee(()=>{},{optimisticData:t=>{var l,i,n,r;if(!(null==t?void 0:null===(l=t.messages)||void 0===l?void 0:l[0])||t.messages[0].threadId!==(null==Y?void 0:Y.threadId))return t;w.historyId=t.historyId;let o=(null==eI?void 0:eI.id)?null==t?void 0:null===(i=t.messages)||void 0===i?void 0:i.findIndex(e=>(null==e?void 0:e.id)===(null==eI?void 0:eI.id)):-1,a=null!==(n=null==t?void 0:t.messages)&&void 0!==n?n:[],d=null!==(r=null==t?void 0:t.decodedMessages)&&void 0!==r?r:[];return o>=0?(a.splice(o,1),d.splice(o,1)):(null==eI?void 0:eI.id)||!ek||(a=[],d=[]),{messages:[...a,R],decodedMessages:[...d,null==e?void 0:e.message],historyId:"0"+t.historyId}},populateCache:!1,revalidate:!1}),et(t=>e8(t,e,D,S,E),{revalidate:!1}),w.rollbackThread){let e={...w.rollbackThread,...t,messages:w.rollbackThread.messages.map(e=>(0,I.Uq)(e,"alias")===E||e.id===w.draftMessageId?{...R,payload:{...R.payload,headers:e.payload.headers}}:e)};await (null===(x=e_.db)||void 0===x?void 0:x.put("mail",e))}ez.enqueue({transaction:{threadId:null==Y?void 0:Y.threadId,draftId:j,type:u.e.EditDraft,createMailBodyProps:A,actionTitle:"Edited Draft",draftMsgHeaderId:T,alias:E},rollbackFn:()=>{var l,i;e7(R,["DRAFT"],null!==(l=w.draftMessageId)&&void 0!==l?l:"",w.historyId,null==e?void 0:e.message),eJ.current=!!w.hasDraftSaved,e9(w.rollbackThread),w.rollbackThread&&(null===(i=e_.db)||void 0===i||i.put("mail",{...w.rollbackThread,...t}))},revalidateFn:ee})}}catch(e){throw console.error(e),e}},ti=async e=>{var t,l,i,n,r,a,d,s,c,v,m,h,f,g,b;let y=ek?Y:eI,x={draftReply:eI,hasDraftSaved:eJ.current,draftMessageId:null==y?void 0:y.id,rollbackThread:(0,p.ZN)(eO.currentThread)},k=(0,I.Uq)(y,"draft-id"),w=(0,I.Uq)(y,"message-id",!1),S=e3(),T={};ek||(T.References=(null==Y?void 0:null===(d=Y.payload)||void 0===d?void 0:null===(a=d.headers)||void 0===a?void 0:null===(r=a.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="message-id"}))||void 0===r?void 0:r.value)+(null!==(g=null==Y?void 0:null===(v=Y.payload)||void 0===v?void 0:null===(c=v.headers)||void 0===c?void 0:null===(s=c.find(e=>"References"===e.name))||void 0===s?void 0:s.value)&&void 0!==g?g:""),T["In-Reply-To"]=null==Y?void 0:null===(f=Y.payload)||void 0===f?void 0:null===(h=f.headers)||void 0===h?void 0:null===(m=h.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="message-id"}))||void 0===m?void 0:m.value),T.alias=S,k.length?T["draft-id"]=k:k=void 0;let j=(0,I.eK)({...e,sender:"".concat(null===(l=eD.userData)||void 0===l?void 0:null===(t=l.user_metadata)||void 0===t?void 0:t.name," <").concat(null===(i=eD.userData)||void 0===i?void 0:i.email,">"),headers:T,addTatemWatermark:!0}),E=j.asEncoded(),M=e5(j.getHeaders()),A={message:{raw:E,threadId:null==Y?void 0:Y.threadId}},D={...y,threadId:null==Y?void 0:Y.threadId,internalDate:Date.now().toString(),labelIds:["SENT"],payload:{...y.payload,headers:M,body:{...y.payload.body,data:j.toBase64(null==e?void 0:e.message)}},snippet:(null==e?void 0:e.message.slice(0,100))+((null==e?void 0:null===(n=e.message)||void 0===n?void 0:n.length)>100?"...":"")};try{let t;if(localStorage.setItem("scrollToMessage","false"),ee(()=>{},{optimisticData:l=>{var i;return(null==l?void 0:null===(i=l.messages)||void 0===i?void 0:i[0])&&l.messages[0].threadId===(null==Y?void 0:Y.threadId)?(t=l.historyId,{...l,messages:[...null==l?void 0:l.messages.slice(0,-1),D],decodedMessages:[...null==l?void 0:l.decodedMessages.slice(0,-1),null==e?void 0:e.message],historyId:"0"+t}):l},populateCache:!1,revalidate:!1}).then(()=>{et(t=>{var l;return e8(t,e,j,null!==(l=x.draftMessageId)&&void 0!==l?l:"",S,!0)},{revalidate:!1})}),x.rollbackThread){let e={...x.rollbackThread,messages:x.rollbackThread.messages.map(e=>(0,I.Uq)(e,"alias")===S||e.id&&e.id===x.draftMessageId?{...D,payload:{...D.payload,headers:e.payload.headers}}:e)},t=(0,N.CF)(e);await (null===(b=e_.db)||void 0===b?void 0:b.put("mail",{...e,...t}))}ez.enqueue({transaction:{type:u.e.SendDraft,parameters:{resource:A},threadId:null==Y?void 0:Y.threadId,draftMsgHeaderId:w,draftId:k,alias:S,actionTitle:o.t.constants.MessageSent.title},rollbackFn:()=>{var l,i,n;if(e7(D,["DRAFT"],null!==(l=x.draftMessageId)&&void 0!==l?l:"",t,null==e?void 0:e.message),eJ.current=!!x.hasDraftSaved,eN(null!==(i=x.draftReply)&&void 0!==i?i:null),e9(x.rollbackThread),eU(e),ef(!0),x.rollbackThread){let e=(0,N.CF)(x.rollbackThread);null===(n=e_.db)||void 0===n||n.put("mail",{...x.rollbackThread,...e})}}})}catch(e){throw console.error(e),e}eN(null),ef(!1),eJ.current=!1,eU(C.ox),eM(o.t.constants.MessageSent)},tn=async()=>{var e;if(ef(!1),!(ek||eI||eJ.current))return;let t=ek?Y:eI,l={draftReply:eI,hasDraftSaved:eJ.current,draftMessageId:null==t?void 0:t.id,rawThreadData:ei,draftEmailData:eP},i=null===(e=document.getElementById("editor-".concat(null==Y?void 0:Y.id)))||void 0===e?void 0:e.innerHTML;i&&l.draftEmailData&&(l.draftEmailData.message=i);let n=(0,I.Uq)(t,"draft-id"),r=e3();n.length||(n=void 0);try{ee(()=>{},{optimisticData:e=>(l.historyId=null==e?void 0:e.historyId,te(e)),populateCache:!1,revalidate:!1}),et(e=>tt(e,r),{revalidate:!1}),ez.enqueue({transaction:{alias:r,type:u.e.DeleteDraft,draftId:n,threadId:null==Y?void 0:Y.threadId,draftMsgHeaderId:(0,I.Uq)(t,"message-id",!1),actionTitle:o.t.constants.DraftDeleted.title},rollbackFn:async()=>{var e,t,i,n,r,o;l.draftReply&&e7(l.draftReply,["DRAFT"],null!==(t=l.draftMessageId)&&void 0!==t?t:"",l.historyId,null!==(i=null===(e=l.draftEmailData)||void 0===e?void 0:e.message)&&void 0!==i?i:""),eJ.current=!!l.hasDraftSaved,eN(null!==(n=l.draftReply)&&void 0!==n?n:null),l.rawThreadData&&e9({...l.rawThreadData,id:null==Y?void 0:Y.threadId,historyId:null!==(r=l.historyId)&&void 0!==r?r:""},!0),eU(null!==(o=l.draftEmailData)&&void 0!==o?o:C.ox),ef(!0)}})}catch(e){console.error(e)}eN(null),eJ.current=!1,eU(C.ox),eM(o.t.constants.DraftDeleted)},tr=async e=>{var t,l,i,n,r,a,d,c,v,m,h,f,g,b,y,x,k,w;let S={rawThreadData:ei,rollbackThread:(0,p.ZN)(eO.currentThread)},T={};T.References=(null==Y?void 0:null===(i=Y.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:null===(t=l.find(e=>"message-id"===e.name.toLowerCase()))||void 0===t?void 0:t.value)+(null!==(x=null==Y?void 0:null===(a=Y.payload)||void 0===a?void 0:null===(r=a.headers)||void 0===r?void 0:null===(n=r.find(e=>"References"===e.name))||void 0===n?void 0:n.value)&&void 0!==x?x:""),T["In-Reply-To"]=null==Y?void 0:null===(v=Y.payload)||void 0===v?void 0:null===(c=v.headers)||void 0===c?void 0:null===(d=c.find(e=>"message-id"===e.name.toLowerCase()))||void 0===d?void 0:d.value;let j=(0,I.eK)({...e,sender:"".concat(null===(h=eD.userData)||void 0===h?void 0:null===(m=h.user_metadata)||void 0===m?void 0:m.name," <").concat(null===(f=eD.userData)||void 0===f?void 0:f.email,">"),headers:T,addTatemWatermark:!0}),E={raw:j.asEncoded(),threadId:null==Y?void 0:Y.threadId},M=e5(j.getHeaders()),A="swr-"+window.crypto.randomUUID(),D={...s.M,id:A,payload:{...s.M.payload,headers:M,body:{...s.M.payload.body,data:j.toBase64(null==e?void 0:e.message)}},snippet:(null==e?void 0:e.message.slice(0,100))+((null==e?void 0:null===(g=e.message)||void 0===g?void 0:g.length)>100?"...":""),threadId:null==ei?void 0:null===(y=ei.messages)||void 0===y?void 0:null===(b=y.at(0))||void 0===b?void 0:b.threadId,internalDate:Date.now().toString(),labelIds:["SENT"]};el({messages:[...null==ei?void 0:ei.messages.filter(e=>e.id!==(null==eI?void 0:eI.id)),D],decodedMessages:[...null!==(k=null==ei?void 0:ei.decodedMessages)&&void 0!==k?k:[],null==e?void 0:e.message]});try{if(S.rollbackThread){let e={...S.rollbackThread,messages:[...S.rollbackThread.messages,D]},t=(0,N.CF)(e);await (null===(w=e_.db)||void 0===w?void 0:w.put("mail",{...e,...t}))}ee(()=>{},{populateCache:!1,revalidate:e.attachments.length>0}),ez.enqueue({transaction:{type:u.e.SendMail,parameters:{resource:E},messageId:A,actionTitle:o.t.constants.MessageSent.title},rollbackFn:()=>{if(S.rollbackThread){var t;let e=(0,N.CF)(S.rollbackThread);null===(t=e_.db)||void 0===t||t.put("mail",{...S.rollbackThread,...e})}eu(!0),eU(e),ef(!0),el(S.rawThreadData)}})}catch(e){throw console.error(e),e}eJ.current=!1,eu(!1),ef(!1),eU(C.ox),eM(o.t.constants.MessageSent)};(0,g.useEffect)(()=>{var e,t;er&&(eu(!0),(null==ec?void 0:ec.id)===(null==Y?void 0:Y.threadId)?(ev({id:null==Y?void 0:Y.threadId,current:!1}),setTimeout(()=>{ev({id:null==Y?void 0:Y.threadId,current:!0})},1)):ev({id:null==Y?void 0:Y.threadId,current:!0}));let l=null===(e=document)||void 0===e?void 0:e.getElementById("message-body-"+(null==Y?void 0:Y.id));ex((null!==(t=null==l?void 0:l.clientHeight)&&void 0!==t?t:0)-64)},[$]),(0,g.useEffect)(()=>{let e=(0,p.U5)(()=>eA.isDarkMode,e=>{er&&(eu(!1),setTimeout(()=>{eu(!0)},10))});return()=>{e()}},[]),(0,g.useEffect)(()=>{eu(er)},[er]);let to=()=>{let e=document.getElementById("reply-modal-"+(null==Y?void 0:Y.id));if(e){var t,l,i;let n=null===(t=e.getBoundingClientRect())||void 0===t?void 0:t.top;null===(i=document)||void 0===i||null===(l=i.getElementById("main-page"))||void 0===l||l.scrollBy({top:n-180,behavior:"instant"})}},ta=e=>{var t;eU({...C.ox,...e,threadId:null==Y?void 0:Y.threadId,messageId:null==Y?void 0:Y.id,type:null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"reply"}),eE(eT()),ef(!0),setTimeout(()=>{to()},0),setTimeout(()=>{window.location.pathname.includes("/thread/")&&eC.replace(eS,{scroll:!1})},800)},td=e=>{null===e.relatedTarget&&eb(!1)},ts=()=>{var e,t,l,i,n,r,o,a,d;eq(!1),null===(t=document)||void 0===t||null===(e=t.activeElement)||void 0===e||e.blur();let s=null!==(d=ek?null===(l=document.querySelector(".editor"))||void 0===l?void 0:l.innerHTML:null===(i=document.getElementById("editor-"+(null==Y?void 0:Y.id)))||void 0===i?void 0:i.innerHTML)&&void 0!==d?d:"",u=!(null==s?void 0:null===(n=s.replace(/<[^>]*>/g,""))||void 0===n?void 0:n.replace(/---------- Forwarded Message ----------.*$/gi,"").length);(null==eP?void 0:eP.type)==="forward"&&((null==eP?void 0:null===(r=eP.recipient)||void 0===r?void 0:r.length)||(null==eP?void 0:null===(o=eP.cc)||void 0===o?void 0:o.length)||(null==eP?void 0:null===(a=eP.bcc)||void 0===a?void 0:a.length))||!u||eI||ek||eJ.current||ef(!1)};(0,g.useEffect)(()=>{var e,t,l,i,n,r;if(ek)return;let o=eI?(null==eI?void 0:null===(i=eI.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:null===(t=l.find(e=>"Subject"===e.name))||void 0===t?void 0:null===(e=t.value)||void 0===e?void 0:e.includes("Fwd: "))?"forward":"reply":null,a=ew.has("forward")?"forward":ew.has("reply")?"reply":o,d=eo&&(ew.has("forward")||ew.has("reply")),s=!!(null==eI?void 0:eI.threadId)&&(null==eI?void 0:eI.threadId)!==(null==eP?void 0:eP.threadId),u=!!(null==eI?void 0:eI.id)&&(null==eI?void 0:eI.id)!==(null==eP?void 0:eP.messageId)&&!eJ.current;if((s||u)&&(!d||o===a))d&&(eV.current=!0),s&&(eJ.current=!1,eU(C.ox)),e6(eI),ef(!0),eR.setCurrentIndex([1,null!=en?en:0]),eE(eT()),d&&setTimeout(()=>{eC.replace(eS,{scroll:!1})},800);else if(d&&o!==a){let e=ew.get("reply"),t=ew.get("forward");e&&(e===(null==Y?void 0:Y.id)||e===(null==eI?void 0:eI.id))?(eV.current=!0,ta({recipient:R(Y,null!==(r=null===(n=eD.userData)||void 0===n?void 0:n.email)&&void 0!==r?r:""),subject:F(e2)})):t&&(t===(null==Y?void 0:Y.id)||t===(null==eI?void 0:eI.id))&&$&&(eV.current=!0,ta({forwardedMessage:$,subject:"Fwd: "+e2,type:"forward"}))}else eh&&!eI&&eP.threadId!==(null==Y?void 0:Y.threadId)&&(eJ.current=!1,eU(C.ox),ef(!1))},[$,null==eI?void 0:eI.threadId,ek,null==eI?void 0:eI.id]),(0,g.useEffect)(()=>{if(eH){let e=e=>{var t,l,i,r,o,a,d,s,u,c,v,m,p,h,f,g,b,y;if(!(S.Oh.includes(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.tagName)||(null===(l=e.target.className)||void 0===l?void 0:l.includes("editor")))&&!e.repeat)switch((null===(i=e.key)||void 0===i?void 0:i.length)===1?e.key.toLowerCase():e.key){case"r":if((0,S.SE)(e)||e.shiftKey)break;e.preventDefault(),es?null===(r=document.getElementById("reply-button-"+(null==Y?void 0:Y.id)))||void 0===r||r.click():(eu(!0),setTimeout(()=>{var e;null===(e=document.getElementById("reply-button-"+(null==Y?void 0:Y.id)))||void 0===e||e.click()},200));break;case"Enter":if(eh||ek||(null===(a=document)||void 0===a?void 0:null===(o=a.activeElement)||void 0===o?void 0:o.tagName)==="BUTTON"||(null===(s=document)||void 0===s?void 0:null===(d=s.activeElement)||void 0===d?void 0:d.tagName)==="A")e.preventDefault(),to(),(0,n.pk)(!!(null==eP?void 0:null===(u=eP.recipient)||void 0===u?void 0:u.length),null==Y?void 0:Y.id,ek);else{eu(!0);let t=document.getElementById("reply-all-button-"+(null==Y?void 0:Y.id));t&&(setTimeout(()=>{t.click()},200),e.preventDefault())}break;case"o":if(eh)return;if(e.shiftKey){if((0,S.xN)(e)){if(e.altKey){e.preventDefault();let t=document.querySelectorAll('button[id^="open-message-button"]:not(.hidden)'),l=e=>Array.from(t).every(t=>t.getAttribute("data-state-open")===e),i=l("true"),n=l("false");t.forEach(e=>{(i||n||"false"===e.getAttribute("data-state-open"))&&e.click()})}else(0,S.SE)(e)&&(e.preventDefault(),ep(e=>!e))}else e.preventDefault(),er||eu(e=>!e)}else if(e.preventDefault(),er){let e=document.getElementById("expand-button-"+(null==Y?void 0:Y.id));e&&(null==e||e.click())}else es&&document.getElementById("expand-button-"+(null==Y?void 0:Y.id))?null===(c=document.getElementById("expand-button-"+(null==Y?void 0:Y.id)))||void 0===c||c.click():null===(v=document.getElementById("open-message-button-"+(null==Y?void 0:Y.id)))||void 0===v||v.click();break;case"\xf8":if(!eh&&e.shiftKey&&e.altKey){e.preventDefault();let t=document.querySelectorAll('button[id^="open-message-button"]:not(.hidden)'),l=e=>Array.from(t).every(t=>t.getAttribute("data-state-open")===e),i=l("true"),n=l("false");t.forEach(e=>{(i||n||"false"===e.getAttribute("data-state-open"))&&e.click()})}break;case"Tab":if(!eh&&(null===(p=document)||void 0===p?void 0:null===(m=p.activeElement)||void 0===m?void 0:m.tagName)==="BODY"&&!eg){let t=null===(h=document.getElementsByClassName("email-body"))||void 0===h?void 0:h[0],l=null==t?void 0:null===(f=t.shadowRoot)||void 0===f?void 0:f.querySelectorAll("a, button");l&&(null==l?void 0:l.length)>0&&(null==l||null===(g=l[0])||void 0===g||g.focus(),e.preventDefault(),eb(!0))}setTimeout(()=>{var e,t;(null===(e=document.activeElement)||void 0===e?void 0:e.tagName)==="BODY"&&(null===(t=document.getElementById("escape-button"))||void 0===t||t.focus())},10);break;case"Escape":!er&&!eh&&document.getElementById("reply-all-button-"+(null==Y?void 0:Y.id))&&!eI?(e.stopPropagation(),eu(!1)):eH&&(null===(b=document.getElementById("escape-button"))||void 0===b||b.click());break;case"f":if((0,S.SE)(e)||e.shiftKey)break;e.preventDefault(),es?null===(y=document.getElementById("forward-button-"+(null==Y?void 0:Y.id)))||void 0===y||y.click():(eu(!0),setTimeout(()=>{var e;null===(e=document.getElementById("forward-button-"+(null==Y?void 0:Y.id)))||void 0===e||e.click()},200))}};return window.addEventListener("keydown",e),window.addEventListener("focusout",td),()=>{window.removeEventListener("keydown",e),window.removeEventListener("focusout",td)}}},[ek,eH,eg,eh,null==Y?void 0:Y.id,es,null==eP?void 0:eP.type,!eI,!(null==eP?void 0:null===(v=eP.recipient)||void 0===v?void 0:v.length)]),(0,g.useEffect)(()=>{var e;!eh&&!eI&&((null==eP?void 0:null===(e=eP.recipient)||void 0===e?void 0:e.length)||(null==eP?void 0:eP.subject))&&eU(C.ox)},[eh]),(0,g.useEffect)(()=>{eN(ea)},[ea]),(0,g.useEffect)(()=>{let e=!!(null==Y?void 0:Y.threadId)&&(null==Y?void 0:Y.threadId)!==(null==eP?void 0:eP.threadId),t=!!(null==Y?void 0:Y.id)&&(null==Y?void 0:Y.id)!==(null==eP?void 0:eP.messageId)&&!eJ.current;ek&&(null==eL?void 0:eL.gapiInitialized)&&(e||t)&&(e&&(eJ.current=!1,eU(C.ox)),e6(Y),eE(eT()))},[ek,null==eL?void 0:eL.gapiInitialized,null==Y?void 0:Y.threadId,null==Y?void 0:Y.id]);let tu=e=>{var t,l,i,r,o,a,d,s,u,c,v;eR.setCurrentIndex([1,null!=en?en:0]);let m="forward"!==e?R(Y,null!==(u=null===(t=eD.userData)||void 0===t?void 0:t.email)&&void 0!==u?u:"").replaceAll('"',""):[],p="replyAll"===e?O(eY+", "+eZ+", "+eQ,[null===(l=eD.userData)||void 0===l?void 0:l.email,...null==m?void 0:m.split(", ")]):[],h="forward"===e?"Fwd: "+(null==Y?void 0:null===(o=Y.payload)||void 0===o?void 0:null===(r=o.headers)||void 0===r?void 0:null===(i=r.find(e=>"Subject"===e.name))||void 0===i?void 0:i.value):F(null!==(c=null==Y?void 0:null===(s=Y.payload)||void 0===s?void 0:null===(d=s.headers)||void 0===d?void 0:null===(a=d.find(e=>"Subject"===e.name))||void 0===a?void 0:a.value)&&void 0!==c?c:"");eh&&eP.type===e||eU({...C.ox,recipient:m,cc:p,type:e,threadId:null==Y?void 0:Y.threadId,messageId:null==Y?void 0:Y.id,attachments:"forward"===e&&null!=e1?e1:[],forwardedMessage:"forward"===e?$:"",subject:h}),eh?eP.type!==e?((0,n.pk)(e.includes("reply"),null==Y?void 0:Y.id),to()):eK?ts():(0,n.pk)(!!(null===(v=eP.recipient)||void 0===v?void 0:v.length),null==Y?void 0:Y.id):(eV.current=!0,setTimeout(()=>{to()},10),ef(!0),(0,n.pk)(e.includes("reply"),null==Y?void 0:Y.id))};return((0,g.useEffect)(()=>{ep(!1)},[eS]),(0,g.useEffect)(()=>{if(eH){let e=(0,I.Uq)(Y,"from",!1);eB.setCurrentFocusedContact({name:(0,I.Kc)(e),emailAddress:(0,I.e6)(e),sourceType:"manual"})}},[eR.currentIndex[1],eH]),ek)?(0,i.jsx)(c.fC,{modal:!1,children:(0,i.jsx)(c.VY,{forceMount:!0,id:"draft-compose-body",className:"relative col-span-2 w-full rounded-lg bg-white p-1 py-6 shadow-closed focus-within:shadow-open dark:bg-base-dark md:col-span-1 md:col-start-2 md:px-3",onOpenAutoFocus:e=>{e.preventDefault()},onEscapeKeyDown:e=>{var t;let l=null==e?void 0:e.target,i=document.getElementById("rich-text-menu-link-input"),n=!!document.querySelector(".rte-modal");if(i||n){e.preventDefault();return}((null==l?void 0:l.tagName)==="INPUT"||(null==l?void 0:l.tagName)==="TEXTAREA"||(null==l?void 0:null===(t=l.className)||void 0===t?void 0:t.includes("editor")))&&ts()},onKeyDown:e=>{var t,l,i,n,r;switch((null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key){case"Enter":if((0,S.SE)(e)&&!e.shiftKey){e.preventDefault();let t=document.getElementById("compose-submit-".concat(null==Y?void 0:Y.id));t&&t.click()}break;case"a":(0,S.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(i=document)||void 0===i||null===(l=i.getElementById("attachment-button-".concat(null==Y?void 0:Y.id)))||void 0===l||l.click());break;case"b":(0,S.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(r=document)||void 0===r||null===(n=r.getElementById("show-cc-button-".concat(null==Y?void 0:Y.id)))||void 0===n||n.click())}},children:(0,i.jsx)("div",{className:"relative flex h-full min-h-[480px] flex-col",children:(0,i.jsx)(n.NL,{saveDraft:(e,t)=>tl({...e,message:t}),emailData:eP,setEmailData:eU,doesFocusOnMount:eV.current,sendMail:ti,initialEmailData:eP,messageId:null==Y?void 0:Y.threadId,exitFn:()=>{eJ.current=!1,eU(C.ox),tn(),"SEARCH"===eF.currentLabel?eC.back():eC.push(eX+"/drafts")},exitText:"Discard"})},ej)})}):(0,i.jsxs)(i.Fragment,{children:[es?(0,i.jsx)("div",{className:"relative col-start-1 ml-auto hidden md:block",children:(0,i.jsx)("div",{className:"sticky z-10 col-start-1 mb-auto ml-auto flex shrink-0 flex-col gap-1 rounded-lg p-1 shadow-[0px_1.5px_10px_0px_rgba(0,0,0,0.03),0px_1px_4px_0px_rgba(0,0,0,0.08),0px_0px_1px_0.5px_rgba(0,0,0,0.05)] dark:bg-fill-dark-base dark:shadow-control-dark",style:{top:(null!==(X=null===(h=document.getElementById("thread-subject"))||void 0===h?void 0:h.clientHeight)&&void 0!==X?X:56)+60},children:(0,i.jsx)(z,{emailData:eP,setReplyModal:tu,isEditorFocused:eK,message:Y,isReplyOpen:eh})})}):null,(0,i.jsxs)("div",{className:m()("group/message relative col-span-2 mx-auto flex w-full max-w-[calc(100vw-32px)] flex-col rounded-lg sm:max-w-[calc(100vw-96px)] md:col-span-1 md:col-start-2 md:ml-0","before:absolute before:-inset-1 before:z-[-1] before:rounded-xl before:border-0.5",es?{"before:border-transparent before:shadow-open before:dark:shadow-control-dark":!eH,"shadow-open before:border-border-secondary before:bg-fill-primary dark:shadow-control-dark dark:before:border-border-dark-secondary dark:before:bg-fill-dark-primary":eH,"m-1 bg-base dark:bg-base-dark-opaque":!0}:{"bg-transparent before:border-transparent hover:shadow-[0px_1.5px_10px_0px_rgba(0,0,0,0.03),0px_1px_4px_0px_rgba(0,0,0,0.08),0px_0px_1px_0.5px_rgba(0,0,0,0.05)] dark:hover:shadow-control-dark":!eH,"bg-base shadow-open before:border-border-secondary before:bg-fill-primary dark:bg-base-dark-opaque dark:shadow-control-dark before:dark:border-border-dark-secondary before:dark:bg-fill-dark-primary":eH,"before:-inset-1":!0}),id:"message-body-"+(null==Y?void 0:Y.id),children:[(0,i.jsxs)("div",{className:m()("relative flex w-full flex-col gap-3 rounded-t-lg px-5 md:px-8",{"bg-fill-primary dark:bg-fill-dark-primary":eK&&(eh||!!eI)},{"py-2":es,"py-3":!es}),id:"message-content-"+(null==Y?void 0:Y.id),children:[(0,i.jsxs)("div",{className:(em?"gap-3":"gap-0")+" relative flex flex-col text-body text-secondary duration-100 dark:text-secondary-dark",children:[(0,i.jsx)("button",{id:"open-message-button-".concat(null==Y?void 0:Y.id),className:m()("outline-none",{hidden:er,"absolute -inset-8 -bottom-3 -top-3":!er,"z-[2]":!es}),disabled:er,onClick:()=>{ep(!1),eu(e=>!e),eR.setCurrentIndex([1,null!=Z?Z:0])},"data-state-open":es}),(0,i.jsxs)("div",{className:"relative flex w-full items-center justify-between gap-10 duration-300",children:[(0,i.jsxs)("div",{className:m()("relative flex h-7 min-w-0 items-center gap-2",{"group w-full":es,"z-0 w-[168px] shrink-0 sm:w-auto sm:min-w-[168px]":!es}),children:[(0,i.jsxs)("div",{className:"flex h-full max-w-[calc(100%-40px)] shrink flex-row items-center",children:[(0,i.jsxs)("div",{className:m()("relative w-fit",es?"max-w-[calc(100%-40px)]":"max-w-full"),children:[(0,i.jsx)("div",{className:m()("flex h-full w-fit items-center text-left text-body font-medium md:whitespace-nowrap",{"max-w-[150px] cursor-pointer":!es},{"text-secondary group-hover/message:text-primary dark:text-secondary-dark dark:group-hover/message:text-primary-dark":!es&&!eH},{"peer z-[1] max-w-full cursor-default text-primary dark:text-primary-dark":es},{"text-primary dark:text-primary-dark":eH}),children:(0,i.jsx)("span",{className:"truncate",children:(null===(E=eD.userData)||void 0===E?void 0:E.email)&&(null==eQ?void 0:null===(D=eQ.toLowerCase())||void 0===D?void 0:D.includes(eD.userData.email.toLowerCase()))?"Me":null==eQ?void 0:null===(_=eQ.split(" <")[0])||void 0===_?void 0:null===(B=_.replaceAll("<",""))||void 0===B?void 0:B.replaceAll(">","")})}),(0,i.jsx)(x.M,{title:eQ,position:"top-6 -left-2"})]}),es&&(null===(H=e0.split(","))||void 0===H?void 0:H.length)>0&&(0,i.jsxs)("div",{className:"inline-flex items-center pl-1 font-medium text-primary dark:text-primary-dark",children:["to",[...e0.split(",")].map((e,t)=>{var l,n,r,o,a,d,s,u,c,v,p,h;let f=(0,I.Kc)(e),g=e.includes(null!==(h=null===(l=eD.userData)||void 0===l?void 0:l.email)&&void 0!==h?h:"")?"Me":f,b=e0.split(","),y=(null==eQ?void 0:null===(o=eQ.split(" <")[0])||void 0===o?void 0:null===(r=o.replaceAll("<",""))||void 0===r?void 0:null===(n=r.replaceAll(">",""))||void 0===n?void 0:n.length)+(null===(s=b.slice(0,t))||void 0===s?void 0:null===(d=s.map(e=>{var t,l;return e.includes(null!==(l=null===(t=eD.userData)||void 0===t?void 0:t.email)&&void 0!==l?l:"")?"Me":(0,I.Kc)(e)}))||void 0===d?void 0:null===(a=d.join(", "))||void 0===a?void 0:a.length),k=Math.min(500,(null===(u=window)||void 0===u?void 0:u.innerWidth)-340)-6.5*y,w=k<6.5*g.length?(null==g?void 0:null===(v=g.trim())||void 0===v?void 0:null===(c=v.split(" "))||void 0===c?void 0:c.at(0))+"...":g;return(0,i.jsxs)("div",{className:m()("inline-flex",{"opacity-0":k<10}),style:{maxWidth:"".concat(Math.max(0,k),"px")},children:[t>0&&",",t>2&&t===(null==e0?void 0:null===(p=e0.split(","))||void 0===p?void 0:p.length)-1&&" & ",(0,i.jsxs)("div",{className:"relative ml-1 min-w-0 shrink",children:[(0,i.jsx)("div",{className:"peer min-w-0 shrink truncate",children:w}),(0,i.jsx)(x.M,{title:e,position:"top-6 -left-2 font-normal"})]})]},e)})]})]}),es&&(0,i.jsxs)("div",{className:"hover:z-10 md:relative",children:[(0,i.jsx)(k.z,{className:es?"peer":"hidden",variant:"tertiary",size:"md",icon:em?w.N.ContractLarge:w.N.ExpandLarge,onClick:e=>{es?(e.stopPropagation(),ep(e=>!e)):eu(!0)}}),(0,i.jsx)(x.M,{title:em?T.Wz.HideMessageDetails.title:T.Wz.ShowMessageDetails.title,position:"top-8 md:left-1/2 md:-translate-x-20 left-0",keys:T.Wz.HideMessageDetails.keys})]})]}),!es&&(0,i.jsx)("span",{className:"mr-auto max-h-[16px] max-w-full shrink text-body "+((0,b.Iz)(null==Y?void 0:Y.snippet)?" overflow-hidden":" truncate")+(eH?" text-primary dark:text-primary-dark":" text-secondary group-hover/message:text-primary dark:text-secondary-dark dark:group-hover/message:text-primary-dark"),dangerouslySetInnerHTML:{__html:null==Y?void 0:Y.snippet}}),(0,i.jsxs)("div",{className:m()("relative flex h-full flex-row-reverse items-center gap-3",{group:es,"z-[-1]":!es&&!eH}),children:[(0,i.jsx)("div",{className:m()("flex h-full items-center whitespace-nowrap text-right text-tertiary hover:text-secondary dark:text-tertiary-dark dark:hover:text-secondary-dark",{"peer cursor-default":es},{"cursor-pointer":!es}),children:ed?(0,I.AK)(ed):""}),(0,i.jsx)(x.M,{title:ed.toLocaleString("en-us",L).replace(/(,)(?!.*\1)/," at"),position:"top-8 right-0 md:right-1/2 md:translate-x-20"})]})]}),(0,i.jsx)("div",{className:(em?"hover:overflow-visible":"")+" z-[2] overflow-hidden rounded bg-fill-primary text-body transition-[max-height] duration-100 dark:bg-fill-dark-primary",style:{maxHeight:em?"".concat(null!==(G=null==eG?void 0:null===(P=eG.current)||void 0===P?void 0:P.clientHeight)&&void 0!==G?G:32,"px"):0,transitionDuration:"".concat(Math.max(100,Math.abs(null!==(Q=null==eG?void 0:null===(U=eG.current)||void 0===U?void 0:U.clientHeight)&&void 0!==Q?Q:0)),"ms")},children:(0,i.jsxs)("div",{className:"flex flex-col gap-2 px-3 py-2",ref:eG,children:[(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(d.l,{onClick:()=>{let e=(0,I.e6)(eQ);window.navigator.clipboard.writeText(e),eM(o.t.lambdas.SenderAddressCopied({primaryText:e}))},tooltip:{title:T.Wz.CopyAllSenderAddresses.title,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"flex w-10 shrink-0 cursor-pointer justify-start text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:"From"})}),(0,i.jsx)("div",{children:(0,i.jsx)(M,{contact:eQ,userEmail:null===(W=eD.userData)||void 0===W?void 0:W.email,type:"from"})})]}),eZ&&!!eZ.includes("@")&&(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(d.l,{onClick:()=>{let e=(0,I.Ep)(eZ);window.navigator.clipboard.writeText(e.join(", ")),eM(o.t.lambdas.RecipientAddressCopied({primaryText:1===e.length?e[0]:"",count:e.length}))},tooltip:{...T.Wz.CopyAllRecipientAddresses,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"flex w-10 shrink-0 cursor-pointer justify-start text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:"To"})}),(0,i.jsx)("div",{children:(0,i.jsx)(M,{contact:eZ,userEmail:null===(q=eD.userData)||void 0===q?void 0:q.email,type:"to"})})]}),eY&&(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(d.l,{onClick:()=>{let e=(0,I.Ep)(eY);window.navigator.clipboard.writeText(e.join(", ")),eM(o.t.lambdas.RecipientAddressCopied({primaryText:1===e.length?e[0]:"",count:e.length}))},tooltip:{title:T.Wz.CopyAllRecipientAddresses.title,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"flex w-10 shrink-0 cursor-pointer justify-start text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:"Cc"})}),(0,i.jsx)("div",{className:"flex max-w-[calc(100%-80px)] flex-wrap items-center justify-start",children:(0,i.jsx)(M,{contact:eY,userEmail:null===(K=eD.userData)||void 0===K?void 0:K.email,type:"cc"})})]}),e$&&(0,i.jsxs)("div",{className:"flex items-start gap-1.5",children:[(0,i.jsx)(d.l,{onClick:()=>{let e=(0,I.Ep)(e$);window.navigator.clipboard.writeText(e.join(", ")),eM(o.t.lambdas.RecipientAddressCopied({primaryText:1===e.length?e[0]:"",count:e.length}))},tooltip:{title:T.Wz.CopyAllRecipientAddresses.title,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"flex w-10 shrink-0 cursor-pointer justify-start text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:"Bcc"})}),(0,i.jsx)("div",{children:(0,i.jsx)(M,{contact:e$,userEmail:null===(V=eD.userData)||void 0===V?void 0:V.email,type:"bcc"})})]}),(0,i.jsx)("div",{className:"flex items-start justify-between",children:(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,i.jsx)(d.l,{onClick:()=>{let e=ed.toLocaleString("en-us",{...L,weekday:"long",month:"long"});window.navigator.clipboard.writeText(e),eM(o.t.lambdas.DateCopied({primaryText:e}))},tooltip:{...T.Wz.CopyDateReceived,position:"top-5 -left-2"},children:(0,i.jsx)("span",{className:"flex w-10 shrink-0 cursor-pointer justify-start text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:"Date"})}),(0,i.jsx)(d.l,{onClick:()=>{let e=ed.toLocaleString("en-us",{...L,weekday:"long",month:"long"});window.navigator.clipboard.writeText(e),eM(o.t.lambdas.DateCopied({primaryText:e}))},tooltip:{...T.Wz.CopyDateReceived,position:"top-5 -left-2"},children:(0,i.jsx)("div",{className:"text-left text-secondary group-hover/ctc:text-primary dark:text-secondary-dark dark:group-hover/ctc:text-primary-dark",children:ed.toLocaleString("en-us",{...L,weekday:"long",month:"long"})})})]})})]})})]}),es&&(0,i.jsxs)(i.Fragment,{children:[$&&(null==ec?void 0:ec.current)&&(null==Y?void 0:Y.threadId)===(null===(J=eO.currentThread)||void 0===J?void 0:J.id)?(0,i.jsx)(A.n,{id:null==Y?void 0:Y.id,children:(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:$}})}):(0,i.jsx)("div",{style:{height:$?ey:36}}),!!e1&&(null==e1?void 0:e1.length)>0&&(0,i.jsx)("div",{className:"flex w-full flex-wrap items-center justify-start gap-3 text-xs text-secondary hover:text-primary dark:text-secondary-dark dark:hover:text-primary-dark",children:e1.map(e=>(0,i.jsx)(y.y_,{part:e,message:Y},e.partId))},Y.threadId),es&&!!$&&(0,i.jsx)("div",{className:"sticky bottom-[max(calc(env(safe-area-inset-bottom)_+_20px),_20px)] z-10 mx-auto -mt-3 flex items-center justify-center gap-1 rounded-md bg-base p-1 shadow-open backdrop-blur-menu dark:bg-base-dark dark:shadow-control-dark md:hidden",children:(0,i.jsx)(z,{emailData:eP,setReplyModal:tu,isEditorFocused:eK,message:Y,isReplyOpen:eh})})]})]}),(0,i.jsx)("div",{className:m()((eh||eI?"max-height-anim-instant peer":"max-h-0 overflow-hidden")+" scroll-mt-32",{"max-height-anim-instant":((null==ew?void 0:ew.has("forward"))||(null==ew?void 0:ew.has("reply")))&&(eh||!!eI)}),id:"reply-modal-"+(null==Y?void 0:Y.id),children:(0,i.jsxs)("div",{className:"relative flex min-h-[400px] w-full flex-col border-t border-black/[.08] py-6 dark:border-white/[.08] md:px-3",onFocus:()=>{eq(!0)},onBlur:e=>{var t,l;(null==Y?void 0:Y.id)&&(null===(l=e.relatedTarget)||void 0===l?void 0:null===(t=l.id)||void 0===t?void 0:t.includes(null==Y?void 0:Y.id))||(eV.current=!1,eq(!1))},onKeyDown:e=>{var t,l,i,n,r;switch((null===(t=e.key)||void 0===t?void 0:t.length)===1?e.key.toLowerCase():e.key){case"Escape":let o=document.getElementById("rich-text-menu-link-input"),a=!!document.querySelector(".rte-modal");if(o||a){e.preventDefault();return}eK?(e.preventDefault(),ts()):(er||eI)&&e.preventDefault();break;case"Enter":if((0,S.SE)(e)&&!e.shiftKey){e.preventDefault();let t=document.getElementById("compose-submit-".concat(null==Y?void 0:Y.id));t&&t.click()}break;case"a":(0,S.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(i=document)||void 0===i||null===(l=i.getElementById("attachment-button-".concat(null==Y?void 0:Y.id)))||void 0===l||l.click());break;case"b":(0,S.SE)(e)&&e.shiftKey&&(e.preventDefault(),null===(r=document)||void 0===r||null===(n=r.getElementById("show-cc-button-".concat(null==Y?void 0:Y.id)))||void 0===n||n.click())}},children:[(0,i.jsx)("div",{className:"flex h-7 items-center justify-start px-5",children:(0,i.jsx)("span",{className:"text-body font-normal text-purple-500 dark:text-purple-dark-500",children:"Draft"})}),(0,i.jsx)(n.NL,{saveDraft:(e,t)=>tl({...e,message:t}),emailData:eP,setEmailData:eU,doesFocusOnMount:eV.current,sendMail:eI||eJ.current||ek?ti:tr,open:eh,initialEmailData:eP,exitFn:()=>{eJ.current=!1,eU(C.ox),tn()},exitText:"Discard",originalMessage:{...Y,dateRecieved:ed,html:$,draft:eI},messageId:null==Y?void 0:Y.id})]},ej)})]})]})}),z=(0,h.Pi)(e=>{var t,l;let{message:n,isReplyOpen:o,isEditorFocused:d,emailData:s,setReplyModal:u}=e,{supabaseStore:c,commandMenuStore:v}=(0,a.m)(),m=(null==D?void 0:null===(t=D.env)||void 0===t?void 0:"production")==="development"||(null==D?void 0:null===(l=D.env)||void 0===l?void 0:"production")==="preview",p=(0,r.e)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(k.z,{icon:w.N.Reply,variant:"tertiary",id:"reply-button-"+(null==n?void 0:n.id),className:"peer"+("reply"===s.type&&o&&d?" bg-fill-primary hover:bg-fill-secondary dark:bg-fill-dark-primary dark:hover:bg-fill-dark-secondary":""),onClick:()=>u("reply")}),(0,i.jsx)(x.M,{...T.Wz.Reply,position:"top-10 left-1/2 -translate-x-10 md:translate-x-0 md:top-0 md:left-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(k.z,{icon:w.N.ReplyAll,variant:"tertiary",id:"reply-all-button-"+(null==n?void 0:n.id),className:"peer"+("replyAll"===s.type&&o&&d?" bg-fill-primary hover:bg-fill-secondary dark:bg-fill-dark-primary dark:hover:bg-fill-dark-secondary":""),onClick:()=>u("replyAll")}),(0,i.jsx)(x.M,{...T.Wz.ReplyAll,position:"top-10 left-1/2 -translate-x-10 md:translate-x-0 md:top-0 md:left-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(k.z,{icon:w.N.Forward,variant:"tertiary",id:"forward-button-"+(null==n?void 0:n.id),className:"peer"+("forward"===s.type&&o&&d?" bg-fill-primary hover:bg-fill-secondary dark:bg-fill-dark-primary dark:hover:bg-fill-dark-secondary":""),onClick:()=>u("forward")}),(0,i.jsx)(x.M,{...T.Wz.Forward,position:"top-10 left-1/2 -translate-x-10 md:translate-x-0 md:top-0 md:left-10"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(k.z,{onClick:()=>{v.setCommandMenuOpen(!0)},icon:w.N.Command,variant:"tertiary",className:"peer"}),(0,i.jsx)(x.M,{...T.Wz.OpenCommandMenu,position:"top-10 -right-10 md:right-auto md:top-0 md:left-10"})]}),m&&(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(k.z,{onClick:async()=>{var e;await p.from("test-mail").upsert({id:null==n?void 0:n.id,user_id:null===(e=c.userData)||void 0===e?void 0:e.id,data:n})},icon:w.N.Switch_App,variant:"tertiary",className:"peer"}),(0,i.jsx)(x.M,{title:"(STAGING ONLY) Save email for Review",position:"top-10 -right-10 md:right-auto md:top-0 md:left-10"})]})]})})},27406:function(e,t,l){"use strict";l.d(t,{n:function(){return b}});var i=l(44003),n=l(3984),r=l(61808),o=l.n(r),a=l(1394),d=l(62516),s=l(63372),u=l(39359),c=l(50026),v=l(81243),m=l(70137);l(59613);let p=e=>{let t=null==e?void 0:e.match(/[+-]?(\d*\.)?\d+/g),l=null==t?void 0:t[3],i=t?(0,v.pV)(Number(t[0]),Number(t[1]),Number(t[2])):void 0,n=i&&i[1]>90?.5*i[1]:null==i?void 0:i[1],r=i&&100-i[2],o=i&&(0,v.aw)(i[0],null!=n?n:50,null!=r?r:50);return o?"rgb".concat(l?"a":"","(").concat(Math.round(o.r),", ").concat(Math.round(o.g),", ").concat(Math.round(o.b)).concat(l?", "+l:"",")"):e},h=(e,t)=>{e&&e.getAttribute("data-theme")!==(t?"dark":"light")&&(e.setAttribute("data-theme",t?"dark":"light"),e.querySelectorAll("[style]:not([bgcolor])").forEach(e=>{let l=e.style.color;if(e.textContent&&l){var i,n,r,o,a;let d=window.getComputedStyle(e).backgroundColor,s=null!==(r=e.closest("[bgcolor]"))&&void 0!==r?r:e,u="rgba(0, 0, 0, 0)"===d?window.getComputedStyle(s).backgroundColor:d,c="rgba(0, 0, 0, 0)"===u?t?"rgb(0, 0, 0)":"rgb(255, 255, 255)":u,v=null!==(o=null==c?void 0:null===(i=c.match(/\d+/g))||void 0===i?void 0:i.reduce((e,t)=>Number(e)+Number(t),0))&&void 0!==o?o:0;200>Math.abs((null!==(a=null==l?void 0:null===(n=l.match(/\d+/g))||void 0===n?void 0:n.reduce((e,t)=>Number(e)+Number(t),0))&&void 0!==a?a:0)-v)&&(e.style.color=p(l))}}))},f=(e,t)=>{if(!e||e.getAttribute("data-theme")===(t?"dark":"light"))return;e.setAttribute("data-theme",t?"dark":"light");let l=e.querySelectorAll("[style]:not([bgcolor])"),i=e.querySelectorAll("[bgcolor]"),n=e.querySelectorAll("[color]");[...l,...i].forEach(e=>{!function(e,t){let l=t?"255, 255, 255":"0, 0, 0",i=t?"white":"black";if(e.style.backgroundColor){let t=e.style.backgroundColor;e.style.backgroundColor=t.includes(l)||t===i?"transparent":p(t)}else if(e.bgColor){var n;let t=(null===(n=e.bgColor)||void 0===n?void 0:n[0])==="#"||6===e.bgColor.length?"rgb(".concat((0,v.oo)(e.bgColor.replaceAll("#","")),")"):e.bgColor;e.bgColor=t.includes("rgb")?t.includes(l.replaceAll(" ",""))?"transparent":(0,v.vq)(p(t)):t}if(Object.keys(e.style).filter(e=>e.includes("border")&&e.includes("Color")).forEach(t=>{let l=e.style[t];"string"==typeof l&&l&&e.style.setProperty(t,p(l))}),e.style.color){let t=e.style.color;e.style.color=t.includes("rgb")?p(t):i}"FONT"!==e.tagName||e.style.color||(e.style.color=i)}(e,t)}),n.forEach(e=>{e.getAttribute("color")&&e.setAttribute("color",t?"white":"black")})},g=(e,t)=>{let l=t?"rgb(0, 0, 0)":"rgb(255, 255, 255)",i=e=>t?e>600:e<160;return e.map(e=>(Array.from(e.cssRules).forEach(e=>{if(e instanceof CSSStyleRule){var t,n,r,o;let a=e.style,d=a.color;d&&(a.color=p(d));let s=a.backgroundColor;s&&i(null!==(n=null===(t=s.match(/\d+/g))||void 0===t?void 0:t.reduce((e,t)=>Number(e)+Number(t),0))&&void 0!==n?n:0)&&(a.backgroundColor=p(s));let u=a.background;u&&(i(null!==(o=null===(r=u.match(/\d+/g))||void 0===r?void 0:r.reduce((e,t)=>Number(e)+Number(t),0))&&void 0!==o?o:0)?a.background=p(u):u.includes("rgb")||(a.background=l))}}),e))},b=(0,a.Pi)(e=>{let{children:t,id:l,headers:r}=e,[a,v]=(0,d.useState)(null),[p,b]=(0,d.useState)(!1),[y,x]=(0,d.useState)(!1),[k,w]=(0,d.useState)(!1),[C,S]=(0,d.useState)(!1),I=(0,d.useRef)(),[N,T]=(0,d.useState)(null),j=(0,d.useRef)(null),{uiStore:{isDarkMode:E},sidebarStore:M}=(0,n.m)(),A=(e,t)=>{var i,n,o,a,d,s,u,c,m,p,h,f,g,y,k,w,C,I;if(null===e||e.shadowRoot)return;let N=document.createRange().createContextualFragment(null!==(o=e.innerHTML)&&void 0!==o?o:""),E=null,M=new CSSStyleSheet;M.name="dark",E=Array.from(N.querySelectorAll("style")).map(e=>{let t=new CSSStyleSheet;t.replace(e.innerHTML);let l=0;return Array.from(t.cssRules).forEach((e,i)=>{var n,r,o,a;if(e instanceof CSSMediaRule)t.deleteRule(i-l),l++,(null===(n=e.media)||void 0===n?void 0:n.mediaText.includes("prefers-color-scheme: dark"))&&e.cssText.includes("olor:")&&Array.from(e.cssRules).forEach(e=>{e instanceof CSSStyleRule&&M.insertRule(e.cssText)});else if(e instanceof CSSStyleRule){if(e.cssText.includes("max-width")){let t=null===(a=e.style.maxWidth)||void 0===a?void 0:a.replace("px","");t&&Number(t)>660&&(e.style.maxWidth="100%")}(null===(r=e.selectorText)||void 0===r?void 0:r.includes("table"))&&(null===(o=e.cssText)||void 0===o?void 0:o.includes("!important"))&&Array.from(e.style).forEach(t=>{let l=e.style.getPropertyValue(t);l.includes("!important")&&e.style.setProperty(t,l.replaceAll("!important","").trim())})}}),e.innerHTML="",t});let A=(null===(i=M.cssRules)||void 0===i?void 0:i.length)>0;j.current=!!A&&M,A&&N.querySelectorAll("[style]").forEach(e=>{e.attributes.style.value.includes(" !important")&&(e.attributes.style.value=e.attributes.style.value.replaceAll(" !important",""))}),N.querySelectorAll("a").forEach(e=>{e.setAttribute("target","_blank")}),N.querySelectorAll("img").forEach((t,i)=>{if(t.id="".concat(l,"-img-").concat(i),t.onerror=function(t){var n;let r=null==e?void 0:null===(n=e.shadowRoot)||void 0===n?void 0:n.getElementById("".concat(l,"-img-").concat(i));r&&(r.style.display="none")},t.width||"100%"!==t.style.maxWidth){let e=Number(t.style.maxWidth.replace("px",""));(t.width>660||e&&e>660)&&(t.style.maxWidth="100%")}});let D=N.querySelector(".tatem_wordmark"),L=N.querySelector(".gmail_quote, .hs_reply");if(L&&t&&(null==N?void 0:null===(n=N.firstChild)||void 0===n?void 0:n.contains(L))){let e=(null===(a=L.outerHTML.substring(0,1e3))||void 0===a?void 0:a.includes("Forwarded message"))||(null===(d=L.outerHTML.substring(0,1e3))||void 0===d?void 0:d.includes("Forwarded Message"))||(null==N?void 0:null===(c=N.firstElementChild)||void 0===c?void 0:null===(u=c.firstElementChild)||void 0===u?void 0:null===(s=u.firstElementChild)||void 0===s?void 0:s.className.includes("gmail_quote"));try{window.navigator.userAgent.includes("MSIE")?(null==N||null===(h=N.firstChild)||void 0===h||h.removeChild(L),D&&(null==N||null===(f=N.firstChild)||void 0===f||f.removeChild(D))):(L.remove(),D&&D.remove());let t=D?(null==D?void 0:D.outerHTML)+"<br/>"+(null==L?void 0:L.outerHTML):null==L?void 0:L.outerHTML;v(t);let l=null!==(g=null===(p=L.firstChild)||void 0===p?void 0:null===(m=p.textContent)||void 0===m?void 0:m.indexOf("On"))&&void 0!==g?g:-1;e&&0!==l&&b(!0)}catch(e){console.error(e)}}let R=null==r?void 0:r.find(e=>e.name.includes("X-MS-"));if(R&&x(!0),!N.querySelector("table")||R){x(!0),N.querySelector("br")||N.querySelector("hr")||N.querySelector("meta")||N.querySelector("p")||S(!0);let e=N.querySelectorAll("div"),t=/(https?:\/\/)+(www\.)?[^\s]+\.[^\s]+/g;e.forEach(e=>{e.style.fontFamily&&(e.style.fontFamily=""),e.querySelector("a")||e.querySelector("img")||(e.innerHTML=e.innerHTML.replace(t,e=>"<a href='".concat(e,"' target='_blank' rel='noopener noreferrer'>").concat(e,"</a>")))});let l=N.querySelectorAll("span"),i=N.querySelectorAll("td");[...Array.from(l),...Array.from(i)].forEach(e=>{e.style.fontFamily&&(e.style.fontFamily="Inter var, 'sans serif'"),e.style.fontSize&&(e.style.fontSize="13px"),e.style.lineHeight&&(e.style.lineHeight="1.54")});let n=N.querySelectorAll("p"),r=N.querySelectorAll("font");[...Array.from(n),...Array.from(r)].forEach(e=>{e.style.fontFamily="Inter var, 'sans serif'",e.style.fontSize="13px",e.style.lineHeight="1.54"})}if(N.querySelector("table")){let e=N.querySelectorAll("table"),t=null===(k=Array.from(e))||void 0===k?void 0:null===(y=k.sort((e,t)=>{var l,i,n,r;return Number(null!==(n=null===(l=e.style.width.match(/\d+/))||void 0===l?void 0:l[0])&&void 0!==n?n:0)>Number(null!==(r=null===(i=t.style.width.match(/\d+/))||void 0===i?void 0:i[0])&&void 0!==r?r:0)?-1:1}))||void 0===y?void 0:y.at(0),l=Number((null==t?void 0:t.width)?t.width:null==t?void 0:t.style.width.replace("px","")),i=isNaN(l)?660:l;!(i>660)||!N.firstChild||(null==N?void 0:null===(I=N.firstChild)||void 0===I?void 0:null===(C=I.firstChild)||void 0===C?void 0:null===(w=C.className)||void 0===w?void 0:w.includes("gmail_quote"))||(N.firstChild.style.width=i+"px",N.firstChild.style.opacity=0),e.forEach(e=>{if(e.style.width.includes("px")){let t=e.style.width.includes("px")?Number(e.style.width.replace("px","")):0;(t>=660||t>=i&&1.5*i>660)&&(e.style.width="100%")}else e.width&&"100%"!==e.width?(e.role="presentation",e.cellPadding="0",e.cellSpacing="0",e.border="0",Number(e.width)>=Math.max(660,i)&&!e.style.maxWidth&&(e.style.width="100%",e.style.marginLeft="auto",e.style.marginRight="auto")):"100%"===e.style.width&&e.style.maxWidth&&(e.style.width=e.style.maxWidth)})}let O=Array.from(N.childNodes).reduce((e,t)=>t instanceof Element?e+t.outerHTML:t instanceof Text?e+t.nodeValue:e,""),F=e.attachShadow({mode:"open"});if(t){let e=document.createElement("div");e.innerHTML=O,function(e){let t=document.createTreeWalker(e,NodeFilter.SHOW_ALL);for(;t.lastChild(););let l=t.currentNode;for(;l;){var i,n;if("#text"===t.currentNode.nodeName&&/\S/.test(null!==(i=t.currentNode.textContent)&&void 0!==i?i:" ")){t.currentNode;break}if("BR"===l.nodeName){let e=l;l=t.previousNode(),null===(n=e.parentNode)||void 0===n||n.removeChild(e)}else l=t.previousNode()}}(e);let t=e.innerHTML;F.innerHTML=t}else F.innerHTML=O;e.innerHTML="",E&&(T(E),F.adoptedStyleSheets=E);let B=document.createElement("style");B.innerHTML="a { color: var(--link-color); transition-duration: 50ms; text-decoration: none; } a:hover { text-decoration: underline } table { letter-spacing: 0px }",F.appendChild(B)},D=()=>{var e,t,l,i,n,r,o,a,d,s,u,c,v,m;let p=null==I?void 0:null===(t=I.current)||void 0===t?void 0:null===(e=t.shadowRoot)||void 0===e?void 0:e.firstChild,b=null==p?void 0:p.querySelector("table"),y=null==I?void 0:null===(i=I.current)||void 0===i?void 0:null===(l=i.className)||void 0===l?void 0:l.includes("text-body-long");if(E?(w(!0),j.current?(null==I||null===(n=I.current)||void 0===n||n.shadowRoot.adoptedStyleSheets.forEach(e=>{if("dark"===e.name){var t;null==I||null===(t=I.current)||void 0===t||t.shadowRoot.adoptedStyleSheets.pop()}}),null==I||null===(r=I.current)||void 0===r||r.shadowRoot.adoptedStyleSheets.push(j.current),setTimeout(()=>{h(p,E)},100)):!1===j.current&&(f(p,E),N&&g(N,E))):k&&(j.current?(null==I||null===(o=I.current)||void 0===o||o.shadowRoot.adoptedStyleSheets.pop(),setTimeout(()=>{h(p,E)},100)):!1===j.current&&(f(p,E),N&&g(N,E))),b){let e=null===(s=Array.from(null==p?void 0:p.querySelectorAll("table")))||void 0===s?void 0:null===(d=s.sort((e,t)=>e.clientWidth>t.clientWidth?-1:1))||void 0===d?void 0:null===(a=d.at(0))||void 0===a?void 0:a.clientWidth;e>Math.min(660,(null===(u=window)||void 0===u?void 0:u.innerWidth)-72)&&!y?p.style.width="".concat(e,"px"):p.style.width="";let t=Math.max(null==I?void 0:null===(c=I.current)||void 0===c?void 0:c.clientWidth,null==I?void 0:null===(v=I.current)||void 0===v?void 0:v.offsetWidth);if(e>t&&t>0&&!y){let l=t/e;if(l<.2)return;p.style.transform="scale(".concat(l,")"),p.style.transformOrigin="top left",p.style.marginBottom="-".concat(Math.max(null==b?void 0:b.clientHeight,null==p?void 0:p.clientHeight,(null==I?void 0:null===(m=I.current)||void 0===m?void 0:m.offsetHeight)-64)*(1-l),"px")}else p.style.transform="",p.style.marginBottom="";p.style.opacity=1}};return(0,d.useEffect)(()=>(D(),window.addEventListener("resize",D),()=>{window.removeEventListener("resize",D)}),[l,E,N]),(0,d.useEffect)(()=>{setTimeout(()=>{D()},100)},[M.sidebarOpen,M.rightSidebarOpen]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:o()("email-body z-0 select-text overflow-x-auto text-primary dark:text-primary-dark lg:overflow-hidden",{"text-body-long":y},{"whitespace-break-spaces":C}),ref:e=>{I.current=e,A(e,!0)},children:t}),!!a&&(0,i.jsxs)("div",{className:"relative mr-auto",children:[(0,i.jsx)(u.z,{className:"peer -translate-x-1 hover:translate-x-0",icon:c.N.ThreeDot,id:"expand-button"+(l?"-".concat(l):""),variant:"tertiary",size:"sm",onClick:()=>{b(!p)}}),(0,i.jsx)(s.M,{title:p?m.Wz.HideMessageHistory.title:m.Wz.ShowMessageHistory.title,keys:m.Wz.HideMessageHistory.keys,position:"bottom-8 left-1/2 -translate-x-1/2",opaque:!0})]}),p&&(0,i.jsx)("span",{className:"email-body-quote body z-0 overflow-x-auto lg:overflow-hidden",ref:e=>A(e),children:(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:a}})})]})})},81243:function(e,t,l){"use strict";l.d(t,{aw:function(){return s},l_:function(){return a},oo:function(){return n},pV:function(){return d},vq:function(){return r}});let i=e=>{var t,l,i,n;return null!==(n=null==e?void 0:null===(i=e.slice(1))||void 0===i?void 0:null===(l=i.replace(/^(.)(.)(.)$/gi,"$1$1$2$2$3$3"))||void 0===l?void 0:null===(t=l.match(/.{2}/g))||void 0===t?void 0:t.map(e=>parseInt(e,16)))&&void 0!==n?n:[]},n=e=>{var t,l;return null==e?void 0:null===(l=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,l,i)=>t+t+l+l+i+i))||void 0===l?void 0:null===(t=l.match(/.{2}/g))||void 0===t?void 0:t.map(e=>parseInt(e,16))},r=e=>{var t;return"#"+(null===(t=e.match(/\d+/g))||void 0===t?void 0:t.map(e=>(+e).toString(16).padStart(2,0)).join(""))},o=(e,t)=>Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2)),a=(e,t)=>t.reduce((t,l)=>{let n=o(i(e),i(l));return n<t[0]?[n,l]:t},[Number.POSITIVE_INFINITY,t[0]])[1],d=(e,t,l)=>{let i=Math.max(e/=255,t/=255,l/=255),n=i-Math.min(e,t,l),r=n?i===e?(t-l)/n:i===t?2+(l-e)/n:4+(e-t)/n:0;return[60*r<0?60*r+360:60*r,100*(n?i<=.5?n/(2*i-n):n/(2-(2*i-n)):0),100*(2*i-n)/2]},s=(e,t,l)=>{let i=t=>(t+e/30)%12,n=(t/=100)*Math.min(l/=100,1-l),r=e=>l-n*Math.max(-1,Math.min(i(e)-3,Math.min(9-i(e),1)));return{r:255*r(0),g:255*r(8),b:255*r(4)}}},27799:function(e,t,l){"use strict";l.d(t,{AK:function(){return u},Cv:function(){return v},Ep:function(){return h},Gr:function(){return N},K9:function(){return w},KJ:function(){return y},Kc:function(){return g},NF:function(){return k},Pb:function(){return T},QS:function(){return I},Qi:function(){return C},RZ:function(){return j},Uq:function(){return B},_S:function(){return x},b1:function(){return D},e6:function(){return p},eE:function(){return f},eK:function(){return S},fm:function(){return s},g4:function(){return O},gg:function(){return z},jE:function(){return E},ko:function(){return F},lS:function(){return b},mi:function(){return R},pE:function(){return A},r9:function(){return L},xX:function(){return M},zJ:function(){return m}});var i=l(82089),n=l(55028),r=l(43017),o=l(25441),a=l(70137);let d=new Date,s=e=>e.charAt(0).toUpperCase()+e.slice(1),u=e=>{let t=c(e),l=e.getHours();return t?"".concat(l>12?l%12:0===l?"12":l,":").concat(e.getMinutes().toLocaleString("en-US",{minimumIntegerDigits:2,useGrouping:!1})," ").concat(l>=12?"PM":"AM"):d.getFullYear()!==e.getFullYear()?"".concat(e.getMonth()+1,"/").concat(e.getDate(),"/").concat(e.getFullYear()):e.toLocaleString("default",{month:"short",day:"numeric"})},c=e=>{let t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},v=(e,t)=>{let l=new Date(Date.now());return(null==t?void 0:t.includes(":"))?"Today":(null==l?void 0:l.getDay())===(6!==e.getDay()?e.getDay()+1:0)&&Date.now()-e.getTime()<1728e5?"Yesterday":Date.now()-e.getTime()<6048e5&&(null==l?void 0:l.getDay())!==e.getDay()?e.toLocaleString("default",{month:"short",day:"numeric",year:"numeric"}):e.toLocaleString("default",{month:"short",year:"numeric"})},m=(e,t,l)=>e&&Array.isArray(e)?e.filter(e=>{if("ARCHIVE"===t){var i,n,r,o,a,d,s,u;return!e.labelIds.includes("INBOX")&&(!e.labelIds.includes("SENT")||p(null!==(s=null==e?void 0:null===(r=e.payload)||void 0===r?void 0:null===(n=r.headers)||void 0===n?void 0:null===(i=n.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===i?void 0:i.value)&&void 0!==s?s:"")===p(null!==(u=null==e?void 0:null===(d=e.payload)||void 0===d?void 0:null===(a=d.headers)||void 0===a?void 0:null===(o=a.find(e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="to"}))||void 0===o?void 0:o.value)&&void 0!==u?u:""))}return"SEARCH"===t||(l?e.labelIds.includes(t)||e.labelIds.includes("DRAFT"):e.labelIds.includes(t))}):[],p=e=>{var t;return(null==e?void 0:e.includes("<"))?null==e?void 0:null===(t=e.split(" <")[1])||void 0===t?void 0:t.replaceAll(">",""):e},h=e=>{let t=[],l=e.match(/<([^>]+)>|([^,\s]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g);return null==l||l.forEach(e=>{let l=e.replace(/<|>/g,"").trim();t.push(l)}),t},f=(e,t)=>{let l=/(.+?)\s*<([^>]+)>|([^,\s]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,i=[],n=e.split(","),r=[];return null==n||n.forEach((e,n)=>{let o=/(.+?)\s*<([^>]+)>/.exec(e);if(o){let e="";if(r.length>0){let t=n;for(;t>0;){var a;let l=null===(a=r.find(e=>e.idx===t-1))||void 0===a?void 0:a.value;if(!l)break;e=l+", "+e,t--}}let l=(e||"")+o[1].trim().replace(", ",""),d=o[2].trim().replace(/<|>/g,"");i.push({name:d===t?"Me":l,email:d})}else if(e.match(l)){let l=e.trim().replace(", ","").replace(/<|>/g,"");i.push({name:l===t?"Me":"",email:l})}else r.push({idx:n,value:e})}),i},g=e=>{let t=null==e?void 0:e.match(/^(.*?)\s*<.*$/);return t?t[1]:e},b=e=>{var t,l,i;return(null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(l=i.headers)||void 0===l?void 0:null===(t=l.find(e=>"Subject"===e.name))||void 0===t?void 0:t.value)||"(no subject)"},y=e=>{var t;let l=null==e?void 0:null===(t=e.split(","))||void 0===t?void 0:t.map(e=>null==e?void 0:e.trim()),i=null==l?void 0:l.map(e=>{var t,l;return(null==e?void 0:e.includes(" "))?null==e?void 0:null===(t=e.split(" <"))||void 0===t?void 0:t[0]:null==e?void 0:null===(l=e.replaceAll("<",""))||void 0===l?void 0:l.replaceAll(">","")});return null==i?void 0:i.join(", ")},x=(e,t,l,i)=>{var n;return e&&t&&t>0&&t<(null==e?void 0:e.length)?(i&&i(e[t-1]),"/thread/"+(null===(n=e[t-1])||void 0===n?void 0:n.id)):"/thread/"+(null!=l?l:"")},k=(e,t,l,i)=>{var n;return e&&t>=0&&t<(null==e?void 0:e.length)-1?(i&&i(e[t+1]),"/thread/"+(null===(n=e[t+1])||void 0===n?void 0:n.id)):"/thread/"+(null!=l?l:"")};function w(e){if(!e)return null;{let t=atob(e);return Uint8Array.from(t,e=>e.codePointAt(0))}}let C=e=>new Promise((t,l)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=()=>{var e,l;return t(null===(l=String(i.result))||void 0===l?void 0:null===(e=l.split(","))||void 0===e?void 0:e.pop())},i.onerror=l});function S(e){let{sender:t,recipient:l,subject:i,message:a,cc:d,bcc:s,headers:u,attachments:c,addTatemWatermark:v=!1}=e,m=(0,r.xV)();m.setSender(t),m.setSubject(null!=i?i:"");let p=(0,o.nn)((0,o.LE)(l));p.length&&m.setRecipient(p);let h=(0,o.nn)((0,o.LE)(null!=d?d:[]));h.length&&m.setCc(h);let f=(0,o.nn)((0,o.LE)(null!=s?s:[]));f.length&&m.setBcc(f),u&&m.setHeaders(u);let g=a;if(v&&"string"==typeof a){let e=a.indexOf('<div class="gmail_quote">'),t='<br/><div class="tatem_wordmark">Sent from <a href="https://tatem.com" target="_blank" rel="noopener noreferrer">Tatem Mail</a></div>';g=e>0?a.slice(0,e)+t+a.slice(e):a+t}if(null==g?void 0:g.includes(";base64,")){let e=document.createRange().createContextualFragment(g);e.querySelectorAll("img").forEach((e,t)=>{var l,i,n;if(null==e?void 0:null===(l=e.src)||void 0===l?void 0:l.includes(";base64,")){let l=null==e?void 0:null===(n=e.src)||void 0===n?void 0:null===(i=n.split(","))||void 0===i?void 0:i[1],r="tatem-image-".concat(t);m.addAttachment({inline:!0,filename:r+".png",contentType:"image/png",data:l,headers:{"Content-ID":r}}),e.src="cid:".concat(r),e.hasAttribute("data-surl")&&e.removeAttribute("data-surl")}});let t=document.createElement("div");t.appendChild(e.cloneNode(!0)),g=t.innerHTML}return m.addMessage({contentType:"text/html",charset:"UTF-8",encoding:"base64",data:(0,n.cv)(g)}),c&&(null==c||c.forEach(e=>{var t;(null==e?void 0:null===(t=e.body)||void 0===t?void 0:t.size)<2e7&&m.addAttachment(e)})),m}let I=function(e){var t;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/html";return(null==e?void 0:e.mimeType)===l||(null==e?void 0:null===(t=e.mimeType)||void 0===t?void 0:t.startsWith(l))?[e]:(null==e?void 0:e.parts)?null==e?void 0:e.parts.flatMap(e=>I(e,l)).filter(e=>!!e):null},N=function(e){var t,l,i,n,r,o,a,d,s,u,c,v,m,p,h,f;let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e?void 0:null===(t=e.parts)||void 0===t?void 0:t.length){let t=e.parts.find(e=>(null==e?void 0:e.mimeType)==="text/html");if((null==t?void 0:null===(l=t.body)||void 0===l?void 0:l.data)&&!g)return null==t?void 0:null===(n=t.body)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.replace(/-/g,"+").replace(/_/g,"/");{let t=e.parts.find(e=>(null==e?void 0:e.mimeType)==="multipart/alternative"||(null==e?void 0:e.mimeType)==="multipart/related"),l=null==t?void 0:null===(r=t.parts)||void 0===r?void 0:r.find(e=>(null==e?void 0:e.mimeType)==="text/html");if(l&&!g)return null==l?void 0:null===(d=l.body)||void 0===d?void 0:null===(a=d.data)||void 0===a?void 0:a.replace(/-/g,"+").replace(/_/g,"/");{let t=null===(s=I(e))||void 0===s?void 0:s.at(0);if(t)return null==t?void 0:null===(c=t.body)||void 0===c?void 0:null===(u=c.data)||void 0===u?void 0:u.replace(/-/g,"+").replace(/_/g,"/")}let i=e.parts.find(e=>(null==e?void 0:e.mimeType)==="text/plain");if(null==i?void 0:null===(o=i.body)||void 0===o?void 0:o.data)return null==i?void 0:null===(m=i.body)||void 0===m?void 0:null===(v=m.data)||void 0===v?void 0:v.replace(/-/g,"+").replace(/_/g,"/")}}else if(!g)return null!==(f=null==e?void 0:null===(h=e.body)||void 0===h?void 0:null===(p=h.data)||void 0===p?void 0:p.replace(/-/g,"+").replace(/_/g,"/"))&&void 0!==f?f:null},T=e=>{let t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))});if(!t)return a.Nu[0][0];let l=(0,i.createHash)("sha1").update(t).digest("hex"),n=parseInt(l.substring(10,14),16),r=parseInt(l.substring(18,22),16),o=a.Nu.length,d=a.Nu[0].length;return a.Nu[n%o][r%d]};function j(e){var t;return(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.parts).reduce((e,t)=>(t.filename&&(0===e.firstFileNameInMessage.length&&(e.firstFileNameInMessage=t.filename),++e.count),e),{count:0,firstFileNameInMessage:""})}let E=6048e5;function M(e,t,l){return(null==t?void 0:t.toDateString())!==(null==l?void 0:l.toDateString())}function A(e,t,l){return t.getMonth()!==l.getMonth()||t.getFullYear()!==l.getFullYear()}let D=e=>{let t=new Map;return e.forEach(e=>{let l=t.get(e.emailAddress);l?("directory"===e.sourceType||"directory"!==l.sourceType&&"Unknown Name"!==e.displayName&&"Unknown Name"===l.displayName)&&t.set(e.emailAddress,e):t.set(e.emailAddress,e)}),Array.from(t.values())},L=function(e,t,l,i){var n;let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"span",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:["text-body"],d=document.createElement(o);d.classList.add(...a,"break-all","absolute"),d.style.width=l+"px";let s=e;if(d.textContent=r+s+i,document.body.appendChild(d),Math.floor(d.offsetHeight)>t){let l=0,n=s.length-1;for(;l<n;){let o=Math.ceil(l+(n-l)/2);s=e.slice(0,o)+"...",d.textContent=r+s+i;let a=Math.floor(d.offsetHeight);a>t?n=o-1:a<=t&&(l=o)}s=e.slice(0,l)+"..."}return null===(n=d.parentNode)||void 0===n||n.removeChild(d),s},R=(e,t)=>t.find(t=>(null==t?void 0:t.id)===e),O=(e,t,l)=>{var i;let n=R(e,l);if(!n)return!1;let r=n.messages[n.messages.length-1];return null==r?void 0:null===(i=r.labelIds)||void 0===i?void 0:i.includes(t)},F=e=>{var t,l,i,n,r,o,a;return null!==(a=null==e?void 0:null===(o=e.payload)||void 0===o?void 0:null===(r=o.headers)||void 0===r?void 0:null===(n=r.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===n?void 0:null===(i=n.value)||void 0===i?void 0:null===(l=i.replaceAll('"',""))||void 0===l?void 0:null===(t=l.split(" <"))||void 0===t?void 0:t[0])&&void 0!==a?a:""},B=function(e,t){var l,i,n,r,o,a,d;let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],u=null==e?void 0:null===(l=e.payload)||void 0===l?void 0:l.headers;if(s)return null!==(r=null==u?void 0:null===(n=u.find(e=>e.name===t))||void 0===n?void 0:null===(i=n.value)||void 0===i?void 0:i.replaceAll('"',""))&&void 0!==r?r:"";{let e=t.toLowerCase();return null!==(d=null==u?void 0:null===(a=u.find(t=>{var l;return(null===(l=t.name)||void 0===l?void 0:l.toLowerCase())===e}))||void 0===a?void 0:null===(o=a.value)||void 0===o?void 0:o.replaceAll('"',""))&&void 0!==d?d:""}},z=e=>e.hasChildNodes()?[e,...Array.from(e.childNodes).flatMap(e=>z(e))]:[e]},80672:function(e,t,l){"use strict";l.d(t,{CF:function(){return d},_f:function(){return a},hV:function(){return r},lp:function(){return n},pJ:function(){return o}});var i=l(46203);let n=function(e,t,l){var n;let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],o=arguments.length>4?arguments[4]:void 0;if(!e)return e;let a=new Set(t.emailIds);if(r){if(!Array.isArray(e))return e;if(e.some(e=>null==e?void 0:e.hasOwnProperty("threadResults"))){let n=[...e,{}];return null==l||l.forEach(l=>{var r,d;let s=e.findIndex(e=>{var t;return null===(t=e.threadResults)||void 0===t?void 0:t.find(e=>e.id===l)});if(-1===s)return e;let u=null===(d=e[s])||void 0===d?void 0:null===(r=d.threadResults)||void 0===r?void 0:r.findIndex(e=>e.id===l),c=e[s].threadResults[u];if(!c)return e;c.messages.forEach(e=>{a.has(e.id)&&(e.labelIds=[...e.labelIds.filter(e=>!t.removeLabelIds.includes(e)),...t.addLabelIds])}),o&&(0,i.W)(t.addLabelIds,t.removeLabelIds,o)?c.removedFromView=!0:c.removedFromView&&(c.removedFromView=!1),n[s].threadResults[u]=c}),n}{let n=[...e,{messages:[]}];return null==l||l.forEach(l=>{var r,d,s;let u=e.findIndex(e=>{let t=null==e?void 0:e.messages;return null==t?void 0:t.find(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===l})});if(-1===u)return e;let c=null===(d=e[u])||void 0===d?void 0:null===(r=d.messages)||void 0===r?void 0:r.findIndex(e=>{var t;return(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.id)===l}),v=e[u].messages[c];if(!v)return e;null===(s=v.result)||void 0===s||s.messages.forEach(e=>{a.has(e.id)&&(e.labelIds=[...e.labelIds.filter(e=>!t.removeLabelIds.includes(e)),...t.addLabelIds])}),o&&(0,i.W)(t.addLabelIds,t.removeLabelIds,o)?v.removedFromView=!0:v.removedFromView&&(v.removedFromView=!1),n[u].messages[c]=v}),n}}return{...e,messages:null==e?void 0:null===(n=e.messages)||void 0===n?void 0:n.map(e=>a.has(e.id)?{...e,labelIds:[...e.labelIds.filter(e=>!t.removeLabelIds.includes(e)),...t.addLabelIds].sort((e,t)=>e>t?-1:1)}:e)}},r=(e,t,l)=>{var i,n,r,o,a;let d=t.find(t=>(null==t?void 0:t.id)===e);if(!d)return{conversation:void 0,isLastMessageLabeled:!1,lastMessageSubject:""};let s=null==d?void 0:d.messages,u=null==s?void 0:s[(null==s?void 0:s.length)-1];return{conversation:d,isLastMessageLabeled:!!l&&(null==u?void 0:null===(i=u.labelIds)||void 0===i?void 0:i.includes(l)),lastMessageSubject:null!==(a=null==u?void 0:null===(o=u.payload)||void 0===o?void 0:null===(r=o.headers)||void 0===r?void 0:null===(n=r.find(e=>"Subject"===e.name))||void 0===n?void 0:n.value)&&void 0!==a?a:""}};function o(e,t,l,i){if(l)return{isActive:e,count:t.length};{var n,r,o,a,d;let t=null==i?void 0:null===(n=i.at(0))||void 0===n?void 0:n.messages,l=null==t?void 0:t[(null==t?void 0:t.length)-1];return{isActive:e,primaryText:null!==(d=null==l?void 0:null===(a=l.payload)||void 0===a?void 0:null===(o=a.headers)||void 0===o?void 0:null===(r=o.find(e=>"Subject"===e.name))||void 0===r?void 0:r.value)&&void 0!==d?d:""}}}function a(e){return e.includes("/thread/")}let d=(e,t)=>{var l,i;if(!e)return{labelIds:[],labelId_sorted:[]};let n=new Set(null==e?void 0:null===(l=e.messages)||void 0===l?void 0:l.flatMap(e=>null==e?void 0:e.labelIds)),r=null==e?void 0:null===(i=e.labelIds)||void 0===i?void 0:i.find(e=>e.includes("INBOX-split-"));r&&n.add(r),t&&!n.has(t)&&n.add(t);let o=Array.from(n),a=o.map(t=>{var l,i;let n=t.includes("INBOX-split-")?"INBOX":t;return[t,null==e?void 0:null===(i=e.messages)||void 0===i?void 0:null===(l=i.findLast(e=>{var t;return null==e?void 0:null===(t=e.labelIds)||void 0===t?void 0:t.includes(n)}))||void 0===l?void 0:l.internalDate]});return{labelIds:o,labelId_sorted:a}}},49222:function(e,t,l){"use strict";l.d(t,{$Y:function(){return g},CS:function(){return C},FB:function(){return v},SP:function(){return m},Wp:function(){return S},X0:function(){return f},_:function(){return c},bN:function(){return w},dM:function(){return I},i2:function(){return y},i9:function(){return s},jD:function(){return b},kw:function(){return x},rK:function(){return u},tp:function(){return h},wd:function(){return p},yh:function(){return k}});var i=l(71451),n=l(95470),r=l(29970),o=l(27799),a=l(80672),d=l(70137);let s=async e=>{try{var t,l,i,n,o,a,d,s,u,c;let v=null,m=[],p=null===(t=window)||void 0===t?void 0:t.gapi,h=e.includes("INBOX-split-"),f=h?(null==e?void 0:null===(l=e.split("-split-"))||void 0===l?void 0:l.at(1))+" in:inbox":"",g=h?"INBOX":e;for(;!m.length||v&&(null==m?void 0:m.length)<r.sk*r.Rp;){let t=e&&await (null==p?void 0:null===(o=p.client)||void 0===o?void 0:null===(n=o.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:i.threads.list({userId:"me",maxResults:500,labelIds:e&&"ARCHIVE"!==e?[g]:null,q:"ARCHIVE"===e?r.mE:f,pageToken:null!=v?v:void 0}));if(null==t?void 0:null===(d=t.result)||void 0===d?void 0:null===(a=d.threads)||void 0===a?void 0:a.length){let e=null==t?void 0:null===(u=t.result)||void 0===u?void 0:null===(s=u.threads)||void 0===s?void 0:s.map(e=>null==e?void 0:e.id);m=[...m,...e],v=null==t?void 0:null===(c=t.result)||void 0===c?void 0:c.nextPageToken}else break}return m}catch(e){console.error(e)}},u=async(e,t)=>{let{emailIds:l,addLabelIds:i,removeLabelIds:r,mutate:o,optimisticData:d,optimisticRollback:s,revalidate:u=!0,db:c,threadIds:v}=e;o&&d&&o(()=>{},{optimisticData:d,populateCache:!1,revalidate:u}),c&&(null==v||v.forEach(async e=>{let t=await c.get("mail",e);if(t){t.messages=t.messages.map(e=>(e.labelIds=Array.from(new Set([...e.labelIds.filter(e=>!r.includes(e)),...i])),e));let e=(0,a.CF)(t);null==c||c.put("mail",{...t,...e})}}));let m=()=>{o&&s&&o(()=>{},{optimisticData:s,populateCache:!1,revalidate:u}),c&&(null==v||v.forEach(async e=>{let t=await c.get("mail",e);if(t){var l;t.messages=t.messages.map(e=>(e.labelIds=Array.from(new Set([...e.labelIds.filter(e=>!i.includes(e)),...r])),e));let e=Array.from(new Set(null==t?void 0:null===(l=t.messages)||void 0===l?void 0:l.flatMap(e=>null==e?void 0:e.labelIds))),n=e.map(e=>{var l;let i=null===(l=[...null==t?void 0:t.messages].findLast(t=>{var l;return null==t?void 0:null===(l=t.labelIds)||void 0===l?void 0:l.includes(e)}))||void 0===l?void 0:l.internalDate;return[e,i]});null==c||c.put("mail",{...t,labelIds:e,labelId_sorted:n})}}))};if(t){let{enqueue:e,isUndoOrRedo:o,...a}=t;e({transaction:{...a,type:n.e.LabelThread,resource:{emailIds:l,removeLabelIds:r,addLabelIds:i}},rollbackFn:m,isUndoOrRedo:o})}else try{var p,h,f,g;let e=null===(p=window)||void 0===p?void 0:p.gapi;await (null==e?void 0:null===(g=e.client)||void 0===g?void 0:null===(f=g.gmail)||void 0===f?void 0:null===(h=f.users)||void 0===h?void 0:h.messages.batchModify({userId:"me",resource:{ids:l,addLabelIds:i,removeLabelIds:r}}))}catch(e){return m(),console.error(e),!1}return!0},c=async e=>{var t,l,i,n,r;let{labelName:o,color:a}=e,s=null===(t=window)||void 0===t?void 0:t.gapi,u=Object.values(d.m8),c=Math.floor(Math.random()*(null==u?void 0:u.length)),v=o.includes("[Tatem]"),m={messageListVisibility:v?"hide":"show",labelListVisibility:v?"labelHide":"labelShow",name:o,type:"user",color:{backgroundColor:null!=a?a:u[c],textColor:"#000000"}};return await (null==s?void 0:null===(r=s.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.labels)||void 0===l?void 0:l.create({userId:"me",resource:{...m}}))},v=async e=>{var t,l,i,n,r,o;let{label:a}=e,s=null===(t=window)||void 0===t?void 0:t.gapi,u=Object.values(d.m8),c=Math.floor(Math.random()*(null==u?void 0:u.length));return await (null==s?void 0:null===(r=s.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.labels)||void 0===l?void 0:l.patch({userId:"me",id:null==a?void 0:a.id,resource:{name:null==a?void 0:a.name,color:null!==(o=null==a?void 0:a.color)&&void 0!==o?o:{backgroundColor:u[c],textColor:"#000000"}}}))},m=async e=>{var t,l,i,n,r;let{label:o}=e,a=null===(t=window)||void 0===t?void 0:t.gapi;return await (null==a?void 0:null===(r=a.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.labels)||void 0===l?void 0:l.delete({userId:"me",id:null==o?void 0:o.id}))},p=async e=>{var t,l,n,r,a,d,s,u,c,v,m,p,h;let f=null==e?void 0:null===(l=e.value)||void 0===l?void 0:null===(t=l.split(","))||void 0===t?void 0:t.find(e=>e.includes("mailto:"));if(f){let e=(0,i.e)(),{data:{user:t}}=await (null==e?void 0:null===(r=e.auth)||void 0===r?void 0:r.getUser()),l=new URL(null==f?void 0:f.replaceAll("<","").replaceAll(">","")),n={raw:(0,o.eK)({recipient:null==l?void 0:l.pathname,subject:null!==(d=l.searchParams.get("subject"))&&void 0!==d?d:"Unsubscribe",message:null!==(s=l.searchParams.get("body"))&&void 0!==s?s:"This unsubscribe request was sent on behalf of ".concat(null==t?void 0:t.email," by Tatem."),sender:"".concat(null==t?void 0:null===(a=t.user_metadata)||void 0===a?void 0:a.name," <").concat(null==t?void 0:t.email,">")}).asEncoded()};try{let e=null===(u=window)||void 0===u?void 0:u.gapi;await (null==e?void 0:null===(p=e.client)||void 0===p?void 0:null===(m=p.gmail)||void 0===m?void 0:null===(v=m.users)||void 0===v?void 0:null===(c=v.messages)||void 0===c?void 0:c.send({userId:"me",resource:n}))}catch(e){throw console.error(e),e}}else if(null==e?void 0:null===(n=e.value)||void 0===n?void 0:n.includes("http")){let t=null==e?void 0:null===(h=e.value)||void 0===h?void 0:h.replaceAll("<","").replaceAll(">","");try{await fetch(t,{method:"POST"})}catch(e){console.error(e),setTimeout(()=>{window.open(t,"_blank")},500)}}},h=async e=>{let t="+TATEMBLOCKLIST";try{var l,i,n,r,o,a,d,s,u,c,v,m,p,h,f,g,b;let y=null===(l=window)||void 0===l?void 0:l.gapi,{result:{filter:x}}=await (null==y?void 0:null===(a=y.client)||void 0===a?void 0:null===(o=a.gmail)||void 0===o?void 0:null===(r=o.users)||void 0===r?void 0:null===(n=r.settings)||void 0===n?void 0:null===(i=n.filters)||void 0===i?void 0:i.list({userId:"me"})),k=null;if(null==x?void 0:x.length){let l=x.find(e=>{var l,i;return null==e?void 0:null===(i=e.criteria)||void 0===i?void 0:null===(l=i.query)||void 0===l?void 0:l.includes(t)});if(l){if(null==(k=null==l?void 0:null===(m=l.criteria)||void 0===m?void 0:m.query)?void 0:k.includes("from:".concat(e)))return;await (null==y?void 0:null===(b=y.client)||void 0===b?void 0:null===(g=b.gmail)||void 0===g?void 0:null===(f=g.users)||void 0===f?void 0:null===(h=f.settings)||void 0===h?void 0:null===(p=h.filters)||void 0===p?void 0:p.delete({userId:"me",id:null==l?void 0:l.id}))}}let w={criteria:{query:"".concat(null!=k?k:t," OR from:").concat(e)},action:{addLabelIds:["TRASH"],removeLabelIds:["INBOX"]}};await (null==y?void 0:null===(v=y.client)||void 0===v?void 0:null===(c=v.gmail)||void 0===c?void 0:null===(u=c.users)||void 0===u?void 0:null===(s=u.settings)||void 0===s?void 0:null===(d=s.filters)||void 0===d?void 0:d.create({userId:"me",resource:w}))}catch(e){throw console.error(e),e}},f=async e=>{let t="+TATEMBLOCKLIST";try{var l,i,n,r,o,a,d,s,u,c,v,m,p,h,f,g,b,y,x;let k=null===(l=window)||void 0===l?void 0:l.gapi,{result:{filter:w}}=await (null==k?void 0:null===(a=k.client)||void 0===a?void 0:null===(o=a.gmail)||void 0===o?void 0:null===(r=o.users)||void 0===r?void 0:null===(n=r.settings)||void 0===n?void 0:null===(i=n.filters)||void 0===i?void 0:i.list({userId:"me"})),C=null;if(null==w?void 0:w.length){let l=w.find(e=>{var l,i;return null==e?void 0:null===(i=e.criteria)||void 0===i?void 0:null===(l=i.query)||void 0===l?void 0:l.includes(t)});if(l){let i=null==(C=null==l?void 0:null===(d=l.criteria)||void 0===d?void 0:d.query)?void 0:null===(u=C.split(" OR "))||void 0===u?void 0:null===(s=u.filter(t=>!(null==t?void 0:t.includes(e))))||void 0===s?void 0:s.join(" OR ");if(!(null==C?void 0:C.includes("".concat(e))))return;await (null==k?void 0:null===(h=k.client)||void 0===h?void 0:null===(p=h.gmail)||void 0===p?void 0:null===(m=p.users)||void 0===m?void 0:null===(v=m.settings)||void 0===v?void 0:null===(c=v.filters)||void 0===c?void 0:c.delete({userId:"me",id:null==l?void 0:l.id})),await (null==k?void 0:null===(x=k.client)||void 0===x?void 0:null===(y=x.gmail)||void 0===y?void 0:null===(b=y.users)||void 0===b?void 0:null===(g=b.settings)||void 0===g?void 0:null===(f=g.filters)||void 0===f?void 0:f.create({userId:"me",resource:{criteria:{query:"".concat(null!=i?i:t)},action:{addLabelIds:["TRASH"],removeLabelIds:["INBOX"]}}}))}}}catch(e){throw console.error(e),e}},g=async e=>{let{fn:t,resolve:l,reject:i,count:n,maxRetries:r=3}=e;try{n++;let e=await t;(null==e?void 0:e.length)?l(e):n<r?g({fn:t,resolve:l,reject:i,count:n}):l(null)}catch(e){i(e)}},b=async(e,t)=>{let l=window.gapi;try{let{result:{threads:i,nextPageToken:n}}=await l.client.gmail.users.threads.list({userId:"me",q:e,maxResults:500,pageToken:null!=t?t:""}),r=Promise.all(null==i?void 0:i.map(e=>l.client.gmail.users.threads.get({userId:"me",id:null==e?void 0:e.id,format:"minimal",fields:"messages(id)"}))),o=new Promise(e=>setTimeout(()=>e(null),3e3)),a=await new Promise((e,t)=>g({fn:Promise.race([r,o]),resolve:e,reject:t,count:0}));if(null===a)throw Error("too many attempts");return{emailIds:null==a?void 0:a.flatMap(e=>{var t,l;return null===(l=e.result)||void 0===l?void 0:null===(t=l.messages)||void 0===t?void 0:t.map(e=>e.id)}),threadIds:null==i?void 0:i.map(e=>null==e?void 0:e.id)}}catch(e){throw console.error(e),e}},y=async e=>{var t,l,i,n,r,o,a,d;if(!e)return;let s=null===(t=window)||void 0===t?void 0:t.gapi,u=await (null==s?void 0:null===(r=s.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.drafts)||void 0===l?void 0:l.list({userId:"me",includeSpamTrash:!0,maxResults:1,q:"rfc822msgid:".concat(e),fields:"drafts(id)"})),c=null==u?void 0:null===(d=u.result)||void 0===d?void 0:null===(a=d.drafts)||void 0===a?void 0:null===(o=a.at(0))||void 0===o?void 0:o.id;return(null==c?void 0:c.length)?c:void 0},x=async e=>{var t,l,i,n;let r=null===(t=window)||void 0===t?void 0:t.gapi;try{return await (null==r?void 0:null===(n=r.client)||void 0===n?void 0:null===(i=n.gmail)||void 0===i?void 0:null===(l=i.users)||void 0===l?void 0:l.messages.batchModify({userId:"me",resource:e}))}catch(e){throw e}},k=async(e,t)=>{var l,i,n,r,o;let a=null===(l=window)||void 0===l?void 0:l.gapi;try{return await (null==a?void 0:null===(o=a.client)||void 0===o?void 0:null===(r=o.gmail)||void 0===r?void 0:null===(n=r.users)||void 0===n?void 0:null===(i=n.drafts)||void 0===i?void 0:i.send({userId:"me",resource:{...e.resource,id:t}}))}catch(e){throw console.error(e),e}},w=async e=>{var t,l,i,n,r;let o=null===(t=window)||void 0===t?void 0:t.gapi;try{return await (null==o?void 0:null===(r=o.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.drafts)||void 0===l?void 0:l.create({userId:"me",resource:e.resource}))}catch(e){throw console.error(e),e}},C=async(e,t)=>{var l,i,n,r,o;let a=null===(l=window)||void 0===l?void 0:l.gapi;try{return await (null==a?void 0:null===(o=a.client)||void 0===o?void 0:null===(r=o.gmail)||void 0===r?void 0:null===(n=r.users)||void 0===n?void 0:null===(i=n.drafts)||void 0===i?void 0:i.update({id:t,userId:"me",resource:{...e.resource,id:t}}))}catch(e){throw console.error(e),e}},S=async e=>{var t,l,i,n,r;let o=null===(t=window)||void 0===t?void 0:t.gapi;try{return await (null==o?void 0:null===(r=o.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.drafts)||void 0===l?void 0:l.delete({userId:"me",id:e}))}catch(e){throw console.error(e),e}},I=async e=>{var t,l,i,n,r;let o=null===(t=window)||void 0===t?void 0:t.gapi;try{return await (null==o?void 0:null===(r=o.client)||void 0===r?void 0:null===(n=r.gmail)||void 0===n?void 0:null===(i=n.users)||void 0===i?void 0:null===(l=i.messages)||void 0===l?void 0:l.send({userId:"me",resource:e.resource}))}catch(e){throw console.error(e),e}}},39635:function(e,t,l){"use strict";l.d(t,{b:function(){return i}});let i=()=>window.matchMedia("(pointer: coarse)").matches},70137:function(e,t,l){"use strict";l.d(t,{Cz:function(){return s},Nu:function(){return o},TF:function(){return r},Wz:function(){return i},je:function(){return n},m8:function(){return d},wb:function(){return a}});let i={AccountSettingsAndSupport:{title:"Account, Settings, and Support"},AddOrChangeLabel:{title:"Add or Change Label",keys:["L"]},Archive:{title:"Archive Conversation",keys:["E"]},AttachFile:{title:"Attach File",keys:["⌘","⇧","A"]},AttachmentDownload:{title:"Download Attachment"},AttachmentOpen:{title:"Open Attachment"},Back:{title:"Back",keys:["Esc"]},Bold:{title:"Bold",keys:["⌘","B"]},BoldMarkdown:{title:"Bold",keys:["**text**","__text__"]},BulletedList:{title:"Bulleted List",keys:["⌘","⇧","7"]},BulletedListMarkdown:{title:"Bulleted List",keys:["*","Space"]},ChangeTheme:{title:"Change Theme",keys:["Ctrl","⌥","D"]},ClearSelection:{title:"Clear Selection",keys:["Esc"]},ClearHistory:{title:"Clear Search History",keys:["Esc"]},Close:{title:"Close",keys:["Esc"]},ColorText:{title:"Color Text",keys:["⌘","O"]},ComposeMessage:{title:"Compose Message",keys:["C"]},CopyBccAddress:{title:"Copy BCC Address"},CopyCcAddress:{title:"Copy CC Address"},CopyConversationURL:{title:"Copy Conversation URL",keys:["⌘","⇧",","]},CopyCurrentURL:{title:"Copy Current URL",keys:["⌘","⇧","C"]},CopyDateReceived:{title:"Copy Date Received"},CopyLink:{title:"Copy Link"},CopyRecipientAddress:{title:"Copy Recipient's Address"},CopyAllRecipientAddresses:{title:"Copy All Recipient Addresses"},CopySendersAddress:{title:"Copy Sender's Address",keys:["⌘","⇧","."]},CopyAllSenderAddresses:{title:"Copy All Sender Addresses"},CopySendersName:{title:"Copy Sender's Name",keys:["⌘","."]},CopySubject:{title:"Copy Subject",keys:["⌘","⇧","'"]},CycleNextLink:{title:"Cycle to Next Link",keys:["Tab"]},CyclePreviousLink:{title:"Cycle to Previous Link",keys:["⇧","Tab"]},Delete:{title:"Delete Conversation",keys:["⌘","⌫"]},DeleteLabel:{title:"Delete Label"},DeleteSplit:{title:"Delete Split Inbox"},DownloadFile:{title:"Download File"},Draft:{title:"Draft",keys:["D"]},EditLabel:{title:"Edit Label"},ExpandCompose:{title:"Expand Compose Editor",keys:["Ctrl","⇧","F"]},FindInView:{title:"Find in View",keys:["⌘","F"]},FitToWidth:{title:"Fit to Width"},Forward:{title:"Forward Message",keys:["F"]},GoToArchive:{title:"Go to Archive",keys:["G","A"]},GoToDrafts:{title:"Go to Drafts",keys:["G","D"]},GoToInbox:{title:"Go to Inbox",keys:["G","I"]},GoToLabels:{title:"Go to Labels",keys:["G","L"]},GoToSent:{title:"Go to Sent",keys:["G","E"]},GoToSettings:{title:"Go to Settings",keys:["G","N"]},GoToSpam:{title:"Go to Spam",keys:["G","P"]},GoToStarred:{title:"Go to Starred",keys:["G","S"]},GoToTrash:{title:"Go to Trash",keys:["G","T"]},HideCC:{title:"Hide CC / BCC",keys:["⌘","⇧","B"]},HideLeftSidebar:{title:"Hide Left Sidebar",keys:["["]},HideMessageDetails:{title:"Hide Message Details",keys:["⌘","⇧","O"]},HideMessageHistory:{title:"Hide Message History",keys:["O"]},HideRightSidebar:{title:"Hide Right Sidebar",keys:["]"]},HighlightText:{title:"Highlight Text",keys:["⌘","⇧","H"]},Hyperlink:{title:"Hyperlink",keys:["⌘","K"]},IndentList:{title:"Indent List",keys:["Tab"]},InsertEmoji:{title:"Insert Emoji",keys:[":emoji"]},InsertSnippet:{title:"Insert Snippet",keys:[";"]},Italicize:{title:"Italicize",keys:["⌘","I"]},ItalicizeMarkdown:{title:"Italicize",keys:["*text*","_text_"]},JumpToBottom:{title:"Jump to Bottom",keys:["⌘","↓"]},JumpToTop:{title:"Jump to Top",keys:["⌘","↑"]},LargeHeaderMarkdown:{title:"Large Header",keys:["#","Space"]},MarkAllRead:{title:"Mark All as Read",keys:["⌥","U"]},MarkRead:{title:"Mark Conversation Read",keys:["U"]},MarkSpam:{title:"Mark Conversation Spam",keys:["!"]},MarkUnread:{title:"Mark Conversation Unread",keys:["U"]},MediumHeaderMarkdown:{title:"Medium Header",keys:["##","Space"]},MinimizeCompose:{title:"Minimize Compose Editor",keys:["Ctrl","⇧","F"]},MoreOptions:{title:"More Options"},MoveConversation:{title:"Move Conversation",keys:["M"]},MoveDown:{title:"Move Down",keys:["↓","J"]},MoveLeft:{title:"Move Left",keys:["←"]},MoveRight:{title:"Move Right",keys:["→"]},MoveUp:{title:"Move Up",keys:["↑","K"]},Mute:{title:"Mute Conversation",keys:["⇧","M"]},NextConversation:{title:"Next Conversation",keys:["J"]},NextSplitInbox:{title:"Next Split Inbox",keys:["Tab"]},NormalTextMarkdown:{title:"Normal Text",keys:["####","Space"]},NumberedList:{title:"Numbered List",keys:["⌘","⇧","8"]},NumberedListMarkdown:{title:"Numbered List",keys:["1.","Space"]},OpenAll:{title:"Open All Threaded Messages",keys:["⇧","⌥","O"]},OpenCommandMenu:{title:"Open Command Menu",keys:["⌘","K"]},OpenConversation:{title:"Open Conversation"},OpenFocusedItem:{title:"Open Focused Item",keys:["Enter","O"]},OpenHelpCenter:{title:"Open Help Center",keys:["?"]},OpenInNewWindow:{title:"Open in New Window"},OpenInNewTab:{title:"Open in New Tab"},OpenLabel:{title:"Open Label"},OpenLinksAndAttachments:{title:"Open Links and Attachments",keys:["⌘","O"]},OutdentList:{title:"Outdent List",keys:["⇧","Tab"]},PreviousConversation:{title:"Previous Conversation",keys:["K"]},PreviousSplitInbox:{title:"Previous Split Inbox",keys:["⇧","Tab"]},PrintFile:{title:"Print File",keys:["⌘","P"]},QuickLook:{title:"Quick Look (Click or Press and Hold)",keys:["Space"]},Quote:{title:"Quote",keys:["⌘","⇧","9"]},QuoteMarkdown:{title:"Quote",keys:[">","Space"]},RedoAction:{title:"Redo Action",keys:["⌘","⇧","Z"]},RemindMe:{title:"Remind Me (Snooze)",keys:["H"]},RemoveFormatting:{title:"Remove Formatting",keys:["⌘","\\"]},RemoveLabel:{title:"Remove Label",keys:["⇧","L"]},RemoveLink:{title:"Remove Link"},Reply:{title:"Reply to Sender",keys:["R"]},ReplyAll:{title:"Reply to All",keys:["Enter"]},ResetZoom:{title:"Reset Zoom"},ResizeText:{title:"Resize Text",keys:["⌘","⇧","6"]},Restore:{title:"Restore Conversation",keys:["⌘","⇧","⌫"]},ReturnHome:{title:"Return Home",keys:["⌘","Esc"]},SaveSplitInbox:{title:"Save Split Inbox",keys:["⌘","Enter"]},SearchFile:{title:"Search File",keys:["⌘","F"]},SearchMail:{title:"Search Mail",keys:["/"]},SelectAboveConversation:{title:"Select Above Conversation",keys:["⇧","↑"]},SelectAboveConversationAlt:{title:"Select Above Conversation",keys:["⇧","K"]},SelectAllAboveConversations:{title:"Select All Above Conversations",keys:["⌘","⇧","↑"]},SelectAllBelowConversations:{title:"Select All Below Conversations",keys:["⌘","⇧","↓"]},SelectAllConversations:{title:"Select All Conversations",keys:["⌘","A"]},SelectBelowConversation:{title:"Select Below Conversation",keys:["⇧","↓"]},SelectBelowConversationAlt:{title:"Select Below Conversation",keys:["⇧","J"]},SelectConversation:{title:"Select Conversation",keys:["X"]},SelectConversationAlt:{title:"Select Conversation",keys:["⇧","Click"]},SendAndArchive:{title:"Send Message and Archive Conversation",keys:["⌘","⇧","Enter"]},SendLater:{title:"Send Message Later",keys:["⌘","⇧","L"]},SendMessage:{title:"Send Message",keys:["⌘","Enter"]},ShowCC:{title:"Show CC / BCC",keys:["⌘","⇧","B"]},ShowLeftSidebar:{title:"Show Left Sidebar",keys:["["]},ShowMessageDetails:{title:"Show Message Details",keys:["⌘","⇧","O"]},ShowMessageHistory:{title:"Show Message History",keys:["O"]},ShowRightSidebar:{title:"Show Right Sidebar",keys:["]"]},ShowViewOptions:{title:"Show View Options",keys:["V"]},SlashCommands:{title:"Slash Commands",keys:["/"]},SmallHeaderMarkdown:{title:"Small Header",keys:["###","Space"]},Star:{title:"Star Conversation",keys:["S"]},Strikethrough:{title:"Strikethrough",keys:["⌘","⇧","X"]},StrikethroughMarkdown:{title:"Strikethrough",keys:["~text~","~~text~~"]},Submit:{title:"Submit",keys:["⌘","Enter"]},SubmitMessage:{title:"Submit Message",keys:["⌘","Enter"]},SubmitFeedback:{title:"Submit Feedback",keys:["⌘","Enter"]},SwitchAccount:{title:"Switch Account",keys:["Ctrl","1-9"]},ToggleThreadedMessage:{title:"Open / Close Threaded Message",keys:["⇧","O"]},Unarchive:{title:"Unarchive Conversation",keys:["⇧","E"]},Undelete:{title:"Undelete Conversation",keys:["⌘","⇧","⌫"]},Underline:{title:"Underline",keys:["⌘","U"]},UndoAction:{title:"Undo Action",keys:["⌘","Z"]},Unspam:{title:"Unmark Conversation Spam",keys:["⌘","!"]},Unstar:{title:"Unstar",keys:["S"]},Unsubscribe:{title:"Unsubscribe (Opt Out)",keys:["⌘","U"]},UseSnippet:{title:"Use Snippet"},UseSnippetReply:{title:"Use Snippet in Reply",keys:["⌘",";"]},VisitWebsite:{title:"Visit Website"},ZoomIn:{title:"Zoom In"},ZoomOut:{title:"Zoom Out"}},n=[{id:"INBOX",name:"Inbox",shortcut:["G","I"],emptyPlaceholder:"You have no active conversations. Congratulations, that means you’ve reached inbox zero! Keep it up to make it a habit."},{id:"STARRED",name:"Starred",shortcut:["G","S"],emptyPlaceholder:"You have no starred conversations. To star a conversation, press S, click the “Star” button, or select “Star” in the command menu."},{id:"DRAFT",name:"Drafts",shortcut:["G","D"],emptyPlaceholder:"You have no draft messages. To create a new draft, press C, click the “Compose” button, or select “Compose” in the command menu."},{id:"SENT",name:"Sent",shortcut:["G","E"],emptyPlaceholder:"You have no sent messages. To reply to a message, press R, click the “Reply” button, or select “Reply” in the command menu."},{id:"ARCHIVE",name:"Archive",shortcut:["G","A"],emptyPlaceholder:"You have no archived conversations. To archive a conversation, press E, click the “Archive” button, or select “Archive” in the command menu."},{id:"SPAM",name:"Spam",shortcut:["G","P"],emptyPlaceholder:"You have no spam conversations. To mark a conversation as spam, press !, click the “Spam” button, or select “Spam” in the command menu."},{id:"TRASH",name:"Trash",shortcut:["G","T"],emptyPlaceholder:"You have no deleted conversations. To delete a conversation, press ⌘⌫, click the “Delete” button, or select “Delete” in the command menu."},{id:"Labels",name:"Labels",shortcut:["G","L"]}],r=["INBOX","STARRED","DRAFT","SENT","ARCHIVE","SPAM","TRASH"],o=[["bg-yellow-700 dark:bg-yellow-dark-700","bg-yellow-600 dark:bg-yellow-dark-600","bg-yellow-500 dark:bg-yellow-dark-500"],["bg-blue-700 dark:bg-blue-dark-700","bg-blue-600 dark:bg-blue-dark-600","bg-blue-500 dark:bg-blue-dark-500"],["bg-pink-700 dark:bg-pink-dark-700","bg-pink-600 dark:bg-pink-dark-600","bg-pink-500 dark:bg-pink-dark-500"],["bg-orange-700 dark:bg-orange-dark-700","bg-orange-600 dark:bg-orange-dark-600","bg-orange-500 dark:bg-orange-dark-500"],["bg-green-700 dark:bg-green-dark-700","bg-green-600 dark:bg-green-dark-600","bg-green-500 dark:bg-green-dark-500"],["bg-red-700 dark:bg-red-dark-700","bg-red-600 dark:bg-red-dark-600","bg-red-500 dark:bg-red-dark-500"],["bg-purple-700 dark:bg-purple-dark-700","bg-purple-600 dark:bg-purple-dark-600","bg-purple-500 dark:bg-purple-dark-500"]],a=[[{sender:"Figma",subject:"Upgrade request from Jon Low",body:"Jon Low (jon@tatem.com) would like an upgraded Figma Design seat in the Tatem team",image:"/inbox/empty/figma.png"},{sender:"Emily Davis",subject:"March 28 Meeting Update",body:"Hey Chris - This is just to let you know that the location of your meeting with Matt Howard has been moved to...",image:"/inbox/empty/emily.png"},{sender:"Browser Company",subject:"The Verge: “Arc is the Chrome replacement I’ve been waiting for”",body:"You’re invited to try the internet’s favorite browser",image:"/inbox/empty/browser.png"},{sender:"Brandon Nguyen",subject:"Collaboration Opportunity in AI Integration",body:"Dear Christopher, I've identified a specific opportunity for collaboration in integrating AI into our respective companies",image:"/inbox/empty/brandon.png"},{sender:"Maya Jackson",subject:"TATEM WAITLIST!!!",body:"Is there any way to get off the waitlist? I LOVE your website",image:"/inbox/empty/maya.png"}],[{sender:"Zoe Johnson",subject:"I need your help",body:"Hey Chris - Sorry for the urgent subject, but I really need your help?",image:"/inbox/empty/zoe.png"},{sender:"Loom",subject:"Your video has been viewed: Slash Commands Bug",body:"Slash Commands Bug was watched for the first time! Viewed by Jon",image:"/inbox/empty/loom.png"},{sender:"Jacob Mitchell",subject:"Catch Up Soon?",body:"Hey man, it's been a while! Let's catch up soon, maybe over coffee or a quick call",image:"/inbox/empty/jacob.png"},{sender:"Olivia Kim",subject:"Rippling PEO",body:"Hey Christopher - I just wanted to reiterate the 90 day deadline for the quote that we provided on the Zoom call a couple weeks back.",image:"/inbox/empty/olivia.png"},{sender:"Github",subject:"[GitHub] New requests from members for draft pull requests",body:"You have 2 new requests from members for draft pull requests",image:"/inbox/empty/github.png"}],[{sender:"Jacob Mitchell",subject:"Catch Up Soon?",body:"Hey man, it's been a while! Let's catch up soon, maybe over coffee or a quick call",image:"/inbox/empty/jacob.png"},{sender:"Megan Daust",subject:"Let’s Forge a Partnership!",body:"Hey there, it’s Megan. I’ve been following your work and I’m genuinely impressed. I believe there’s a fantastic opportunity",image:"/inbox/empty/megan.png"},{sender:"Zoom",subject:"Thomas Chen has joined your Personal Meeting Room",body:"Hi Christopher, Thomas Chen has joined your Personal Meeting Room.",image:"/inbox/empty/zoom.png"},{sender:"Vercel",subject:"[Update] Vercel Terms of Service and New Subprocessors",body:"We have updated our Terms of Service to reflect new feature developments and product expansion. Notable updates include:",image:"/inbox/empty/vercel.png"},{sender:"Linear",subject:"3 unread notifications on Tatem",body:"You have 3 unread notifications on Linear.",image:"/inbox/empty/linear.png"}],[{sender:"Linear",subject:"3 unread notifications on Tatem",body:"You have 3 unread notifications on Linear.",image:"/inbox/empty/linear.png"},{sender:"Zoom",subject:"Elwin Wang has joined your Personal Meeting Room",body:"Hi Christopher, Elwin Wang has joined your Personal Meeting Room.",image:"/inbox/empty/zoom.png"},{sender:"Ava Perelli",subject:"Tatem <> Accel Partners",body:"Hey Chris - This is Ava from Accel. We last spoke a couple months ago, and I wanted to follow back up to see if now would be a good time to reconnect?",image:"/inbox/empty/ava.png"},{sender:"Chad Donahue",subject:"Do you have time this week for me to show you what I’ve been working on?",body:"The subject says it all. Really want your thoughts... Don’t really have any other friends who are founders except you.",image:"/inbox/empty/chad.png"},{sender:"Linear",subject:"2 unread notifications on Tatem",body:"You have 2 unread notifications on Linear.",image:"/inbox/empty/linear.png"}],[{sender:"Zoom",subject:"Jonathan Low has joined your Personal Meeting Room",body:"Hi Christopher, Jonathan Low has joined your Personal Meeting Room.",image:"/inbox/empty/zoom.png"},{sender:"Linear",subject:"3 unread notifications on Tatem",body:"You have 3 unread notifications on Linear.",image:"/inbox/empty/linear.png"},{sender:"Haley Christiansen",subject:"Want to switch our team over to Tatem Mail",body:"Hello to the Tatem team! I’m a daily user, and am a huge fan(girl) of the product (and your super-sleek website!)",image:"/inbox/empty/haley.png"},{sender:"Xavier Lee",subject:"Tatem Backend Position",body:"Hello Team Tatem, I’m reaching out to express my interest in the Backend Engineering Position I saw on LinkedIn.",image:"/inbox/empty/xavier.png"},{sender:"Hasan Ali",subject:"DTLA Dinner on the 4th",body:"You free? I can get us an early reservation at Majordomo that night, and afterwards we can just hangout / grab dessert or whatever",image:"/inbox/empty/hasan.png"}],[{sender:"Emily Davis",subject:"March 28 Meeting Update",body:"Hey Chris - This is just to let you know that the location of your meeting with Matt Howard has been moved to...",image:"/inbox/empty/emily.png"},{sender:"Zoom",subject:"Thomas Chen has joined your Personal Meeting Room",body:"Hi Christopher, Thomas Chen has joined your Personal Meeting Room.",image:"/inbox/empty/zoom.png"},{sender:"Haley Christiansen",subject:"Still on for Thursday?",body:"Hey Christopher - You haven’t replied to the calendar invite yet, so just wanted to confirm that day / time still works for you?",image:"/inbox/empty/amber.png"},{sender:"Hasan Ali",subject:"DTLA Dinner on the 4th",body:"You free? I can get us an early reservation at Majordomo that night, and afterwards we can just hangout / grab dessert or whatever",image:"/inbox/empty/hasan.png"},{sender:"Browser Company",subject:"The Verge: “Arc is the Chrome replacement I’ve been waiting for”",body:"You’re invited to try the internet’s favorite browser",image:"/inbox/empty/browser.png"}],[{sender:"Ava Perelli",subject:"Tatem <> Accel Partners",body:"Hey Chris - This is Ava from Accel. We last spoke a couple months ago, and I wanted to follow back up to see if now would be a good time to reconnect?",image:"/inbox/empty/ava.png"},{sender:"Linear",subject:"3 unread notifications on Tatem",body:"You have 3 unread notifications on Linear.",image:"/inbox/empty/linear.png"},{sender:"Marcus Matheson",subject:"February Bookkeeping Discussion",body:"Hey Chris - I was wondering if we could sync on the issue that you reached out to us about via email last week",image:"/inbox/empty/marcus.png"},{sender:"Chad Donahue",subject:"Do you have time this week for me to show you what I’ve been working on?",body:"The subject says it all. Really want your thoughts... Don’t really have any other friends who are founders except you.",image:"/inbox/empty/chad.png"},{sender:"Linear",subject:"2 unread notifications on Tatem",body:"You have 2 unread notifications on Linear.",image:"/inbox/empty/linear.png"}],[{sender:"Jacob Mitchell",subject:"Catch Up Soon?",body:"Hey man, it's been a while! Let's catch up soon, maybe over coffee or a quick call",image:"/inbox/empty/jacob.png"},{sender:"Brandon Nguyen",subject:"Collaboration Opportunity in AI Integration",body:"Dear Christopher, I've identified a specific opportunity for collaboration in integrating AI into our respective companies",image:"/inbox/empty/brandon.png"},{sender:"Linear",subject:"2 unread notifications on Tatem",body:"You have 2 unread notifications on Linear.",image:"/inbox/empty/linear.png"},{sender:"Maya Jackson",subject:"TATEM WAITLIST!!!",body:"Is there any way to get off the waitlist? I LOVE your website",image:"/inbox/empty/maya.png"},{sender:"Browser Company",subject:"The Verge: “Arc is the Chrome replacement I’ve been waiting for”",body:"You’re invited to try the internet’s favorite browser",image:"/inbox/empty/browser.png"}]],d={"bg-red-300":"#efa093","bg-red-400":"#fb4c2f","bg-red-500":"#cc3a21","bg-red-600":"#ac2b16","bg-orange-300":"#ffd6a2","bg-orange-400":"#ffad47","bg-orange-500":"#eaa041","bg-orange-600":"#cf8933","bg-yellow-300":"#fce8b3","bg-yellow-400":"#fad165","bg-yellow-500":"#f2c960","bg-yellow-600":"#d5ae49","bg-green-300":"#89d3b2","bg-green-400":"#16a766","bg-green-500":"#149e60","bg-green-600":"#0b804b","bg-blue-300":"#a4c2f4","bg-blue-400":"#4a86e8","bg-blue-500":"#3c78d8","bg-blue-600":"#285bac","bg-purple-300":"#d0bcf1","bg-purple-400":"#a479e2","bg-purple-500":"#8e63ce","bg-purple-600":"#653e9b","bg-pink-300":"#fbc8d9","bg-pink-400":"#f691b3","bg-pink-500":"#e07798","bg-pink-600":"#b65775"},s=Object.fromEntries(Object.entries(d).map(e=>e.reverse()))},60136:function(e,t,l){"use strict";l.d(t,{H:function(){return n}});var i=l(3984);let n=()=>{var e,t;let{supabaseStore:l}=(0,i.m)();return l.workspaceData&&(null===(e=l.workspaceData)||void 0===e?void 0:e.type)!=="individual"?"/".concat(null===(t=l.workspaceData)||void 0===t?void 0:t.url,"/mail"):"/mail"}},71451:function(e,t,l){"use strict";l.d(t,{e:function(){return n}});var i=l(57031);function n(){return(0,i.createBrowserClient)("https://pchmfhxpaothitzgvbif.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBjaG1maHhwYW90aGl0emd2YmlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg3NTE2ODMsImV4cCI6MjAwNDMyNzY4M30.IlKU9xyWsWgKc-1ejMSk_dPlqQnSSZM8W19Wi9pAO0s")}},48804:function(e,t,l){"use strict";l.d(t,{Y:function(){return f}});var i=l(44003),n=l(25441),r=l(70137),o=l(44424),a=l(63372),d=l(39359),s=l(87355),u=l(50026),c=l(31097),v=l(61808),m=l.n(v),p=l(1394),h=l(62516);let f=(0,p.Pi)(e=>{var t,l,v,p;let{attachment:f,idx:g,isUploading:b,removeAttachment:y,message:x}=e,k=(0,h.useMemo)(()=>{var e,t;return(null==f?void 0:null===(t=f.raw)||void 0===t?void 0:null===(e=t.body)||void 0===e?void 0:e.size)>n.Tb},[f]),[w,C]=(0,h.useState)(!1),S=(0,h.useCallback)(()=>{(null==f?void 0:f.data)?f.filename&&f.mimeType&&(null==f?void 0:f.data)&&(0,c.lS)(f.mimeType,null==f?void 0:f.data,f.filename):(C(!0),(0,o.ce)({part:null==f?void 0:f.raw,message:x}).then(e=>{var t,l;C(!1),f.filename&&f.mimeType&&(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.data)&&(0,c.lS)(f.mimeType,null==e?void 0:null===(l=e.result)||void 0===l?void 0:l.data,f.filename)}).catch(e=>{console.error(e)}))},[null==f?void 0:f.mimeType]);return(0,i.jsxs)("div",{className:m()("group relative flex cursor-default items-center justify-between gap-x-2 rounded-lg border border-border-primary p-1 hover:bg-fill-primary dark:border-border-dark-primary dark:hover:bg-fill-dark-primary"),children:[(0,i.jsxs)("div",{className:"flex flex-row gap-x-2",children:[(0,i.jsx)("div",{className:m()("flex h-8 w-8 items-center justify-center rounded bg-fill-primary font-mono text-xs font-bold tabular-nums tracking-tighter dark:bg-fill-dark-primary",null!==(p=null==f?void 0:f.fileColor)&&void 0!==p?p:"text-tertiary dark:text-tertiary-dark"),children:null===(t=f.extension)||void 0===t?void 0:t.toUpperCase()}),(0,i.jsxs)("div",{className:m()("flex flex-col items-start gap-0.5"),children:[(0,i.jsx)("div",{className:"flex items-center justify-start text-body text-secondary group-hover:text-primary dark:text-secondary-dark dark:group-hover:text-primary-dark",children:k?(0,i.jsx)("span",{className:"text-red-500 dark:text-red-dark-500",children:"Exceeds File Limit Size"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"max-w-[90px] truncate",title:f.filename,children:(null==f?void 0:null===(l=f.filename)||void 0===l?void 0:l.substring(0,f.filename.lastIndexOf(".")))||""}),(0,i.jsxs)("span",{className:"",children:[".",(null===(v=f.filename)||void 0===v?void 0:v.split(".").pop())||""]})]})}),(0,i.jsx)("div",{className:"text-support text-quartery dark:text-quartery-dark",children:f.size})]})]}),b?(0,i.jsx)("div",{className:"flex h-8 w-8 items-center justify-center",children:(0,i.jsx)(s.J,{path:u.N.Sync,className:"animate-spin"})}):(0,i.jsxs)(i.Fragment,{children:[y&&(0,i.jsx)(d.z,{icon:u.N.Close,className:"opacity-0 group-hover:opacity-100",variant:"tertiary",onClick:()=>y&&y(g)}),!!x&&(0,i.jsxs)("div",{className:"relative",onMouseEnter:()=>{let e=document.getElementById("attachment-".concat(f.filename));e&&(e.className="")},onMouseLeave:()=>{let e=document.getElementById("attachment-".concat(f.filename));e&&(e.className="peer")},children:[(0,i.jsx)(d.z,{className:"peer",icon:w?u.N.Sync:(null==f?void 0:f.error)?u.N.Alert:u.N.Download,iconClassName:w?"animate-spin":"",variant:"tertiary",onClick:e=>{e.stopPropagation(),S()}}),(0,i.jsx)(a.M,{...r.Wz.AttachmentDownload,position:"top-[41px] -left-14 z-[11]"})]})]})]},g)})},8562:function(e,t,l){"use strict";l.d(t,{X:function(){return d},f:function(){return s}});var i=l(44003),n=l(70137),r=l(61808),o=l.n(r),a=l(87502);let d="px-2 py-1 dark:hover:bg-fill-dark-primary rounded flex items-center gap-1.5 hover:bg-fill-primary border border-border-primary dark:border-border-dark-primary",s=e=>{var t;let{userLabel:l,href:r,className:s}=e,u=n.Cz[null==l?void 0:null===(t=l.color)||void 0===t?void 0:t.backgroundColor];return(0,i.jsxs)(a.default,{draggable:"false",href:r,className:o()("body h-6 cursor-pointer",d,s),children:[(0,i.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-full "+(u||"bg-red-500")}),(0,i.jsx)("span",{className:"truncate",children:null==l?void 0:l.name})]})}},1918:function(e,t,l){"use strict";l.d(t,{w:function(){return d},x:function(){return u}});var i=l(44003),n=l(39635),r=l(61808),o=l.n(r),a=l(62516);let d=e=>{var t,l,r,d,s;let{suggestions:c,focusIndex:v,typedValue:m,showSuggestions:p,selectedContacts:h,onSelect:f,setFocusIndex:g,setIsMouseInsideSuggestionList:b,inputRef:y}=e,[x,k]=(0,a.useState)(),w=(0,a.useRef)(null);if((0,a.useEffect)(()=>{y.current&&c.length>0&&k(y.current.getBoundingClientRect())},[null==c?void 0:c.length]),void 0===c||0===c.length||!p)return null;let C=1===c.length&&"manual"===c[0].sourceType,S=window.innerWidth-(null!==(r=null==x?void 0:x.left)&&void 0!==r?r:0)-Math.min(400,null!==(d=null==w?void 0:null===(t=w.current)||void 0===t?void 0:t.clientWidth)&&void 0!==d?d:0)>20;return(0,i.jsx)("ul",{className:o()("mt-1 flex-col rounded-lg bg-fill-overlay shadow-layer-sm backdrop-blur-menu dark:bg-fill-dark-overlay dark:shadow-control-dark","sm:absolute sm:max-h-[284px] sm:w-auto sm:max-w-[400px]","fixed w-[95%]",{hidden:!m}),ref:w,style:{right:window.innerWidth<640?"2.5%":S?"auto":"-".concat(window.innerWidth-(null!==(s=null==x?void 0:x.right)&&void 0!==s?s:0)-12,"px"),left:window.innerWidth<640?"2.5%":S?"0":"auto",opacity:(null==w?void 0:null===(l=w.current)||void 0===l?void 0:l.clientWidth)?1:0},onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:(0,i.jsx)("div",{className:"mx-1 my-1 flex flex-col gap-y-0.5",children:c.map((e,t)=>{let l=null==h?void 0:h.some(t=>t.emailAddress===e.emailAddress);return(0,i.jsx)("li",{className:o()("flex h-11 w-full cursor-pointer items-center justify-start rounded pt-0.5",{"bg-fill-primary dark:bg-fill-dark-primary":t===v}),onClick:()=>f(e),onMouseMove:e=>{if((0,n.b)()){e.preventDefault();return}g(t)},children:(0,i.jsx)("div",{className:"flex h-[34px] min-w-0 max-w-full items-center px-2 py-[5px]",children:(0,i.jsxs)("div",{className:"flex min-w-0 max-w-full flex-col items-start gap-y-1 whitespace-nowrap",children:[(0,i.jsx)(u,{alwaysOnSuggestion:C,displayContent:e.name,pattern:m,isEmailAddress:!1,isSelected:l}),(0,i.jsx)(u,{alwaysOnSuggestion:C,displayContent:e.emailAddress,pattern:m,isEmailAddress:!0,isSelected:l})]})})},e.emailAddress)})})})},s=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),u=e=>{let{displayContent:t,pattern:l,isEmailAddress:n=!1,isSelected:r=!1,alwaysOnSuggestion:a=!1,isSearchPage:d=!1}=e;if(r)return(0,i.jsx)("span",{className:"max-w-full truncate text-body font-normal text-muted dark:text-muted-dark",children:t});if(a)return(0,i.jsx)("span",{className:o()("line-clamp-1 h-full",{"h-4 text-body text-primary dark:text-primary-dark":!n},{"h-3.5 text-support text-tertiary dark:text-tertiary-dark":n}),children:t});let u=l.trim(),c=u?RegExp("(".concat(s(u),")"),"gi"):null;if(!c)return(0,i.jsx)("span",{className:o()("line-clamp-1 h-full font-medium",{"h-4 text-body text-primary dark:text-primary-dark":!n},{"h-3.5 text-support text-tertiary dark:text-tertiary-dark":n}),children:t});let v=t.split(c).filter(e=>""!==e);return(0,i.jsx)("div",{className:o()({"min-w-0 max-w-full":!d},{"h-full text-body font-medium":!n&&d},{"h-4 text-body text-primary dark:text-primary-dark":!n&&!d},{"h-3.5 text-support text-tertiary dark:text-tertiary-dark":n&&!d}),children:(0,i.jsx)("div",{className:o()({"line-clamp-1 flow-root min-w-0 max-w-full text-ellipsis break-all text-quartery dark:text-quartery-dark":!d},{truncate:d}),children:v.map((e,t)=>c.test(e)?(0,i.jsx)("span",{className:o()("text-primary dark:text-primary-dark",{truncate:t===v.length-1}),children:e},t):(0,i.jsx)("span",{className:o()("text-quartery dark:text-quartery-dark"),children:e},t))})})}},83965:function(e,t,l){"use strict";l.d(t,{MobxWrapper:function(){return X},x:function(){return J}});var i=l(44003),n=l(17157);class r{constructor(){this.pages=[],this.lastViewedThread="",this.isCommandMenuOpen=!1,this.searchInput="",this.lastSearchQuery="",this.openedExternally=!1,this.setPages=e=>{this.pages=e},this.setSearchInput=e=>{this.searchInput=e},this.setCommandMenuOpen=e=>{this.isCommandMenuOpen=e},this.setLastViewedThread=e=>{this.lastViewedThread=e},this.setLastSearchQuery=e=>{this.lastSearchQuery=e},this.setOpenedExternally=e=>{this.openedExternally=e},this.resetCommandMenu=()=>{this.searchInput="",this.lastSearchQuery="",this.pages=[],this.isCommandMenuOpen=!1,this.openedExternally=!1},this.runCommand=e=>{e(),this.resetCommandMenu()},(0,n.ky)(this)}}let o=new r,a={recipient:[],cc:[],bcc:[],subject:"",message:"",forwardedMessage:"",attachments:[],type:""};class d{constructor(){this.emailData=a,this.currentFocusedContact=null,this.updateEmailData=e=>{"function"==typeof e?this.emailData=e(this.emailData):this.emailData={...this.emailData,...e}},this.resetEmailData=()=>{this.emailData=a},this.setCurrentFocusedContact=e=>{this.currentFocusedContact=e},(0,n.ky)(this)}}let s=new d;var u=l(71451);class c{constructor(){this.gapiLoaded=!1,this.gapiInitialized=!1,this.setGapiLoaded=e=>{this.gapiLoaded=e},this.setGapiInitialized=e=>{this.gapiInitialized=e},this.initGapi=async()=>{var e;let t=["https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest","https://www.googleapis.com/discovery/v1/apis/people/v1/rest"],l=null===(e=window)||void 0===e?void 0:e.gapi,i=(0,u.e)();try{let{data:{session:e}}=await i.auth.getSession();null==l||l.load("client",async()=>{var n,r,o,a,d,s,u,c;await (null==l?void 0:null===(n=l.client)||void 0===n?void 0:n.init({apiKey:"AIzaSyC9VfI_3hu0fRShGlMtLJamhr46b4YE1OY",discoveryDocs:t}));let v=null!==(u=null==e?void 0:e.provider_token)&&void 0!==u?u:null==e?void 0:null===(o=e.user)||void 0===o?void 0:null===(r=o.user_metadata)||void 0===r?void 0:r.pt,m=null!==(c=null==e?void 0:e.provider_refresh_token)&&void 0!==c?c:null==e?void 0:null===(d=e.user)||void 0===d?void 0:null===(a=d.user_metadata)||void 0===a?void 0:a.prt,p=!1,h=await fetch("https://www.googleapis.com/oauth2/v1/tokeninfo?access_token="+v),f=await h.json();if(null==f?void 0:f.error){let{data:e}=await i.functions.invoke("gapi-token-refresh",{body:{refreshToken:m}});if(e.error){await i.auth.signOut(),localStorage.clear(),await i.auth.refreshSession();return}v=null==e?void 0:e.access_token,p=!0}null==l||null===(s=l.client)||void 0===s||s.setToken({refresh_token:m,access_token:v}),this.setGapiInitialized(!0),((null==e?void 0:e.provider_token)&&(null==e?void 0:e.provider_refresh_token)||p)&&(await i.auth.updateUser({data:{pt:v,prt:m}}),await i.auth.refreshSession())})}catch(e){console.error(e)}},(0,n.ky)(this)}}let v=new c;var m=l(35184);class p{get isDbInitialized(){return!!this.db}constructor(e){this.db=null,this.userId=null,this.initDB=async e=>{if(this.userId===e&&this.db)return this.db;this.userId=e,(0,m.X3)("tatem-cache-".concat(e),1,{upgrade(e,t){if(0===t){let t=e.createObjectStore("mail",{keyPath:"id"});t.createIndex("labelId_sorted","labelId_sorted",{unique:!1,multiEntry:!0}),t.createIndex("labelIds","labelIds",{unique:!1,multiEntry:!0}),e.createObjectStore("label-users"),e.createObjectStore("transaction-queue"),e.createObjectStore("search-history"),e.createObjectStore("people-listdirectory"),e.createObjectStore("people-othercontacts"),e.createObjectStore("people-connection"),e.createObjectStore("people-syncStatus",{keyPath:"id"})}else console.error("Unknown db version")}}).then(e=>{this.db=e,this.rootStore.transactionStore.loadQueueFromCache()})},this.rootStore=e,(0,n.ky)(this)}}class h{constructor(){this.currentThread=null,this.composeOpen=!1,this.quickPreviewOpen=!1,this.emailData=[],this.isEmpty=!1,this.isInitializing=!1,this.setCurrentThread=e=>{this.currentThread=e},this.setComposeOpen=e=>{this.composeOpen=e},this.setQuickPreviewOpen=e=>{this.quickPreviewOpen=e},this.setIsEmpty=e=>{this.isEmpty=e},this.setIsInitializing=e=>{this.isInitializing=e},this.setEmailData=e=>{this.emailData=e},(0,n.ky)(this)}}let f=new h;class g{constructor(){this.currentArr=[],this.currentIndex=[],this.selectedIndices=[],this.currentThreadIndex=-1,this.isNavigationActivated=!1,this.setCurrentArr=e=>{this.currentArr=e},this.setCurrentIndex=e=>{"function"==typeof e?this.currentIndex=e(this.currentIndex):this.currentIndex=e},this.setSelectedIndices=e=>{this.selectedIndices=e},this.setCurrentThreadIndex=e=>{this.currentThreadIndex=e},this.setIsNavigationActivated=e=>{this.isNavigationActivated=e},(0,n.ky)(this)}}let b=new g;var y=l(62638),x=l(16502),k=l(27799);class w{constructor(){this.allContacts=[],this.fequentContacts=[],this.directoryContacts=[],this.connections=[],this.blockedSenders=[],this.loading=!1,this.error=null,this.setAllContacts=e=>{this.allContacts=e},this.updateAllContacts=e=>{let t=[...this.allContacts,...e];this.allContacts=(0,k.b1)(t)},this.removeFromAllContacts=e=>{this.allContacts=this.allContacts.filter(t=>t.id!==e)},this.setBlockedSenders=e=>{this.blockedSenders=e},this.loadContactsFromIndexedDB=async e=>{if(!e)return null;try{let[t,l,i]=await Promise.all([null==e?void 0:e.getAll("people-connection"),null==e?void 0:e.getAll("people-othercontacts"),null==e?void 0:e.getAll("people-listdirectory")]),n=[...t,...l,...i];return(0,k.b1)(n)}catch(e){return console.error("Error fetching data from IndexedDB:",e),null}},this.fetchContacts=async e=>{var t,l,i,n;let r,o,{listMethod:a,resourceName:d,readMask:s,sources:u,syncToken:c}=e,v=null===(t=window)||void 0===t?void 0:t.gapi;if(!v)return console.error("Google API is not available."),null;let m=[],p=0;try{do{let e;"connections"===a?e=await v.client.people.people.connections.list({resourceName:null!=d?d:"people/me",pageSize:999,personFields:s,requestSyncToken:!0,syncToken:c,pageToken:r}):"otherContacts"===a?e=await v.client.people.otherContacts.list({pageSize:999,readMask:s,requestSyncToken:!0,syncToken:c,pageToken:r}):"directoryContacts"===a&&(e=await v.client.people.people.listDirectoryPeople({pageSize:999,readMask:s,sources:null!=u?u:"DIRECTORY_SOURCE_TYPE_DOMAIN_PROFILE",requestSyncToken:!0,syncToken:c,pageToken:r}));let t=null==e?void 0:e.result;((null==t?void 0:t.connections)||(null==t?void 0:t.otherContacts)||(null==t?void 0:t.people))&&(m=m.concat(t.connections||t.otherContacts||t.people)),r=null==t?void 0:t.nextPageToken,p=(null==t?void 0:t.totalItems)||(null==t?void 0:t.totalSize)||0,(null==t?void 0:t.nextSyncToken)&&(o=t.nextSyncToken)}while(r);return{contacts:m,totalItems:p,nextSyncToken:o}}catch(e){if(console.error("Error fetching contacts:",e),"directoryContacts"===a)throw e;if(null==e?void 0:null===(n=e.result)||void 0===n?void 0:null===(i=n.error)||void 0===i?void 0:null===(l=i.details)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.reason)==="EXPIRED_SYNC_TOKEN"))return this.fetchContacts({listMethod:a,resourceName:d,readMask:s,sources:u,syncToken:void 0});return null}},this.fetchConnections=e=>this.fetchContacts({listMethod:"connections",resourceName:"people/me",readMask:"metadata,names,emailAddresses,photos",syncToken:e}),this.fetchFrequentContacts=e=>this.fetchContacts({listMethod:"otherContacts",readMask:"metadata,names,emailAddresses,photos",syncToken:e}),this.fetchDirectoryContacts=e=>this.fetchContacts({listMethod:"directoryContacts",readMask:"metadata,names,emailAddresses,photos",sources:"DIRECTORY_SOURCE_TYPE_DOMAIN_PROFILE",syncToken:e}),(0,n.ky)(this)}}let C=new w;class S{constructor(){this.searchInput="",this.searchQuery="",this.placeholder="",this.suggestions=[],this.searchHistory=[],this.showHistory=!0,this.currentFocusIndex=null,this.threads=[],this.isConnectorPresent=!1,this.isKeyboardNavActive=!1,this.resultSizeEstimate="",this.setResultSizeEstimate=e=>{this.resultSizeEstimate=e},this.setSearchInput=e=>{"function"==typeof e?this.searchInput=e(this.searchInput):this.searchInput=e},this.setSearchQuery=e=>{this.searchQuery=e},this.setPlaceholder=e=>{this.placeholder=e},this.setSuggestions=e=>{this.suggestions=e},this.setSearchHistory=e=>{"function"==typeof e?this.searchHistory=e(this.searchHistory):this.searchHistory=e},this.setShowHistory=e=>{this.showHistory=e},this.setCurrentFocusIndex=e=>{"function"==typeof e?this.currentFocusIndex=e(this.currentFocusIndex):this.currentFocusIndex=e},this.setThreads=e=>{this.threads=e},this.setIsConnectorPresent=e=>{this.isConnectorPresent=e},this.setIsKeyboardNavActive=e=>{this.isKeyboardNavActive=e},this.resetState=()=>{this.searchInput="",this.searchQuery="",this.placeholder="",this.suggestions=[],this.currentFocusIndex=null,this.isConnectorPresent=!1,this.isKeyboardNavActive=!1,this.showHistory=!0},(0,n.ky)(this)}}let I=new S,N=(e,t)=>{if(t){let t=localStorage.getItem(e);return!(window.innerWidth<1024)&&(!t||"true"===t)}return"true"===localStorage.getItem(e)};class T{constructor(){this.sidebarOpen=!1,this.rightSidebarOpen=!1,this.toggleLeftSidebar=()=>{this.sidebarOpen=!this.sidebarOpen},this.setLeftSidebarOpen=e=>{this.sidebarOpen=e},this.toggleRightSidebar=()=>{this.rightSidebarOpen=!this.rightSidebarOpen},this.setRightSidebarOpen=e=>{this.rightSidebarOpen=e},this.loadFromLocalStorage=()=>{(0,n.z)(()=>{this.sidebarOpen=N("sidebarOpen",!0),this.rightSidebarOpen=N("rightSidebarOpen",!1)})},(0,n.ky)(this)}}let j=new T;var E=l(7710);class M{constructor(){this.isOfflineMode=!1,this.syncStatus="ONLINE",this.setIsOfflineMode=e=>{this.isOfflineMode=e},this.setSyncStatus=e=>{this.syncStatus=e},(0,n.ky)(this)}}let A=new M;var D=l(30676),L=l(49222),R=l(70137),O=l(93629);class F{push(e){this.storage.push(e)}pop(){return this.storage.pop()}peek(){return this.storage[this.size()-1]}size(){return this.storage.length}clear(){this.storage=[]}constructor(){this.storage=[]}}var B=l(95470),z=l(83015);let _=[B.e.LabelThread,B.e.DeleteDraft,B.e.DeleteLabels],H=[B.e.LabelThread,B.e.BlockSender,B.e.UnblockSender],P=[B.e.EditDraft];function U(e,t){return t.timestamp.getTime()-e.timestamp.getTime()}class W{get isQueueEmpty(){return!this.queue.length}constructor(e){this.undoableTxStack=new F,this.redoableTxStack=new F,this.queue=[],this.isQueueRunning=!1,this.isQueueLoaded=!1,this.dequeue=()=>this.queue.shift(),this.peekQueue=()=>{var e;return null!==(e=this.queue.at(0))&&void 0!==e?e:void 0},this.enqueue=e=>{var t;let{transaction:l,isUndoOrRedo:i,rollbackFn:n,revalidateFn:r}=e,o=window.crypto.randomUUID(),a=new Date,d={...l,id:o,timestamp:a,rollbackFn:n,revalidateFn:r};i||(H.includes(d.type)&&this.undoableTxStack.push(d),this.redoableTxStack.clear()),null===(t=this.rootStore.idbStore.db)||void 0===t||t.put("transaction-queue",{...d,rollbackFn:void 0,revalidateFn:void 0},o),this.queue.push(d)},this.undo=()=>{var e,t,l,i,n,r,o;let a=[],d=null===(t=this.undoableTxStack)||void 0===t?void 0:null===(e=t.peek())||void 0===e?void 0:e.transactionLink;do{let e=null===(o=this.undoableTxStack)||void 0===o?void 0:o.pop();e&&a.push(e)}while(!!(null===(i=this.undoableTxStack)||void 0===i?void 0:null===(l=i.peek())||void 0===l?void 0:l.transactionLink)&&this.undoableTxStack.size()>0&&(null===(r=this.undoableTxStack)||void 0===r?void 0:null===(n=r.peek())||void 0===n?void 0:n.transactionLink)===d);let s=a.flatMap(e=>{let t;switch(e.type){case B.e.LabelThread:t={...e,isUndoOrRedo:!0,resource:{emailIds:e.resource.emailIds,addLabelIds:e.resource.removeLabelIds,removeLabelIds:e.resource.addLabelIds}};break;case B.e.UnblockSender:case B.e.BlockSender:t={...e,isUndoOrRedo:!0,type:e.type===B.e.BlockSender?B.e.UnblockSender:B.e.BlockSender}}return t?(this.redoableTxStack.push(e),t):(console.error("Failed to undo transaction.",e),[])});return(null==a?void 0:a.length)>0?{transactions:s,setReturnThread:e=>{var t;(null==a?void 0:null===(t=a[0])||void 0===t?void 0:t.type)===B.e.LabelThread&&(a[0].returnThread=e)}}:null},this.redo=()=>{var e,t,l,i,n,r,o;let a=[],d=null===(t=this.redoableTxStack)||void 0===t?void 0:null===(e=t.peek())||void 0===e?void 0:e.transactionLink;do{let e=null===(o=this.redoableTxStack)||void 0===o?void 0:o.pop();e&&(a.push(e),this.undoableTxStack.push(e))}while(!!(null===(i=this.redoableTxStack)||void 0===i?void 0:null===(l=i.peek())||void 0===l?void 0:l.transactionLink)&&this.redoableTxStack.size()>0&&(null===(r=this.redoableTxStack)||void 0===r?void 0:null===(n=r.peek())||void 0===n?void 0:n.transactionLink)===d);return(null==a?void 0:a.length)>0?{transactions:a,setReturnThread:e=>{(null==a?void 0:a[0].type)===B.e.LabelThread&&(a[0].returnThread=e)}}:null},this.loadQueueFromCache=async()=>{var e;this.rootStore.syncStore.setSyncStatus("SYNCING"),this.rootStore.syncStore.setIsOfflineMode(!0);let t=(this.rootStore.idbStore.db?await (null===(e=this.rootStore.idbStore.db)||void 0===e?void 0:e.getAll("transaction-queue")):[]).sort(U);(0,n.z)(()=>{t.length&&(this.queue=[...t,...this.queue]),this.isQueueLoaded=!0,this.rootStore.syncStore.setIsOfflineMode(!1)})},this.executeQueue=async()=>{let e=()=>!this.rootStore.syncStore.isOfflineMode&&("ONLINE"===this.rootStore.syncStore.syncStatus||"SYNCING"===this.rootStore.syncStore.syncStatus);if(!(!this.isQueueRunning&&this.isQueueLoaded)||!e())return;this.isQueueRunning=!0;let t=this.peekQueue();for(;t&&e();)_.includes(t.type)?this.executeAction(t):await this.executeAction(t),this.dequeue(),t=this.peekQueue();this.isQueueRunning=!1,"SYNCING"===this.rootStore.syncStore.syncStatus&&this.rootStore.syncStore.setSyncStatus("ONLINE")},this.executeAction=async e=>{var t,l,i,r,o,a,d,s;let u=!1;try{switch(null==e?void 0:e.type){case B.e.LabelThread:(null==e?void 0:e.resource.emailIds.length)&&(e.resource.emailIds=await this.resolveSwrOptimisticIds(e.resource.emailIds,e.threadIds),await (0,L.kw)({...e.resource,ids:e.resource.emailIds}),u=!0);break;case B.e.CreateLabel:let t=await (0,L._)({labelName:e.name,color:R.m8[e.tailwindColor]});if(this.rootStore.labelStore.setUserLabels([...this.rootStore.labelStore.userLabels,null==t?void 0:t.result]),(null==t?void 0:null===(i=t.result)||void 0===i?void 0:null===(l=i.id)||void 0===l?void 0:l.length)>0&&(await (null===(o=this.rootStore.idbStore.db)||void 0===o?void 0:o.put("label-users",{...null==t?void 0:t.result,count:0},null==t?void 0:null===(r=t.result)||void 0===r?void 0:r.id)),e.emailIds)){let l={addLabelIds:[null==t?void 0:null===(a=t.result)||void 0===a?void 0:a.id],removeLabelIds:[]};await (0,L.kw)({...l,ids:e.emailIds})}u=!0;break;case B.e.EditLabel:await (0,L.FB)({label:e.label}),u=!0;break;case B.e.DeleteLabels:let n=e.labels.map(e=>(0,L.SP)({label:e}));await Promise.all(n),u=!0;break;case B.e.CreateDraft:await this.createDraftAction(e),u=!0;break;case B.e.EditDraft:await this.editDraftAction(e),u=!0;break;case B.e.SendDraft:await this.sendDraftAction(e),u=!0;break;case B.e.DeleteDraft:await this.deleteDraftAction(e),u=!0;break;case B.e.SendMail:let c=await (0,L.dM)(e.parameters);this.updateCachedDraft({threadId:c.result.threadId,newMessageId:c.result.id,labelIds:c.result.labelIds,oldMessageId:e.messageId}),u=!0;break;case B.e.BlockSender:await (0,L.tp)(null==e?void 0:null===(d=e.parameters)||void 0===d?void 0:d.email),u=!0;break;case B.e.UnblockSender:await (0,L.X0)(null==e?void 0:null===(s=e.parameters)||void 0===s?void 0:s.email),u=!0}}catch(t){console.error('Request failed for "'+(null==e?void 0:e.type)+'".',"Request Parameters: ",e.type===B.e.LabelThread?(0,n.ZN)(e.resource):"parameters"in e?(0,n.ZN)(e.parameters):(0,n.ZN)(e),t),(null==e?void 0:e.rollbackFn)&&e.rollbackFn(),P.includes(e.type)||this.rootStore.toastStore.addToast(O.t.constants.UpdateFailed),u=!1}return e.revalidateFn&&e.revalidateFn(),null===(t=this.rootStore.idbStore.db)||void 0===t||t.delete("transaction-queue",e.id),u},this.createDraftAction=async e=>{let t=await (0,L.bN)(e.parameters);await this.updateCachedDraft({threadId:t.result.message.threadId,newMessageId:t.result.message.id,headerValues:{alias:e.alias,draftId:t.result.id,draftMsgHeaderId:null},labelIds:["DRAFT"]})},this.editDraftAction=async e=>{let t=e.draftId;if(!(null==t?void 0:t.length)){if(t=await this.getDraftId(e.alias,e.draftMsgHeaderId,e.threadId))e.createMailBodyProps.headers["draft-id"]=t;else throw Error("Failed to edit draft. DraftId not found.")}let l=(0,k.eK)(e.createMailBodyProps),i=await (0,L.CS)({resource:{message:{raw:l.asEncoded(),threadId:e.threadId}}},t);await this.updateCachedDraft({threadId:i.result.message.threadId,newMessageId:i.result.message.id,headerValues:{alias:e.alias,draftId:i.result.id,draftMsgHeaderId:e.draftMsgHeaderId},labelIds:["DRAFT"]})},this.sendDraftAction=async e=>{let t=e.draftId;if(!(null==t?void 0:t.length)&&!(t=await this.getDraftId(e.alias,e.draftMsgHeaderId,e.threadId)))throw Error("Failed to delete draft. DraftId not found.");let l=await (0,L.yh)(e.parameters,t);this.updateCachedDraft({threadId:l.result.threadId,newMessageId:l.result.id,labelIds:l.result.labelIds,headerValues:{alias:e.alias,draftId:t,draftMsgHeaderId:e.draftMsgHeaderId}})},this.deleteDraftAction=async e=>{var t,l;let i=e.draftId;if(!(null==i?void 0:i.length)&&!(i=await this.getDraftId(e.alias,e.draftMsgHeaderId,e.threadId)))throw Error("Failed to delete draft. DraftId not found.");await (0,L.Wp)(i);let n=await (null===(t=this.rootStore.idbStore.db)||void 0===t?void 0:t.get("mail",e.threadId));n&&(n.messages=n.messages.filter(t=>(0,k.Uq)(t,"alias")!==e.alias&&(0,k.Uq)(t,"message-id",!1)!==e.draftMsgHeaderId),null===(l=this.rootStore.idbStore.db)||void 0===l||l.put("mail",n))},this.getDraftId=async(e,t,l)=>{var i,n;let r=await (null===(i=this.rootStore.idbStore.db)||void 0===i?void 0:i.get("mail",l)),o=null==r?void 0:null===(n=r.messages)||void 0===n?void 0:n.find(t=>(0,k.Uq)(t,"alias")===e);if(o){let e=(0,k.Uq)(o,"draft-id");if(e.length)return e;{let e=(0,k.Uq)(o,"message-id",!1);if(e.length)return await (0,L.i2)(e)}}return await (0,L.i2)(t)},this.updateCachedDraft=async e=>{var t,l,i;let{threadId:n,newMessageId:r,labelIds:o,headerValues:a,oldMessageId:d}=e;if(!n||!d&&!a)throw Error("updateCachedDraft Dev Error. Insufficient parameters provided for determining draft. Need the threadId and either the oldMessageId or the headerValues.");let s=await (null===(t=this.rootStore.idbStore.db)||void 0===t?void 0:t.get("mail",n));if(!s)return;let u=s.messages.findIndex(e=>d===e.id||!!a&&((0,k.Uq)(e,"alias")===a.alias||(0,k.Uq)(e,"message-id",!1)===a.draftMsgHeaderId));if(u>=0){let e=s.messages[u],t={...e,id:r,labelIds:o};a&&(t.payload={...e.payload,headers:[...e.payload.headers.filter(e=>"alias"!==e.name&&"draft-id"!==e.name),{name:"alias",value:a.alias},{name:"draft-id",value:a.draftId}]}),s.messages[u]=t}else{let e={...z.M,id:r,threadId:n,internalDate:Date.now().toString(),labelIds:o};a&&(e.payload={...z.M.payload,headers:[...z.M.payload.headers.filter(e=>"alias"!==e.name&&"draft-id"!==e.name),{name:"alias",value:a.alias},{name:"draft-id",value:a.draftId}]}),s.messages=[...s.messages,e]}n&&(null===(l=this.rootStore.inboxStore.currentThread)||void 0===l?void 0:l.id)===n&&this.rootStore.inboxStore.setCurrentThread(s),await (null===(i=this.rootStore.idbStore.db)||void 0===i?void 0:i.put("mail",s))},this.resolveSwrOptimisticIds=async(e,t)=>(e.some(e=>e.startsWith("swr"))&&(e=(await Promise.all(t.map(async e=>{var t;return await (null===(t=this.rootStore.idbStore.db)||void 0===t?void 0:t.get("mail",e))}))).flatMap(e=>e?e.messages.flatMap(e=>e.id&&!e.id.startsWith("swr")?e.id:[]):[])),e),this.rootStore=e,(0,n.ky)(this),this.executeQueueReactionDisposer=(0,n.U5)(()=>[this.isQueueEmpty,this.rootStore.syncStore.isOfflineMode,this.rootStore.syncStore.syncStatus,this.isQueueLoaded],e=>{let[t,...l]=e;t||this.executeQueue()})}}var q=l(29174);class K{constructor(){this.composeStore=s,this.keyboardStore=b,this.uiStore=q.k,this.gapiStore=v,this.supabaseStore=E.KU,this.peopleStore=C,this.idbStore=new p(this),this.inboxStore=f,this.sidebarStore=j,this.labelStore=y.$,this.toastStore=D.f,this.commandMenuStore=o,this.modalsStore=x.PT,this.searchStore=I,this.syncStore=A,this.transactionStore=new W(this)}}let V=new K,J=(0,l(62516).createContext)(V),X=e=>{let{children:t}=e;return(0,i.jsx)(J.Provider,{value:V,children:t})}},93629:function(e,t,l){"use strict";l.d(t,{I:function(){return s},t:function(){return d}});var i=l(44003),n=l(27799),r=l(50026);function o(e,t,l){let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";if(!e||0===e.length){if(!l)return;e="(no subject)"}if(o&&o.length>0){let l=(0,n.r9)(e,32,292,t,a,"a");return(0,i.jsxs)(i.Fragment,{children:[a,(0,i.jsx)("a",{href:o,target:"_blank",rel:"noreferrer noopener",className:"break-all",children:l}),t]})}{r&&(e='"'+e,t='"'+t);let l=(0,n.r9)(e,32,292,t,a,"span");return l&&"."===l[l.length-1]&&"."===t[0]&&(t=t.slice(1,t.length)),(0,i.jsxs)(i.Fragment,{children:[a,(0,i.jsx)("span",{className:"break-all",children:l}),t]})}}function a(e){let t="count"in e,l="primaryText"in e;if(t&&1===e.count&&!l)throw Error("ToastMessage error: ToastMessage needs a primaryText if the count can be equal to 1.");return{isActive:e.isActive,count:t?e.count:1,primaryText:l?e.primaryText:void 0}}let d={constants:{DraftDeleted:{title:"Draft Discarded",description:"Draft has been discarded.",icon:r.N.Draft},DraftSaved:{title:"Draft Saved",description:"Draft has been saved.",icon:r.N.Draft},MessageSent:{title:"Message Sent",description:"Message has been sent.",icon:r.N.Send},UpdateFailed:{title:"Update Failed",description:"An unexpected error occurred. Recent changes have been reverted.",icon:r.N.Alert},ImageDownloaded:{title:"Image Downloaded",description:"Image downloaded to your device.",icon:r.N.Download},SupportMessageReceived:{title:"Message Received",description:"Your message has been received. Thank you.",icon:r.N.Check},TatemAddressCopied:{title:"Tatem's Address Copied",description:'"support@tatem.com" copied to clipboard.',icon:r.N.Copy},WaitlistAdded:{title:"Thank You",description:"We can’t wait to welcome you to Tatem.",icon:r.N.Check}},lambdas:{AuthError:e=>{let{primaryText:t}=e;return{title:"Authentication Error",description:t,icon:r.N.Alert}},BlockedSender:e=>{let{primaryText:t,count:l,isActive:i}=a(e);if(1!==l||!t)return{title:"Blocked Senders",description:l+" senders blocked.",icon:r.N.Block};{let e=o(t,i?'" unblocked.':'" blocked.',!1,!1,void 0,'"');return{title:i?"Unblocked Sender":"Blocked Sender",description:e,icon:r.N.Block}}},ConversationArchived:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=t?" Unarchived":" Archived";return 1===i&&l?{title:"Conversation"+n,description:o(l,t?" unarchived.":" archived.",!0),icon:r.N.Archive}:{title:"Conversations"+n,description:i+" conversations "+(t?"unarchived.":"archived."),icon:r.N.Archive}},ConversationDeleted:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=t?" Undeleted":" Deleted";return 1===i&&l?{title:"Conversation"+n,description:o(l,t?" undeleted.":" deleted.",!0),icon:r.N.Trash}:{title:"Conversations"+n,description:i+" conversations "+(t?"undeleted.":"deleted."),icon:r.N.Trash}},ConversationRead:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=t?" Unread":" Read",d=t?r.N.Unread:r.N.Read;return 1===i&&l?{title:"Conversation Marked"+n,description:o(l," marked"+(t?" unread.":" read."),!0),icon:d}:{title:"Conversations Marked"+n,description:i+" conversations marked "+(t?" unread.":" read."),icon:d}},ConversationSpam:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=t?" Unmarked Spam":" Marked Spam";return 1===i&&l?{title:"Conversation"+n,description:o(l,(t?" unmarked":" marked")+" spam.",!0),icon:r.N.Spam}:{title:"Conversations"+n,description:i+" conversations "+(t?" unmarked ":" marked ")+"spam.",icon:r.N.Spam}},ConversationStarred:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=t?" Unstarred":" Starred";return 1===i&&l?{title:"Conversation"+n,description:o(l,t?" unstarred.":" starred.",!0),icon:r.N.Star}:{title:"Conversations"+n,description:i+" conversations "+(t?"unstarred.":"starred."),icon:r.N.Star}},ConversationUrlCopied:e=>{var t,l;if(e.count&&e.count<1)throw Error("ToastMessage error: ConversationUrlCopied ToastMessage has count less than 1.");let i=e.href,n=null!==(t=e.count)&&void 0!==t?t:1,a=null!==(l=e.primaryText)&&void 0!==l?l:e.href;return 1===n&&a?{title:"Conversation URL Copied",description:o(a," copied to clipboard.",!1,!1,i),icon:r.N.Copy}:{title:"Conversation URLs Copied",description:n+" conversation URLs copied.",icon:r.N.Copy}},CurrentUrlCopied:e=>{let{primaryText:t}=e;return{title:"Current URL Copied",description:o(t," copied to clipboard.",!1,!1,t),icon:r.N.Copy}},DateCopied:e=>{let{primaryText:t}=e;return{title:"Date Received Copied",description:'"'+t+'" copied to clipboard.',icon:r.N.Copy}},DeniedUnsubscribe:e=>{let{primaryText:t}=e;return{title:"Could Not Unsubscribe",description:o(t,'."',!1,!1,void 0,'Could not unsubscribe from "'),icon:r.N.Unsubscribe}},FeedbackContentMissing:()=>({title:"Content Required",description:"Please add a message or attachment before submitting.",icon:r.N.Alert}),HexCodeCopied:e=>{let{primaryText:t}=e;return{title:"Hex Code Copied",description:"".concat(t," copied to clipboard."),icon:r.N.Copy}},InviteCopied:e=>{let{primaryText:t}=e;return{title:"Invite Link Copied",description:o(t," copied to clipboard.",!1,!1,t),icon:r.N.Copy}},InvalidEmailAddress:e=>{let{primaryText:t}=e;return{title:"Invalid Email Address",description:'"'+t+'" is not a valid email address.',icon:r.N.Close}},InvitesSent:e=>{let{count:t}=e;return{title:"".concat(t>1?t+" ":"","Invite").concat(t>1?"s":""," Sent"),description:"We have notified the pending member".concat(t>1?"s":""," via email to sign up for Tatem."),icon:r.N.Send}},LabelCreated:e=>{let{primaryText:t}=e;return{title:"Label Created",description:o(t," label created."),icon:r.N.Label}},LabelCreationFailed:e=>{let{primaryText:t}=e;return{title:"Creation Failed",description:t,icon:r.N.Alert}},LabelDeleted:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Label Deleted",description:o(t," label deleted."),icon:r.N.Label}:{title:"Labels Deleted",description:l+" labels deleted.",icon:r.N.Label}},LabeledConversation:e=>{let{isActive:t,primaryText:l,count:i}=a(e),n=o(null!=l?l:"",(t?" removed from ":" added to ")+(1===i?"conversation.":i+" conversations."));return{title:"Label"+(t?" Removed":" Added"),description:n,icon:r.N.Label}},RecipientAddressCopied:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Recipient's Address Copied",description:o(t," copied to clipboard."),icon:r.N.Copy}:{title:"Recipients' Addresses Copied",description:l+" recipients' addresses copied to clipboard.",icon:r.N.Copy}},Redo:e=>{let{primaryText:t}=e;return{title:"Redo",description:t,icon:r.N.Redo}},SenderAddressCopied:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Sender's Address Copied",description:o(t," copied to clipboard."),icon:r.N.Copy}:{title:"Senders' Addresses Copied",description:l+" senders' addresses copied to clipboard.",icon:r.N.Copy}},SenderCopied:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Sender's Name Copied",description:o(t," copied to clipboard."),icon:r.N.Copy}:{title:"Senders' Names Copied",description:l+" senders' names copied to clipboard.",icon:r.N.Copy}},SplitCreationCompleted:e=>{let{primaryText:t}=e;return{title:"Split Inbox Created",description:'"'.concat(t,'" split inbox created.'),icon:r.N.Check}},SplitDeletionCompleted:e=>{let{primaryText:t}=e;return{title:"Split Inbox Deleted",description:'"'.concat(t,'" split inbox deleted.'),icon:r.N.Trash}},SplitDeletionFailed:e=>{let{primaryText:t}=e;return{title:"Deletion Failed",description:t,icon:r.N.Alert}},SplitUpdateFailed:e=>{let{primaryText:t}=e;return{title:"Update Failed",description:t,icon:r.N.Alert}},SplitUpdateCompleted:e=>{let{primaryText:t}=e;return{title:"Split Inbox Updated",description:'"'.concat(t,'" split inbox has been updated.'),icon:r.N.Check}},SubjectCopied:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Subject Copied",description:o(t," copied to clipboard.",!0),icon:r.N.Copy}:{title:"Subjects Copied",description:l+" subjects copied to clipboard.",icon:r.N.Copy}},ThemeChanged:e=>{let{primaryText:t}=e,l=t.length>0?"system"===t?"System Preference":(0,n.fm)(t):void 0;return{title:"Theme Changed",description:l?'Theme changed to "'+l+'."':void 0,icon:r.N.Cog}},Undo:e=>{let{primaryText:t}=e;return{title:"Undo",description:t,icon:r.N.Undo}},Unsubscribed:e=>{let{primaryText:t,count:l}=a(e);return 1===l&&t?{title:"Unsubscribed (Opted Out)",description:o(t,'"',!1,!1,void 0,'Unsubscribed from "'),icon:r.N.Unsubscribe}:{title:"Unsubscribed (Opted Out)",description:"Unsubscribed from "+l+" senders.",icon:r.N.Unsubscribe}},UrlCopied:e=>{let{primaryText:t}=e;return{title:"URL Copied",description:o(t," copied to clipboard.",!1,!1,t),icon:r.N.Copy}},FileSizeExceeded:e=>{let{primaryText:t}=e;return{title:"File Size Exceeds Limit",description:"Please upload a file less than ".concat(t," MB in size to continue."),icon:r.N.Alert}},FileLimitExceeded:e=>{let{primaryText:t}=e;return{title:"File Limit Exceeded",description:"Please limit the upload to a maximum of ".concat(t," files to continue."),icon:r.N.Alert}},FeedbackSubmitted:()=>({title:"Feedback Submitted",description:"Thank you for your feedback. We appreciate it.",icon:r.N.Send})}},s=e=>{let t=e.indexOf("Un"),l="";if(e.toLowerCase().includes("label")){let t=e.split(" ");2===t.length&&("Removed"===t.at(1)?t[1]="added":"Added"===t.at(1)&&(t[1]="removed")),l=t.join(" ")}else if(t>-1&&!e.includes("Undo"))l=e.slice(0,t)+e.slice(t+2);else if(e.includes("Read")){let t=e.split(" ");if(3===t.length){var i;t[2]="un"+(null===(i=t.at(2))||void 0===i?void 0:i.toLowerCase())}l=t.join(" ")}else{let t=e.indexOf(" ");l=e.slice(0,t+1)+"un"+e.charAt(t+1).toLowerCase()+e.slice(t+2)}return l.charAt(0)+l.slice(1).toLowerCase()+"."}},3984:function(e,t,l){"use strict";l.d(t,{m:function(){return r}});var i=l(83965),n=l(62516);let r=()=>(0,n.useContext)(i.x)},94061:function(e,t,l){"use strict";l.d(t,{c:function(){return n}});var i=l(62516);function n(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{leading:!1},[n,r]=(0,i.useState)(e),o=(0,i.useRef)(!1),a=(0,i.useRef)(null),d=(0,i.useRef)(!1),s=()=>window.clearTimeout(a.current);return(0,i.useEffect)(()=>{o.current&&(!d.current&&l.leading?(d.current=!0,r(e)):(s(),a.current=window.setTimeout(()=>{d.current=!1,r(e)},t)))},[e,l.leading,t]),(0,i.useEffect)(()=>(o.current=!0,s),[]),[n,s]}},62638:function(e,t,l){"use strict";l.d(t,{$:function(){return r}});var i=l(17157);class n{constructor(){this.userLabels=[],this.cachedLabelArr=[],this.currentLabel="",this.loading=!1,this.error=null,this.setUserLabels=e=>{this.userLabels=e},this.setCurrentLabel=e=>{this.currentLabel=e},this.setCachedLabelArr=e=>{this.cachedLabelArr=e},this.loadFromLocalStorage=()=>{(0,i.z)(()=>{var e;this.currentLabel=null!==(e=localStorage.getItem("currentLabel"))&&void 0!==e?e:"INBOX"})},(0,i.ky)(this)}}let r=new n},16502:function(e,t,l){"use strict";l.d(t,{PT:function(){return d},be:function(){return o},xK:function(){return n}});var i,n,r=l(17157);(i=n||(n={})).SUCCESS="SUCCESS",i.RECIPIENT_REQUIRED="RECIPIENT_REQUIRED",i.INVALID_RECIPIENT="INVALID_RECIPIENT",i.INVALID_CC="INVALID_CC",i.INVALID_BCC="INVALID_BCC",i.SUBJECT_MISSING="SUBJECT_MISSING",i.LABEL_DELETING="LABEL_DELETING",i.AUTH_ERROR="AUTH_ERROR",i.FEEDBACK_ERROR="FEEDBACK_ERROR",i.FEEDBACK_CONTENT_MISSING="FEEDBACK_CONTENT_MISSING",i.FILE_UPLOAD_ERROR="FILE_UPLOAD_ERROR",i.FILE_LIMIT_EXCEEDED="FILE_LIMIT_EXCEEDED",i.FILE_SIZE_EXCEEDED="FILE_SIZE_EXCEEDED",i.INVALID_FILE_TYPE="INVALID_FILE_TYPE",i.EMAIL_SEND_ERROR="EMAIL_SEND_ERROR",i.UNSUBSCRIBE="UNSUBSCRIBE",i.BLOCK_SENDER="BLOCK_SENDER";let o={alertMsg:"",alertDescription:"",alertField:"",alertCode:void 0,onConfirm:void 0,onClose:{title:"Close",onClick:()=>{}}};class a{get isModalOpen(){return this.alertModalOpen||this.feedbackModalOpen||this.helpCenterModalOpen||this.splitInboxModalOpen}constructor(){this.alertModalOpen=!1,this.alertModalObj=o,this.feedbackModalOpen=!1,this.feedbackModalTab="problem",this.helpCenterModalOpen=!1,this.helpCenterPage="main",this.splitInboxModalOpen=!1,this.setAlertModalOpen=e=>{this.alertModalOpen=e},this.setAlertModalObj=e=>{this.alertModalObj=e,""===e.alertDescription&&""===e.alertMsg&&(this.alertModalOpen=!1)},this.onFeedbackModalOpen=e=>{this.feedbackModalOpen=!0,e&&(this.feedbackModalTab=e)},this.onFeedbackModalClose=()=>{this.feedbackModalOpen=!1,this.feedbackModalTab="problem"},this.setFeedbackModalTab=e=>{this.feedbackModalTab=e},this.closeFeedbackModal=()=>{this.feedbackModalTab="problem",this.feedbackModalOpen=!1},this.setHelpCenterModalOpen=e=>{this.helpCenterModalOpen=e},this.closeHelpCenterModal=()=>{this.helpCenterPage="main",this.helpCenterModalOpen=!1},this.setHelpCenterPage=e=>{this.helpCenterPage=e},this.setSplitInboxModalOpen=e=>{this.splitInboxModalOpen=e},(0,r.ky)(this)}}let d=new a},7710:function(e,t,l){"use strict";l.d(t,{$U:function(){return o},KU:function(){return d},WW:function(){return r}});var i=l(71451),n=l(17157);let r=["/thread","/compose","/inbox","/starred","/archive","/drafts","/trash","/spam","/labels","/reminders","/search","/settings/account/profile","/settings/account/preferences","/settings/account/linked-accounts","/settings/mail/labels","/settings/workspace/billing","/settings/workspace/general","/settings/workspace/members","/settings/workspace/upgrade"],o=5;class a{async setUserData(e){var t,l;this.userData=e,this.fetchWorkspace(),this.fetchSplitInboxes(),localStorage.setItem("currentUser",null!==(l=null==e?void 0:e.id)&&void 0!==l?l:"");let i=null===(t=document.cookie)||void 0===t?void 0:t.split("; ");i.forEach(t=>{var l,n,r;let o=(null!==(r=null==e?void 0:e.id)&&void 0!==r?r:"")+"_"+(null==t?void 0:null===(l=t.split("="))||void 0===l?void 0:l.at(0)),a=null===(n=localStorage)||void 0===n?void 0:n.getItem(o);((null==t?void 0:t.includes("sb-"))&&!a||!i.find(e=>e===a))&&localStorage.setItem(o,t)}),this.updateUserMap()}async updateUserMap(){var e,t,l;let n=(0,i.e)(),r=[],{data:o}=await n.from("users").select("*").eq("primary_user_id",null===(e=d.userData)||void 0===e?void 0:e.id);if(null==o?void 0:o.length)r=o;else{let{data:e}=await (null===(t=n.from("users").select("*").eq("id",null===(l=d.userData)||void 0===l?void 0:l.id))||void 0===t?void 0:t.maybeSingle()),{data:i}=await n.from("users").select("*").eq("primary_user_id",null==e?void 0:e.primary_user_id);i&&(r=i)}let a=Object.fromEntries(null==r?void 0:r.map(e=>[null==e?void 0:e.id,{name:null==e?void 0:e.name,email:null==e?void 0:e.email,avatar_url:null==e?void 0:e.avatar_url}]));this.userMap=a}async fetchWorkspace(){var e,t,l,n,r,o,a,d,s,u,c,v,m,p,h,f,g;let b=(0,i.e)(),{data:y}=await (null===(e=b.from("workspaces").select("*"))||void 0===e?void 0:e.maybeSingle());if(y&&(this.workspaceData=y,localStorage.setItem("workspaceId",null==y?void 0:y.id),(y.id!==(null===(o=this.userData)||void 0===o?void 0:null===(r=o.user_metadata)||void 0===r?void 0:null===(n=r.workspace)||void 0===n?void 0:n.id)||y.url!==(null===(s=this.userData)||void 0===s?void 0:null===(d=s.user_metadata)||void 0===d?void 0:null===(a=d.workspace)||void 0===a?void 0:a.url)||y.type!==(null===(v=this.userData)||void 0===v?void 0:null===(c=v.user_metadata)||void 0===c?void 0:null===(u=c.workspace)||void 0===u?void 0:u.type))&&(await b.auth.updateUser({data:{workspace:{id:y.id,url:y.url,type:y.type}}}),await b.auth.refreshSession())),!(null===(l=this.userData)||void 0===l?void 0:null===(t=l.user_metadata)||void 0===t?void 0:t.primary_user_id)){let{data:e}=await (null===(h=b.from("users").select("primary_user_id"))||void 0===h?void 0:null===(m=h.eq("id",null===(p=this.userData)||void 0===p?void 0:p.id))||void 0===m?void 0:m.maybeSingle());(null==e?void 0:e.primary_user_id)!==(null===(g=this.userData)||void 0===g?void 0:null===(f=g.user_metadata)||void 0===f?void 0:f.primary_user_id)&&(this.userData&&(this.userData.user_metadata.primary_user_id=null==e?void 0:e.primary_user_id),await b.auth.updateUser({data:{primary_user_id:null==e?void 0:e.primary_user_id}}),await b.auth.refreshSession())}}async fetchSplitInboxes(){var e,t,l,n,r,o;let a=(0,i.e)(),{data:s,error:u}=await (null===(e=a.from("users").select("splits").eq("id",null===(t=d.userData)||void 0===t?void 0:t.id))||void 0===e?void 0:e.maybeSingle());if(u){console.error(u);return}let c=null!==(o=null==s?void 0:null===(l=s.splits)||void 0===l?void 0:l.map(e=>({...e,active:(null==e?void 0:e.active)===void 0||e.active})))&&void 0!==o?o:[],v=null==c?void 0:null===(r=c.filter(e=>!!e.active&&!e.showInInbox))||void 0===r?void 0:null===(n=r.map(e=>" -(".concat(e.value,")")))||void 0===n?void 0:n.join(""),m=c.find(e=>"Inbox"===e.name)?[]:[{name:"Inbox",value:""+v,active:!1}],p=c.find(e=>"Important"===e.name)?[]:[{name:"Important",value:"category:personal"+v,active:!0}],h=c.find(e=>"Other"===e.name)?[]:[{name:"Other",value:"-(category:personal)"+v,active:!0}],f=[...m,...p,...c,...h];this.setInboxSplits(f)}constructor(){this.userData=null,this.userMap={},this.workspaceData=null,this.inboxSplits=[],this.setInboxSplits=e=>{this.inboxSplits=e},(0,n.ky)(this)}}let d=new a},30676:function(e,t,l){"use strict";l.d(t,{Q:function(){return n},f:function(){return o}});var i=l(17157);let n=3e3;class r{constructor(){this.toasts=[],this.clearToasts=()=>{this.toasts=[]},this.addToast=e=>{var t;this.toasts=(null===(t=this.toasts)||void 0===t?void 0:t.length)>=50?[e,...this.toasts].slice(0,50).reverse():[...this.toasts,e]},(0,i.ky)(this)}}let o=new r},29174:function(e,t,l){"use strict";l.d(t,{M:function(){return n},k:function(){return a}});var i=l(17157);let n={emphasizeUnread:!1,avatar:!1,sender:!0,description:!0,date:!0,border:!1,status:!0,groupingDisplay:"minimal"},r={composePageDefault:!0};class o{get isDarkMode(){return"system"===this.theme?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"===this.theme}constructor(){this.theme="light",this.preferences=r,this.displaySettings=n,this.setTheme=e=>{this.theme=e},this.setPreferences=e=>{this.preferences=e},this.updateDisplaySettings=e=>{this.displaySettings={...this.displaySettings,...e}},this.loadFromLocalStorage=e=>{{if(e)this.theme=e;else{let e=localStorage.getItem("theme");e&&(this.theme=e)}let t=localStorage.getItem("preferences");t&&(this.preferences=JSON.parse(t));let l=localStorage.getItem("displaySettings");l&&(this.displaySettings=JSON.parse(l))}},(0,i.ky)(this)}}let a=new o},83015:function(e,t,l){"use strict";l.d(t,{M:function(){return i}});let i={id:"",threadId:"",payload:{partId:"",mimeType:"",filename:"",headers:[],body:{size:0}},sizeEstimate:0,historyId:"0",internalDate:"",snippet:"",labelIds:[]}},95470:function(e,t,l){"use strict";var i,n;l.d(t,{e:function(){return i}}),(n=i||(i={})).SendMail="SEND_MAIL",n.LabelThread="LABEL_THREAD",n.CreateDraft="CREATE_DRAFT",n.EditDraft="EDIT_DRAFT",n.SendDraft="SEND_DRAFT",n.CreateLabel="CREATE_LABEL",n.EditLabel="EDIT_LABEL",n.DeleteLabels="DELETE_LABELS",n.DeleteDraft="DELETE_DRAFT",n.BlockSender="BLOCK_SENDER",n.UnblockSender="UNBLOCK_SENDER"},56678:function(){},11193:function(){},89798:function(){},59613:function(){}}]);