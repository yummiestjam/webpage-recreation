!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d316b329-2c34-4917-90f4-7e40777e185b",e._sentryDebugIdIdentifier="sentry-dbid-d316b329-2c34-4917-90f4-7e40777e185b")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8541],{32923:function(e,t,l){"use strict";l.d(t,{Oc:function(){return g},di:function(){return h},e8:function(){return c},fu:function(){return v},mY:function(){return d},rb:function(){return m},sZ:function(){return u},zz:function(){return p}});var n=l(44003),o=l(32930),a=l(61808),i=l.n(a),r=l(36958),s=l(62516);l(64156);let d=s.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)(r.mY,{ref:t,className:i()("flex h-full flex-col overflow-hidden rounded-md",l),loop:!1,...o})});d.displayName=r.mY.displayName;let u=s.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)("div",{className:"flex min-h-[58px] items-center border-b border-border-primary px-5 dark:border-border-dark-primary","cmdk-input-wrapper":"",children:(0,n.jsx)(r.mY.Input,{ref:t,className:i()("flex w-full select-none bg-transparent text-t2 caret-brand outline-none placeholder:text-quartery disabled:cursor-not-allowed disabled:opacity-50 dark:text-primary-dark dark:caret-brand-dark dark:placeholder:text-quartery-dark",l),autoFocus:!0,onFocus:e=>{e.preventDefault(),e.stopPropagation()},spellCheck:!1,...o})})});u.displayName=r.mY.Input.displayName;let c=s.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,n.jsx)(r.mY.List,{ref:t,className:i()("max-h-[360px] overflow-y-auto overflow-x-hidden p-2",(0,o.u)(),l),...a,style:{scrollPaddingBlockStart:"8px",scrollPaddingBlockEnd:"8px",...a.style}})});c.displayName=r.mY.List.displayName;let m=s.forwardRef((e,t)=>(0,n.jsx)(r.mY.Empty,{ref:t,className:"",...e}));m.displayName=r.mY.Empty.displayName;let v=s.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)(r.mY.Group,{ref:t,className:i()("overflow-hidden [&_[cmdk-group-heading]]:h-[30px] [&_[cmdk-group-heading]]:px-5 [&_[cmdk-group-heading]]:py-2 [&_[cmdk-group-heading]]:text-support [&_[cmdk-group-heading]]:font-normal [&_[cmdk-group-heading]]:text-tertiary dark:[&_[cmdk-group-heading]]:text-tertiary-dark",l),...o})});v.displayName=r.mY.Group.displayName;let p=s.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)(r.mY.Separator,{ref:t,className:i()("-mx-1 h-0 bg-transparent",l),...o})});p.displayName=r.mY.Separator.displayName;let h=s.forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(r.mY.Item,{ref:t,className:i()('relative flex h-12 cursor-default select-none items-center rounded px-2.5 text-secondary outline-none aria-selected:bg-fill-primary aria-selected:text-primary data-[disabled="true"]:pointer-events-none data-[disabled="true"]:opacity-50 dark:text-secondary-dark dark:aria-selected:bg-fill-dark-primary dark:aria-selected:text-primary-dark',l),...o})})});h.displayName=r.mY.Item.displayName;let g=e=>{let{className:t,...l}=e;return(0,n.jsx)("span",{className:i()("ml-auto flex gap-1 pr-2 text-xs tracking-[.1px] text-secondary dark:text-secondary-dark",t),...l})};g.displayName="CommandShortcut"},69250:function(e,t,l){"use strict";l.d(t,{U:function(){return i}});var n=l(44003),o=l(61808),a=l.n(o);let i=l(62516).forwardRef((e,t)=>{let{className:l,...o}=e;return(0,n.jsx)("textarea",{className:a()("w-full resize-none rounded border border-border-primary bg-transparent px-3 py-2 text-body-long text-primary outline-none placeholder:text-quartery focus-within:bg-fill-input hover:border-border-secondary dark:border-border-dark-primary dark:text-primary-dark dark:placeholder:text-quartery-dark dark:focus-within:bg-fill-dark-input dark:hover:border-border-dark-secondary",l),ref:t,...o})});i.displayName="Textarea"},67265:function(e,t,l){"use strict";l.d(t,{q:function(){return a}});var n=l(44003),o=l(23657);let a=l(62516).forwardRef((e,t)=>{let{className:l,...a}=e;return(0,n.jsx)(o.fC,{className:"h-5 w-8 shrink-0 rounded-full bg-muted p-0.5 outline-none duration-100 hover:bg-quartery focus-visible:shadow-[0px_0px_0px_4px_rgba(12,75,233,0.30),0px_0px_0px_1px_#0C4BE9] data-[state=checked]:bg-primary dark:bg-muted-dark dark:hover:bg-quartery-dark dark:focus-visible:shadow-[0px_0px_0px_4px_rgba(81,127,246,0.40),0px_0px_0px_1px_#517FF6] dark:data-[state=checked]:bg-primary-dark",...a,ref:t,children:(0,n.jsx)(o.bU,{className:"pointer-events-none block h-4 w-4 translate-x-0 rounded-full bg-white duration-100 data-[state=checked]:translate-x-3 dark:bg-primary"})})});a.displayName=o.fC.displayName},13235:function(e,t,l){"use strict";l.d(t,{AuthWrapper:function(){return g}});var n=l(44003),o=l(71451),a=l(3984),i=l(7710),r=l(17157),s=l(1394),d=l(87767),u=l(29278),c=l(62516),m=l(34825);let v={connection:{targetTable:"people-connection",targetId:"connections-contact",sourceType:"connection"},frequent:{targetTable:"people-othercontacts",targetId:"frequent-contact",sourceType:"frequent"},directory:{targetTable:"people-listdirectory",targetId:"directory-contact",sourceType:"directory"},manual:{targetTable:"people-connection",targetId:"connections-contact",sourceType:"manual"}};async function p(e,t,l){if(void 0!==e&&l){let{targetId:n}=v[t]||v.manual,o={id:n,syncToken:e,expiredTime:Date.now()+5976e5};await l.put("people-syncStatus",o)}}async function h(e,t,l,n){if(!e||!l)return;let{targetTable:o,sourceType:a}=v[t]||v.manual,i=e.map(async e=>{var t,i,r,s,d,u,c,m,v,p,h,g,b,x,f;let y=null!==(h=null===(t=e.resourceName)||void 0===t?void 0:t.replace(/\//g,"-"))&&void 0!==h?h:"",k={id:y,displayName:null!==(b=null!==(g=null===(r=e.names)||void 0===r?void 0:null===(i=r[0])||void 0===i?void 0:i.displayName)&&void 0!==g?g:null===(d=e.emailAddresses)||void 0===d?void 0:null===(s=d[0])||void 0===s?void 0:s.value)&&void 0!==b?b:"Unknown Name",emailAddress:null!==(x=null===(c=e.emailAddresses)||void 0===c?void 0:null===(u=c[0])||void 0===u?void 0:u.value)&&void 0!==x?x:"",photoUrl:null!==(f=null===(v=e.photos)||void 0===v?void 0:null===(m=v[0])||void 0===m?void 0:m.url)&&void 0!==f?f:"",sourceType:a};return"update"===n&&(null===(p=e.metadata)||void 0===p?void 0:p.deleted)?l.delete(o,y):l.put(o,k,y)});await Promise.all(i)}let g=(0,s.Pi)(e=>{let{children:t,user:l}=e,{gapiStore:s,supabaseStore:v,idbStore:g,peopleStore:b}=(0,a.m)(),x=(0,d.useRouter)(),f=(0,o.e)();return(0,c.useEffect)(()=>{if(l){v.userData||(v.setUserData(l),g.initDB(l.id));let e=(0,r.U5)(()=>s.gapiLoaded,e=>{e&&s.initGapi()});return()=>{e()}}localStorage.clear()},[!!l]),(0,c.useEffect)(()=>{let e=async(e,t,l,n)=>{try{let o=n?await n(l):null;o&&(await p(o.nextSyncToken,e,g.db),t?await h(o.contacts,e,g.db,"store"):void 0!==o.contacts&&await h(o.contacts,e,g.db,"update"))}catch(e){if(400===e.result.error.code&&e.result.error.message.includes("G Suite")){var o;await (null===(o=g.db)||void 0===o?void 0:o.put("people-syncStatus",{id:"directory-contact",syncToken:"not a G Suite user",expiredTime:1/0}))}}},t=async()=>{await Promise.all([{key:"connections-contact",sourceType:"connection",store:"people-connection"},{key:"frequent-contact",sourceType:"frequent",store:"people-othercontacts"},{key:"directory-contact",sourceType:"directory",store:null}].map(async t=>{var l,n;let{key:o,sourceType:a,store:i}=t,r=await (null===(l=g.db)||void 0===l?void 0:l.get("people-syncStatus",o)),s="connection"===a?b.fetchConnections:"frequent"===a?b.fetchFrequentContacts:b.fetchDirectoryContacts;if(void 0!==r){if("directory-contact"===o&&"not a G Suite user"===r.syncToken)return;let t=i?await (null===(n=g.db)||void 0===n?void 0:n.count(i)):null;r.expiredTime>Date.now()&&t&&t>0?await e(a,!1,r.syncToken,s):await e(a,!0,void 0,s)}else await e(a,!0,void 0,s)}))},l=async()=>{let e=await b.loadContactsFromIndexedDB(g.db);e&&b.setAllContacts(e)},n=async()=>{var e,t,l,n,o,a,i,r,s,d,u;let c=null===(e=window)||void 0===e?void 0:e.gapi,{result:{filter:m}}=await (null==c?void 0:null===(a=c.client)||void 0===a?void 0:null===(o=a.gmail)||void 0===o?void 0:null===(n=o.users)||void 0===n?void 0:null===(l=n.settings)||void 0===l?void 0:null===(t=l.filters)||void 0===t?void 0:t.list({userId:"me"})),v=null==m?void 0:null===(u=m.find(e=>{var t,l;return null==e?void 0:null===(l=e.criteria)||void 0===l?void 0:null===(t=l.query)||void 0===t?void 0:t.includes("+TATEMBLOCKLIST")}))||void 0===u?void 0:null===(d=u.criteria)||void 0===d?void 0:null===(s=d.query)||void 0===s?void 0:null===(r=s.split(" OR "))||void 0===r?void 0:null===(i=r.filter(e=>e.includes("from:")))||void 0===i?void 0:i.map(e=>null==e?void 0:e.replace("from:",""));b.setBlockedSenders(v)},o=async()=>{var e,t,l,n,o,a,i,r,s;if(!(null===(t=v.userData)||void 0===t?void 0:null===(e=t.user_metadata)||void 0===e?void 0:e.avatar_url)){let e=null===(l=window)||void 0===l?void 0:l.gapi,{result:{photos:t}}=await (null==e?void 0:null===(a=e.client)||void 0===a?void 0:null===(o=a.people)||void 0===o?void 0:null===(n=o.people)||void 0===n?void 0:n.get({resourceName:"people/me",personFields:"photos"})),d=t.find(e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.primary)===!0});d&&(await f.auth.updateUser({data:{primary_user_id:null==d?void 0:d.url}}),await f.auth.refreshSession(),await (null===(s=f.from("users"))||void 0===s?void 0:null===(r=s.update({avatar_url:null==d?void 0:d.url}))||void 0===r?void 0:r.eq("id",null==v?void 0:null===(i=v.userData)||void 0===i?void 0:i.id)))}};s.gapiInitialized&&g.isDbInitialized?t().then(async()=>{l(),n(),o()}):!s.gapiInitialized&&g.isDbInitialized&&l()},[s.gapiInitialized,g.isDbInitialized]),(0,c.useEffect)(()=>{let e=(0,r.U5)(()=>v.workspaceData,e=>{if(e){let t=("organization"===e.type?"/".concat(e.url):"")+"/mail";i.WW.map(e=>{x.prefetch(t+e)})}}),{data:{subscription:t}}=f.auth.onAuthStateChange((e,t)=>{var l;"TOKEN_REFRESHED"===e&&(null==t?void 0:null===(l=t.user)||void 0===l?void 0:l.id)&&(0,m.Mj)(t.user.id)});return()=>{e(),t.unsubscribe()}},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.default,{src:"https://apis.google.com/js/client.js",onReady:()=>{s.setGapiLoaded(!0)},onLoad:()=>{s.setGapiLoaded(!0)}}),t]})})},50096:function(e,t,l){"use strict";l.d(t,{UIWrapper:function(){return d}});var n=l(44003),o=l(3984),a=l(17157),i=l(1394),r=l(62516);let s=e=>{var t,l,n,o,a,i;document.body.style.backgroundColor=e?"#282828":"#FFF",document.body.style.opacity="1",!e&&(null===(n=document)||void 0===n?void 0:null===(l=n.documentElement)||void 0===l?void 0:null===(t=l.classList)||void 0===t?void 0:t.contains("dark"))&&(null===(i=document)||void 0===i||null===(a=i.documentElement)||void 0===a||null===(o=a.classList)||void 0===o||o.remove("dark"))},d=(0,i.Pi)(e=>{let{children:t,initialTheme:l}=e,{uiStore:i,sidebarStore:d}=(0,o.m)(),[u,c]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{if(!u)return;let e=(0,a.U5)(()=>i.isDarkMode,e=>{localStorage.setItem("theme",e?"dark":"light"),s(e)},{fireImmediately:!0}),t=(0,a.U5)(()=>i.preferences,e=>{localStorage.setItem("preferences",JSON.stringify(e))}),l=(0,a.U5)(()=>i.displaySettings,e=>{localStorage.setItem("displaySettings",JSON.stringify(e))}),n=(0,a.U5)(()=>d.sidebarOpen,e=>{window.innerWidth>=1024&&localStorage.setItem("sidebarOpen",JSON.stringify(e)),e&&window.innerWidth<1024&&d.rightSidebarOpen&&d.setRightSidebarOpen(!1)},{fireImmediately:!0}),o=(0,a.U5)(()=>d.rightSidebarOpen,e=>{window.innerWidth>=1024&&localStorage.setItem("rightSidebarOpen",JSON.stringify(e)),e&&window.innerWidth<1024&&d.sidebarOpen&&d.setLeftSidebarOpen(!1)});return()=>{e(),t(),l(),n(),o()}},[u]),(0,r.useEffect)(()=>{var e;i.loadFromLocalStorage(l),d.loadFromLocalStorage(),c(!0);let t=null===(e=document)||void 0===e?void 0:e.getElementById("main-page");setTimeout(()=>{var e;null==t||null===(e=t.classList)||void 0===e||e.add("duration-150")},1e3)},[]),u)?(0,n.jsx)("div",{className:i.isDarkMode?"dark":"",children:t}):null})},34825:function(e,t,l){"use strict";l.d(t,{Mj:function(){return a},qj:function(){return n},yD:function(){return o}});let n=async e=>{let{supabase:t,accessCode:l,primaryUserId:n,workspaceId:o}=e;try{var a,i,r;let e={};l&&(e.access=l),n&&o&&(e.primaryUser=n,e.workspaceId=o);let s=(a=new URLSearchParams(e),void 0===a)?void 0:a.toString(),{data:{url:d}}=await t.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(null===(r=window)||void 0===r?void 0:null===(i=r.location)||void 0===i?void 0:i.origin,"/auth/callback").concat(s?"?".concat(s):""),scopes:"https://www.googleapis.com/auth/gmail.modify https://www.googleapis.com/auth/gmail.compose https://www.googleapis.com/auth/contacts.readonly https://www.googleapis.com/auth/contacts.other.readonly https://www.googleapis.com/auth/directory.readonly https://www.googleapis.com/auth/gmail.settings.basic",queryParams:{access_type:"offline",prompt:"consent"},skipBrowserRedirect:!0}});d&&window.open(d,"_self")}catch(e){console.error(e)}},o=e=>{var t,l,n;let o=null===(t=Object.entries(localStorage))||void 0===t?void 0:t.filter(t=>{let[l]=t;return l.includes(e)});document.cookie.split("; ").forEach(e=>{let[t]=e.split("=");t.includes("auth-token")&&e&&r(e)}),o.forEach(e=>{let[,t]=e,[l]=t.split("=");l.includes("auth-token")&&t&&i(t)}),Object.keys(localStorage).forEach(e=>{e.includes("history")&&localStorage.removeItem(e)}),null===(n=window)||void 0===n||null===(l=n.location)||void 0===l||l.assign("/mail/inbox")},a=e=>{document.cookie.split("; ").forEach(t=>{let[l]=t.split("=");l.includes("auth-token")&&t&&localStorage.setItem(e+"_"+l,t)})},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:365,l=new Date(Date.now()+864e5*t).toUTCString();document.cookie="".concat(e,"; Path=/; Expires=").concat(l,";")},r=e=>{let t=new Date(Date.now()-1e3).toUTCString();document.cookie="".concat(e,"; Path=/; Expires=").concat(t,";")}},25990:function(e,t,l){"use strict";l.d(t,{Gw:function(){return c},_t:function(){return u},TH:function(){return d}});var n=l(44003),o=l(61808),a=l.n(o),i=l(87355),r=l(50026);let s=e=>{let{labelProps:t,inputProps:l}=e;return(0,n.jsxs)("label",{...t,className:a()("group relative inline-block h-4 w-4 cursor-pointer",null==t?void 0:t.className),children:[(0,n.jsx)("input",{type:"checkbox",className:"peer hidden appearance-none",...l}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center rounded border border-border-secondary hover:border-border-tertiary hover:bg-fill-primary peer-checked:bg-button-primary peer-active:scale-95 dark:border-border-dark-secondary dark:hover:border-border-dark-tertiary dark:hover:bg-fill-dark-primary dark:peer-checked:bg-button-dark-primary"}),(0,n.jsx)("div",{className:"absolute opacity-0 duration-75 group-hover:text-muted group-hover:opacity-100 peer-checked:text-white peer-checked:opacity-100 peer-active:scale-95 dark:text-primary dark:group-hover:text-muted-dark dark:peer-checked:text-primary",children:(0,n.jsx)(i.J,{path:r.N.Check})})]})},d=e=>{let{title:t,iconPath:l,group:o}=e;return(0,n.jsxs)("div",{className:'flex items-center gap-x-3 pl-2 text-body text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:[l&&(0,n.jsx)(i.J,{path:l,className:"h-4 w-4"}),(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center",style:{columnGap:"8px"},children:[(0,n.jsx)("span",{className:"text-tertiary dark:text-tertiary-dark",children:o}),(0,n.jsx)(i.J,{path:r.N.RightChevron}),(0,n.jsx)("span",{className:"font-normal",children:t})]})]})},u=e=>(0,n.jsxs)("div",{className:'flex w-full gap-x-3 pl-2 text-body text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:[(null==e?void 0:e.iconPath)&&(0,n.jsx)(i.J,{path:e.iconPath,className:"h-4 w-4"}),(0,n.jsx)("span",{className:"truncate font-normal",children:e.title})]}),c=e=>{let{item:t,children:l}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-x-3 pl-2",children:[(0,n.jsx)(s,{labelProps:{onClick:e=>{e.stopPropagation()}},inputProps:{onClick:()=>{null==t||t.onSelect()},defaultChecked:null==t?void 0:t.checked}}),l]})}},76631:function(e,t,l){"use strict";l.d(t,{ZP:function(){return $},KM:function(){return V},X6:function(){return Q}});var n,o,a,i=l(44003),r=l(46203),s=l(29970),d=l(80672),u=l(60136),c=l(71451),m=l(33329),v=l(3984),p=l(32923),h=l(87355),g=l(50026),b=l(61808),x=l.n(b),f=l(36958),y=l(1394),k=l(87767),w=l(62516),S=l(93629),C=l(25990),N=(0,y.Pi)(e=>{let{isSubItem:t}=e,{commandMenuStore:l}=(0,v.m)(),n=(0,k.useRouter)(),o=(0,f.U8)(e=>e.search),a=(0,u.H)();if((!o||l.pages.length>0)&&t)return null;let r=[{title:"Profile",value:"sub-profile",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/account/profile")})},keywords:["profile","account","settings"]},{title:"Linked Accounts",value:"sub-linked-accounts",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/account/linked-accounts")})},keywords:["linked","account","settings"]},{title:"Preferences",value:"sub-preferences",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/account/preferences")})},keywords:["preferences","settings","account"]},{title:"Default Email Client",value:"sub-default-email-client",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/account/default-email-client")})},keywords:["default","email","client","account","settings"]}];return(0,i.jsx)(i.Fragment,{children:r.map((e,l)=>(0,i.jsxs)(p.di,{id:"account-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[t?(0,i.jsx)(C.TH,{iconPath:e.iconPath,title:e.title,group:"Account Settings"}):(0,i.jsx)(C._t,{...e}),!t&&(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"account-"+l))})}),j=l(34825),I=l(27799),P=(0,y.Pi)(e=>{var t;let{isSignOut:l}=e,{commandMenuStore:n,supabaseStore:o}=(0,v.m)(),a=(0,k.useRouter)(),r=(0,c.e)(),s=(0,w.useMemo)(()=>{var e;return null===(e=Object.entries(o.userMap))||void 0===e?void 0:e.filter(e=>{var t;let[l]=e;return!!(null===(t=Object.keys(localStorage))||void 0===t?void 0:t.find(e=>e.includes(l)))})},[o.userMap]),d=(0,w.useMemo)(()=>[...(l?s:Object.entries(o.userMap)).map(e=>{var t,i,d;let[u,c]=e,m=null==s?void 0:s.find(e=>{let[t]=e;return t===u}),v=null==c?void 0:null===(i=c.name)||void 0===i?void 0:null===(t=i.at(0))||void 0===t?void 0:t.toUpperCase(),p=(null==c?void 0:c.name)+" <"+(null==c?void 0:c.email)+">",h=(0,I.Pb)(p);return{title:c.email,value:"account-"+c.email,description:null!==(d=null==c?void 0:c.avatar_url)&&void 0!==d?d:"".concat(v,"=").concat(h),onSelect:()=>{let e=()=>{Object.keys(localStorage).forEach(e=>{e.includes(u)&&localStorage.removeItem(e)})};n.runCommand(()=>{var t,n,i;if(l){if(u===(null==o?void 0:null===(t=o.userData)||void 0===t?void 0:t.id)){if((null==s?void 0:s.length)>1){let t=null==s?void 0:null===(n=s.filter(e=>(null==e?void 0:e[0])!==u))||void 0===n?void 0:n.at(0);e(),t&&(0,j.yD)(null==t?void 0:t[0])}else r.auth.signOut().then(()=>{localStorage.clear(),a.push("/sign-in")})}else e()}else m?(null===(i=o.userData)||void 0===i?void 0:i.id)!==u&&(0,j.yD)(u):(0,j.qj)({supabase:r})})},keywords:[c.email,c.name,m?"signed in":"signed out"]}}),{title:l?"Sign Out of All Accounts":"Add Account",value:"account-exit",iconPath:l?g.N.SignOut:g.N.Plus,onSelect:()=>{n.runCommand(()=>{if(l)r.auth.signOut().then(()=>{localStorage.clear(),window.location.reload()});else{var e,t;let l=null==o?void 0:null===(e=o.userData)||void 0===e?void 0:e.id,n=null==o?void 0:null===(t=o.workspaceData)||void 0===t?void 0:t.id;a.push("/sign-in?primaryUser=".concat(l,"&workspaceId=").concat(n))}})},keywords:l?["sign","out","all","account"]:["add","account"]}],[s,null==o?void 0:null===(t=o.userData)||void 0===t?void 0:t.id]);return(0,i.jsx)(i.Fragment,{children:d.map((e,t)=>{var l,n,a,r,s,d;return(0,i.jsxs)(p.di,{id:"account-"+t,value:e.value,keywords:e.keywords,className:"group",onSelect:()=>{e.onSelect()},children:[(null==e?void 0:e.description)!==void 0&&((null==e?void 0:e.description.includes("http"))?(0,i.jsx)("div",{className:"ml-1 h-6 w-6 shrink-0 rounded-full bg-red-200",style:{background:(null==e?void 0:e.description)?"center / cover url(".concat(null==e?void 0:e.description,")"):""}}):(0,i.jsx)("div",{className:"ml-1 flex h-6 w-6 shrink-0 items-center justify-center rounded-full pt-[1px] text-[11px] font-medium uppercase leading-3 text-primary-dark"+" ".concat(null==e?void 0:null===(n=e.description)||void 0===n?void 0:null===(l=n.split("="))||void 0===l?void 0:l.at(1)),children:null==e?void 0:null===(r=e.description)||void 0===r?void 0:null===(a=r.split("="))||void 0===a?void 0:a.at(0)})),(0,i.jsx)(C._t,{...e}),e.keywords.includes("signed out")&&(0,i.jsx)("div",{className:"whitespace-nowrap text-body text-quartery dark:text-quartery-dark",children:"Signed out"}),e.keywords.includes(null!==(d=null==o?void 0:null===(s=o.userData)||void 0===s?void 0:s.email)&&void 0!==d?d:"")&&(0,i.jsx)("div",{className:'text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:(0,i.jsx)(h.J,{path:g.N.Check})})]},"account-"+t)})})}),T=(0,y.Pi)(e=>{let{isSubItem:t}=e,{commandMenuStore:l,modalsStore:n}=(0,v.m)();if((!(0,f.U8)(e=>e.search)||l.pages.length>0)&&t)return null;let o=[{title:"Report Problem",value:"sub-report-problem",iconPath:g.N.Alert,onSelect:()=>{l.runCommand(()=>{n.onFeedbackModalOpen("problem")})},keywords:["contact","support","report","problem","issue","bug"]},{title:"Ask Question",value:"sub-ask-question",iconPath:g.N.Help,onSelect:()=>{l.runCommand(()=>{n.onFeedbackModalOpen("question")})},keywords:["contact","support","ask","question","help"]},{title:"Make Suggestion",value:"sub-make-suggestion",iconPath:g.N.Feedback,onSelect:()=>{l.runCommand(()=>{n.onFeedbackModalOpen("suggestion")})},keywords:["contact","support","suggest","idea","feedback"]}];return(0,i.jsx)(i.Fragment,{children:o.map((e,l)=>(0,i.jsxs)(p.di,{id:"feedback-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[t?(0,i.jsx)(C.TH,{iconPath:e.iconPath,title:e.title,group:"Contact Support"}):(0,i.jsx)(C._t,{...e}),!t&&(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"feedback-"+l))})});let M=/[\n\r\t"#'.*+~>:\\[\]()='`!@$%^&|\\]+/g;function L(e){return e.replace(M,"")}var A=(0,y.Pi)(function(e){var t,l,n,o,a,r;let{isSingleThreadView:s,data:d}=e,{keyboardStore:u,commandMenuStore:c,inboxStore:m}=(0,v.m)(),h=(null===(t=u.currentIndex)||void 0===t?void 0:t[0])===0?u.selectedIndices[0][1]:null===(l=u.currentIndex)||void 0===l?void 0:l[1],b=s?null===(o=m.currentThread)||void 0===o?void 0:null===(n=o.messages)||void 0===n?void 0:n.slice(-1)[0]:null===(r=d[h])||void 0===r?void 0:null===(a=r.messages)||void 0===a?void 0:a.slice(-1)[0],x=(0,I.Gr)(null==b?void 0:b.payload),f=(0,I.K9)(x),y=f&&new TextDecoder("utf-8").decode(f),k=Array.from((0,w.useMemo)(()=>{let e=new Map;return y&&new DOMParser().parseFromString(y,"text/html").querySelectorAll("a[href]").forEach(t=>{var l,n,o,a,i;let r=t.getAttribute("href"),s=L(null!==(l=t.textContent)&&void 0!==l?l:"");if(r.startsWith("mailto:"))return;if(""===s){let e=t.querySelector("img");if(e)s=null!==(o=null===(n=e.getAttribute("alt"))||void 0===n?void 0:n.replace(/[\n\r\t"]+/g,"").trim())&&void 0!==o?o:"";else{let e=t.querySelector("span");e&&(s=null!==(i=null===(a=e.textContent)||void 0===a?void 0:a.replace(/[\n\r\t"]+/g,"").trim())&&void 0!==i?i:"")}}let d=s.trim();if(""===d||d.startsWith("http"))return;let u=d.charAt(0).toUpperCase()+d.slice(1);e.has(r)||e.set(r,u)}),e},[y]),e=>{let[t,l]=e;return{title:l,value:l+" "+L(t),iconPath:g.N.External,onSelect:()=>{c.setCommandMenuOpen(!1),window.open(t,"_blank")},description:t,shortcut:V(""),keywords:[l.toLowerCase()]}});return(0,i.jsx)(i.Fragment,{children:k.map((e,t)=>(0,i.jsxs)(p.di,{id:"embedded-"+t,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[(0,i.jsx)(C._t,{...e}),(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"embedded-"+t))})}),O=(0,y.Pi)(e=>{let{isSubItem:t}=e,{commandMenuStore:l}=(0,v.m)(),n=(0,k.useRouter)(),o=(0,f.U8)(e=>e.search),a=(0,u.H)();if((!o||l.pages.length>0)&&t)return null;let r=[{title:"Social",value:"sub-social",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/social")})},keywords:["social","mail","settings"]},{title:"Split Inbox",value:"sub-split-inbox",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/split-inbox")})},keywords:["split","inbox","mail","settings"]},{title:"Labels",value:"sub-labels",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/labels")})},keywords:["labels","mail","settings"]},{title:"Signature",value:"sub-signature",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/signature")})},keywords:["signature","mail","settings"]},{title:"Notifications",value:"sub-notifications",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/notifications")})},keywords:["notifications","mail","settings"]},{title:"Meeting Links",value:"sub-meeting-links",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/meeting-links")})},keywords:["meeting","links","mail","settings"]},{title:"Blocked Senders",value:"sub-blocked-senders",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/blocked-senders")})},keywords:["blocked","senders","mail","settings"]},{title:"Sweep Inbox",value:"sub-sweep-inbox",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/mail/sweep-inbox")})},keywords:["sweep","inbox","mail","settings"]}];return(0,i.jsx)(i.Fragment,{children:r.map((e,l)=>(0,i.jsxs)(p.di,{id:"mail-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[t?(0,i.jsx)(C.TH,{iconPath:e.iconPath,title:e.title,group:"General Settings"}):(0,i.jsx)(C._t,{...e}),!t&&(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"mail-"+l))})}),R=l(70137),E=l(95470);let U=(0,y.Pi)(e=>{var t;let{data:l,mode:n,changeThreadLabels:o,isSubItem:a=!1}=e,{toastStore:{addToast:r},commandMenuStore:s,transactionStore:c}=(0,v.m)(),m=(0,k.usePathname)(),h=(0,k.useRouter)(),b=(0,f.U8)(e=>e.search),y=(0,u.H)(),{keyboardStore:N,labelStore:j,inboxStore:P}=(0,v.m)(),T=(0,w.useMemo)(()=>(0,d._f)(m),[m]),M=(0,w.useMemo)(()=>{var e,t,n,o;return(null===(e=N.selectedIndices)||void 0===e?void 0:e.length)>0?N.selectedIndices.map(e=>{var t;return null===(t=l[e[1]])||void 0===t?void 0:t.id}):T?[null===(t=P.currentThread)||void 0===t?void 0:t.id]:[null==l?void 0:null===(n=l[null===(o=N.currentIndex)||void 0===o?void 0:o[1]])||void 0===n?void 0:n.id]},[l,N.selectedIndices,P.currentThread,N.currentIndex,T]),L=(e,t)=>{let n=M.map(e=>l.find(t=>t.id===e)).flatMap(l=>{if(!l)return[];let n=l.messages.some(t=>t.labelIds.includes(null==e?void 0:e.id));return!n&&!t||n&&t?l.messages.map(e=>e.id):[]});o({hasLabel:t,threadIds:M,emailIds:n,labelIds:[null==e?void 0:e.id],subject:e.name,doesAddToast:!0})},A=(0,w.useMemo)(()=>{let e=T?[P.currentThread]:M.map(e=>l.find(t=>t.id===e)),t=new Set;return e.forEach(e=>{var l;null==e||null===(l=e.messages)||void 0===l||l.forEach(e=>{var l;null===(l=e.labelIds)||void 0===l||l.forEach(e=>{let l=j.userLabels.find(t=>t.id===e);l&&t.add(l)})})}),Array.from(t)},[String(M),j.userLabels,s.isCommandMenuOpen]),O=(0,w.useMemo)(()=>j.userLabels.filter(e=>!e.name.includes("[Tatem]")),[j.userLabels,s.isCommandMenuOpen]),U=(0,w.useMemo)(()=>{var e;let t=T?[P.currentThread]:M.map(e=>l.find(t=>t.id===e));return null===(e=A.map(e=>{var l;let o=t.some(t=>null!=t&&!!t.messages&&t.messages.some(t=>t.labelIds.includes(e.id)));return{title:e.name,iconPath:g.N.Label,checked:o,onSelect:()=>{"navigate"===n?h.push(y+"/labels/"+(null==e?void 0:e.id)):"remove"===n?L(e,!0):L(e,o)},keyword:e.name,color:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor,remove:!0}}))||void 0===e?void 0:e.filter(e=>!!e)},[l,A]),D=(0,w.useMemo)(()=>{var e;let t=T?[P.currentThread]:M.map(e=>l.find(t=>t.id===e));return null===(e=O.map(e=>{var l;let o=t.some(t=>{var l;return null!=t&&!!t.messages&&(null===(l=t.messages)||void 0===l?void 0:l.some(t=>t.labelIds.includes(e.id)))});return{title:e.name,iconPath:g.N.Label,checked:o,onSelect:()=>{"navigate"===n?h.push(y+"/labels/"+(null==e?void 0:e.id)):L(e,o)},keyword:e.name,color:null==e?void 0:null===(l=e.color)||void 0===l?void 0:l.backgroundColor}}))||void 0===e?void 0:e.filter(e=>!!e)},[O,l,P.currentThread]),F="remove"===n?U:"create"===n?D.map(e=>({...e,onSelect:()=>s.runCommand(()=>{r(S.t.lambdas.LabelCreationFailed({primaryText:'A label with the name "'.concat(null==e?void 0:e.title,'" already exists.')}))})})):"color"===n?[]:[...D];return a&&!b?null:(0,i.jsxs)(i.Fragment,{children:[F.map((e,t)=>{var l,o;let r=t>0&&(null===(l=F[t-1])||void 0===l?void 0:l.remove)&&!e.remove;return"create"!==n||b?(0,i.jsxs)(w.Fragment,{children:[r&&(0,i.jsx)("hr",{className:"w-full border-t border-border-primary dark:border-border-dark-primary"}),(0,i.jsx)(p.di,{id:"label-"+t,value:(a?"".concat((null==e?void 0:e.checked)?"remove":"add"," label "):"")+e.keyword,className:x()("[&_[cmdk-item]]:item-svg group [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5"),keywords:[e.keyword],onSelect:()=>{s.runCommand(()=>{e.onSelect()})},children:a?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"ml-3 mr-2 h-2 w-2 rounded-full bg-red-400",style:{backgroundColor:null!==(o=null==e?void 0:e.color)&&void 0!==o?o:void 0}}),(0,i.jsx)(C.TH,{title:null==e?void 0:e.title,group:(null==e?void 0:e.checked)?"Remove Label":"Add Label"})]}):"toggle"===n?(0,i.jsx)(C.Gw,{item:e,children:(0,i.jsx)(_,{item:e})}):(0,i.jsx)("div",{className:"flex items-center gap-3 pl-2",children:(0,i.jsx)(_,{item:e})})})]},"label-"+t):null}),"create"===n&&!!b&&(0,i.jsx)(p.di,{id:"label-new",forceMount:!0,value:"create:".concat(b,":"),className:"group",onSelect:()=>{O.find(e=>e.name===b)?s.runCommand(()=>{r(S.t.lambdas.LabelCreationFailed({primaryText:'A label with the name "'.concat(b,'" already exists.')}))}):setTimeout(()=>{s.setPages([...s.pages,'Pick a color for "'.concat(b,'"')]),s.setSearchInput("")},10)},children:(0,i.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,i.jsx)("div",{className:'h-2 w-2 rounded-full border border-secondary group-data-[selected="true"]:border-primary dark:border-secondary-dark dark:group-data-[selected="true"]:border-primary-dark'}),(0,i.jsxs)("span",{className:'text-body font-normal text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:["Create New Label: “",b,"”"]})]})},"create-new-label-"+b),"color"===n&&(null===(t=Object.keys(R.m8).filter(e=>null==e?void 0:e.includes("400")))||void 0===t?void 0:t.map(e=>{var t;return(0,i.jsx)(p.di,{id:"label-"+e,value:e,className:"group",onSelect:()=>{var t,l,n;let o=null!==(n=null===(l=[...s.pages].pop())||void 0===l?void 0:null===(t=l.split('"'))||void 0===t?void 0:t[1])&&void 0!==n?n:"",a=S.t.lambdas.LabelCreated({primaryText:o});s.runCommand(async()=>{var t;c.enqueue({transaction:{type:E.e.CreateLabel,name:o,tailwindColor:e,actionTitle:a.title,emailIds:(null==M?void 0:null===(t=M.filter(e=>!!e))||void 0===t?void 0:t.length)>0?M:void 0}}),r(a)})},children:(0,i.jsx)("div",{className:"flex items-center gap-3 pl-2",children:(0,i.jsx)(_,{item:{title:(0,I.fm)(null==e?void 0:null===(t=e.split("-"))||void 0===t?void 0:t[1]),color:e}})})},e)}))]})}),D=(0,y.Pi)(()=>{let{labelStore:e,commandMenuStore:t}=(0,v.m)(),l=(0,k.useRouter)(),n=(0,f.U8)(e=>e.search),o=(0,u.H)(),a=(0,w.useMemo)(()=>e.userLabels.map(e=>{var t;return{title:e.name,value:"open"+e.name,iconPath:g.N.Label,onSelect:()=>{l.push(o+"/labels/"+e.id)},keywords:[e.name.toLowerCase()],color:null==e?void 0:null===(t=e.color)||void 0===t?void 0:t.backgroundColor}}).filter(e=>!!e),[e.userLabels]);return n?(0,i.jsx)(i.Fragment,{children:a.map((e,l)=>(0,i.jsx)(p.di,{id:"openLabel-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:l=>{t.runCommand(()=>{e.onSelect()})},children:(0,i.jsx)(C.TH,{title:null==e?void 0:e.title,iconPath:e.iconPath,group:"Open Label"})},"openLabel-"+l))}):null}),_=e=>{var t,l;let{item:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-2 w-2 rounded-full "+((null==n?void 0:null===(t=n.color)||void 0===t?void 0:t.includes("-"))?null==n?void 0:n.color:"bg-red-400"),style:{backgroundColor:(null==n?void 0:null===(l=n.color)||void 0===l?void 0:l.includes("-"))?void 0:null==n?void 0:n.color}}),(0,i.jsx)("span",{className:'text-body font-normal text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:n.title})]})};var F=l(15205),q=(0,y.Pi)(e=>{let{data:t}=e,{commandMenuStore:l,supabaseStore:n,keyboardStore:o,inboxStore:a,toastStore:{addToast:r}}=(0,v.m)(),s=(0,c.e)(),d=(0,k.useRouter)(),m=(0,k.usePathname)(),h=(0,f.U8)(e=>e.search),[g,b]=(0,w.useState)(""),x=(0,u.H)(),y=e=>{var t,l,o;let a=[...n.inboxSplits].toSpliced(-1,0,e);if(n.inboxSplits.some(t=>t.name.toLowerCase()===e.name.toLowerCase())){r(S.t.lambdas.SplitUpdateFailed({primaryText:"A split inbox with the name “".concat(e.name,"” already exists")}));return}let i=null==a?void 0:null===(l=a.filter(e=>!F.k.includes(null==e?void 0:e.name)&&!!e.active&&!e.showInInbox))||void 0===l?void 0:null===(t=l.map(e=>" -(".concat(e.value,")")))||void 0===t?void 0:t.join("");F.k.forEach(e=>{let t=a.findIndex(t=>t.name===e);a[t].value=("Inbox"===e?"":"Important"===e?"category:personal":"-(category:personal)")+i}),r(S.t.lambdas.SplitCreationCompleted({primaryText:e.name})),n.setInboxSplits(a),s.from("users").update({splits:a}).eq("id",null==n?void 0:null===(o=n.userData)||void 0===o?void 0:o.id).then(),d.push(x+"/inbox/"+e.name.toLowerCase())},N=(0,w.useMemo)(()=>n.inboxSplits.filter(e=>e.active&&!F.k.includes(e.name)),[n.userMap]),j=(0,w.useMemo)(()=>{var e,l;return m.includes("/thread/")?a.currentThread:null==t?void 0:t.at(null!==(l=null===(e=o.currentIndex)||void 0===e?void 0:e.at(1))&&void 0!==l?l:0)},[t,o.currentIndex,m]),P=(0,w.useMemo)(()=>{var e;return null==j?void 0:null===(e=j.messages)||void 0===e?void 0:e.at(0)},[j]),T=(0,w.useMemo)(()=>P&&(0,I.e6)((0,I.Uq)(P,"from",!1)),[P]),M=(0,w.useMemo)(()=>{var e;let t=P&&(0,I.Uq)(P,"to",!1);return null==t?void 0:null===(e=t.split(",").map(e=>(0,I.e6)(e)))||void 0===e?void 0:e.join(" ")},[P]),L=(0,w.useMemo)(()=>{var e;return null===(e=T.split("@"))||void 0===e?void 0:e.at(1)},[T]),A=(0,w.useMemo)(()=>{var e;if(L&&(null===(e=L.split("."))||void 0===e?void 0:e.length)>2){let e=L.split(".");return"".concat(null==e?void 0:e.at(-2),".").concat(null==e?void 0:e.at(-1))}return null},[L]),O=(0,w.useMemo)(()=>P&&(0,I.Uq)(P,"subject",!1),[P]),R=e=>l.pages.includes("New Split Inbox")?"New Split Inbox with ".concat(e,": "):"Add ".concat(e," to Split Inbox: "),E=(0,w.useMemo)(()=>g?l.pages.includes("New Split Inbox")?[]:N.map(e=>({title:e.name,value:e.value,onSelect:()=>{l.runCommand(()=>{var t,l,o;let a=[...n.inboxSplits],i=a.findIndex(t=>(null==t?void 0:t.name)===(null==e?void 0:e.name));i>=0&&(a[i].value=a[i].value+" OR ".concat(g));let r=null==a?void 0:null===(l=a.filter(e=>!F.k.includes(null==e?void 0:e.name)&&!!e.active&&!e.showInInbox))||void 0===l?void 0:null===(t=l.map(e=>" -(".concat(e.value,")")))||void 0===t?void 0:t.join("");F.k.forEach(e=>{let t=a.findIndex(t=>t.name===e);a[t].value=("Inbox"===e?"":"Important"===e?"category:personal":"-(category:personal)")+r}),n.setInboxSplits(a),s.from("users").update({splits:a}).eq("id",null==n?void 0:null===(o=n.userData)||void 0===o?void 0:o.id).then()})},keywords:[e.name,e.value]})):[{title:R("Sender")+T,value:"sender-split-inbox",onSelect:()=>{b("from:".concat(T)),l.setSearchInput("")},keywords:["add sender to split inbox",null!=T?T:""]},..."gmail.com"!==L?[...A?[{title:R("Domain")+A,value:"domain-split-inbox",onSelect:()=>{b("from:".concat(A)),l.setSearchInput("")},keywords:["add domain to split inbox",null!=A?A:""]}]:[],{title:R(A?"Subdomain":"Domain")+L,value:"subdomain-split-inbox",onSelect:()=>{b("from:".concat(L)),l.setSearchInput("")},keywords:["add subdomain to split inbox","domain",null!=L?L:""]}]:[],{title:R("Subject")+O,value:"subject-split-inbox",onSelect:()=>{b("subject:".concat(O)),l.setSearchInput("")},keywords:["add subject to split inbox",null!=O?O:""]},{title:R("Recipients")+M.replaceAll(" ",", "),value:"recipients-split-inbox",onSelect:()=>{b("to:".concat(M)),l.setSearchInput("")},keywords:["add recipients to split inbox",null!=M?M:""]}],[N,!!g]);return(0,i.jsxs)(i.Fragment,{children:[E.map((e,t)=>(0,i.jsx)(p.di,{id:"split-inbox-"+t,value:e.value,keywords:e.keywords,className:"group",onSelect:()=>{e.onSelect()},children:(0,i.jsx)(C._t,{...e})},"split-inbox-"+t)),l.pages.includes("New Split Inbox")&&!!g&&!!h&&(0,i.jsx)(p.di,{id:"split-new",forceMount:!0,value:"create:".concat(h,":"),keywords:["create new split inbox",h],className:"group",onSelect:()=>{l.runCommand(()=>{y({name:h,value:g,active:!0,showInInbox:!1})})},children:(0,i.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[(0,i.jsx)("div",{className:'h-2 w-2 rounded-full border border-secondary group-data-[selected="true"]:border-primary dark:border-secondary-dark dark:group-data-[selected="true"]:border-primary-dark'}),(0,i.jsxs)("span",{className:'text-body font-normal text-secondary group-data-[selected="true"]:text-primary dark:text-secondary-dark dark:group-data-[selected="true"]:text-primary-dark',children:["Create New Split Inbox: “",h,"”"]})]})},"create-new-split-"+h)]})});let B=(0,y.Pi)(e=>{let{isSubItem:t}=e,{uiStore:{setTheme:l},commandMenuStore:n,toastStore:{addToast:o}}=(0,v.m)();if((!(0,f.U8)(e=>e.search)||n.pages.length>0)&&t)return null;let a=[{title:"System Preference",value:"sub-system-preference",iconPath:g.N.Cog,onSelect:()=>{n.runCommand(()=>{l("system"),o(S.t.lambdas.ThemeChanged({primaryText:"system"}))})},keywords:["change","system","preference","theme"]},{title:"Light",value:"sub-light",iconPath:g.N.Cog,onSelect:()=>{n.runCommand(()=>{l("light"),o(S.t.lambdas.ThemeChanged({primaryText:"light"}))})},keywords:["change","light","theme"]},{title:"Dark",value:"sub-dark",iconPath:g.N.Cog,onSelect:()=>{n.runCommand(()=>{l("dark"),o(S.t.lambdas.ThemeChanged({primaryText:"dark"}))})},keywords:["change","dark","theme"]}];return(0,i.jsx)(i.Fragment,{children:a.map((e,l)=>(0,i.jsxs)(p.di,{id:"theme-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[t?(0,i.jsx)(C.TH,{...e,group:"Change Theme"}):(0,i.jsx)(C._t,{...e}),!t&&(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"theme-"+l))})});var z=l(19959),H=l(16502);function G(e,t,l){if(t.length>1)return{isActive:e,count:t.length};{let{lastMessageSubject:n}=(0,d.hV)(t[0],l);return{isActive:e,primaryText:n}}}let W=(0,y.Pi)(e=>{let{data:t,isSingle:l,labelThreadActions:n}=e,{keyboardStore:o,commandMenuStore:a,toastStore:{addToast:r},inboxStore:s,labelStore:c,modalsStore:m,peopleStore:h,supabaseStore:b}=(0,v.m)(),f=(0,k.usePathname)(),y=(0,k.useRouter)(),N=(0,w.useMemo)(()=>o.selectedIndices.length>1,[o.selectedIndices]),j=(0,w.useMemo)(()=>(0,d._f)(f),[f]),{spamToggleThreads:P,deleteToggleThreads:T,unreadToggleThreads:M,starToggleThreads:L,archiveToggleThreads:A,changeThreadLabels:O,blockSenderAction:E}=(0,w.useMemo)(()=>n,[n]),U=(0,u.H)(),D=(0,w.useMemo)(()=>{var e,l;return o.selectedIndices.length>1?o.selectedIndices.map(e=>{var l;return null===(l=t[e[1]])||void 0===l?void 0:l.id}):1===o.selectedIndices.length?[null===(e=t[o.selectedIndices[0][1]])||void 0===e?void 0:e.id]:[null===(l=t[o.currentIndex[1]])||void 0===l?void 0:l.id]},[o.selectedIndices,o.currentIndex,t]),_=(0,w.useMemo)(()=>j?[f.split("/").pop()]:D,[j,D,f]),q=(0,w.useMemo)(()=>_.every(e=>(0,I.g4)(e,"STARRED",t)),[_,t]),B=(0,w.useMemo)(()=>_.every(e=>!(0,I.g4)(e,"INBOX",t)),[_,t]),W=(0,w.useMemo)(()=>_.every(e=>(0,I.g4)(e,"TRASH",t)),[_,t]),K=(0,w.useMemo)(()=>_.every(e=>(0,I.g4)(e,"SPAM",t)),[_,t]),Y=(0,w.useMemo)(()=>_.every(e=>{let l=(0,I.mi)(e,t);return!!l&&l.messages.some(e=>{var t,l;return null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:t.some(e=>(null==e?void 0:e.name)==="List-Unsubscribe")})}),[_,t]),J=(0,w.useMemo)(()=>_.every(e=>(0,I.g4)(e,"UNREAD",t)),[_,t]),Z=(0,w.useMemo)(()=>_.every(e=>{var l;return null===(l=c.userLabels)||void 0===l?void 0:l.find(l=>(0,I.g4)(e,null==l?void 0:l.id,t))}),[_,t]),X=(0,w.useMemo)(()=>z.C_.includes(c.currentLabel),[c.currentLabel]),$=(0,w.useMemo)(()=>_.every(e=>{var l,n;let o=(0,I.mi)(e,t);if(!o)return!1;let a=null==o?void 0:null===(l=o.messages)||void 0===l?void 0:l.at(0),i=(0,I.Uq)(a,"From",!1);return!!(null===(n=h.blockedSenders)||void 0===n?void 0:n.find(e=>null==i?void 0:i.includes(e)))}),[_,t]),ee=(0,w.useMemo)(()=>{var e;return!!(null===(e=b.inboxSplits.filter(e=>!!e.active&&!F.k.includes(e.name)))||void 0===e?void 0:e.length)},[b.inboxSplits]),et=(0,w.useMemo)(()=>[...X?[]:[{title:"".concat(B?"Unarchive":"Archive"," ").concat(N?"Conversations":"Conversation"),value:"archive-conversation",onSelect:()=>{if(X||_.some(e=>void 0===e))return;let e=G(B,_,t),l=j?[s.currentThread]:_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(l.some(e=>void 0===e))return;let n=l.filter(e=>void 0!==e),i=null==n?void 0:n.flatMap(e=>{var t,l;return null==e?void 0:null===(l=e.messages)||void 0===l?void 0:null===(t=l.filter(e=>B||e.labelIds.includes("INBOX")))||void 0===t?void 0:t.map(e=>e.id)});a.runCommand(()=>{if(A({hasLabel:B,threadIds:_,emailIds:i,toastProps:e}),j&&(z.uC.includes(c.currentLabel)||c.currentLabel.startsWith("INBOX"))){var l;let e=null!==(l=null==t?void 0:t.findIndex(e=>(null==e?void 0:e.id)===_[0]))&&void 0!==l?l:-1,n=(0,I.NF)(t,e,_[0],s.setCurrentThread),o="".concat(f.split("/thread").at(0)).concat(n);y.push(o)}}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V(B?"⇧ E":"E"),iconPath:g.N.Archive,keywords:["".concat(B?"unarchive":"archive"),"conversation"]}],{title:"Remind Me (Snooze Conversation".concat(N?"s":"",")"),value:"remind-me-snooze-conversation",shortcut:V("H"),keywords:["remind","me","snooze","conversation"],iconPath:g.N.Clock,onSelect:()=>{a.runCommand(()=>{})}},{title:"".concat(q?"Unstar":"Star"," ").concat(N?"Conversations":"Conversation"),value:"star-conversation",onSelect:()=>{let e=j?[s.currentThread]:_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(e.some(e=>void 0===e))return;let l=e.filter(e=>void 0!==e),n=null==l?void 0:l.flatMap(e=>null==e?void 0:e.messages.map(e=>e.id)),i=G(q,_,t);a.runCommand(()=>{L({hasLabel:q,threadIds:_,emailIds:n,toastProps:i})}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("S"),iconPath:g.N.Star,keywords:["".concat(q?"unstar":"star"),"conversation"]},{title:"Move ".concat(N?"Conversations":"Conversation"),value:"move-conversation",onSelect:()=>{a.runCommand(()=>{})},shortcut:V("M"),iconPath:g.N.Move,keywords:["move","conversation"]},...l?[{title:"Reply To Sender",value:"reply-to-sender",onSelect:()=>{a.runCommand(()=>{if(j){let e=t.find(e=>(null==e?void 0:e.id)===_[0]),l=null==e?void 0:e.messages.at(-1),n=document.getElementById("reply-button-".concat(null==l?void 0:l.id));n&&n.click()}else{var e;let l=t.find(e=>(null==e?void 0:e.id)===_[0]);if(!l)return;let n=null==l?void 0:l.messages.at(-1),o=document.getElementsByClassName("fixed-list")[0];localStorage.setItem("scrollPos",String(null!==(e=null==o?void 0:o.scrollTop)&&void 0!==e?e:0)),y.push(f+"/thread/"+(null==l?void 0:l.id)+"?reply="+(null==n?void 0:n.id))}})},shortcut:V("R"),iconPath:g.N.Reply,keywords:["reply","to","sender"]},{title:"Reply To All",value:"reply-to-all",onSelect:()=>{a.runCommand(()=>{if(j){let e=t.find(e=>(null==e?void 0:e.id)===_[0]),l=null==e?void 0:e.messages.at(-1),n=document.getElementById("reply-all-button-".concat(null==l?void 0:l.id));n&&n.click()}else y.push(f+"/thread/"+_[0]),setTimeout(()=>{let e=t.find(e=>(null==e?void 0:e.id)===_[0]);if(!e)return;let l=e.messages.at(-1),n=document.getElementById("reply-all-button-".concat(null==l?void 0:l.id));n&&n.click()},350)})},shortcut:V("Enter"),iconPath:g.N.ReplyAll,keywords:["reply","to","all"]},{title:"Forward Message",value:"forward-message",onSelect:()=>{a.runCommand(()=>{if(j){let e=t.find(e=>(null==e?void 0:e.id)===_[0]),l=null==e?void 0:e.messages.at(-1),n=document.getElementById("forward-button-".concat(null==l?void 0:l.id));n&&n.click()}else{var e;let l=t.find(e=>(null==e?void 0:e.id)===_[0]);if(!l)return;let n=l.messages.at(-1),o=document.getElementsByClassName("fixed-list")[0];localStorage.setItem("scrollPos",String(null!==(e=null==o?void 0:o.scrollTop)&&void 0!==e?e:0)),y.push(f+"/thread/"+(null==l?void 0:l.id)+"?forward="+(null==n?void 0:n.id))}})},shortcut:V("F"),iconPath:g.N.Forward,keywords:["forward","message"]}]:[],{title:"Mark ".concat(N?"Conversations":"Conversation"," ").concat(J?"Read":"Unread"),value:"mark-conversation-read",onSelect:()=>{let e=j?[s.currentThread]:_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(e.some(e=>void 0===e))return;let l=e.filter(e=>void 0!==e),n=null==l?void 0:l.flatMap(e=>null==e?void 0:e.messages.map(e=>e.id)),i=G(!J,_,t);a.runCommand(()=>{M({hasLabel:J,threadIds:_,emailIds:n,toastProps:i}),j&&y.push(U+"/"+c.currentLabel.toLowerCase())}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("U"),iconPath:g.N.Unread,keywords:["".concat(J?"mark":"unmark"),"conversation","".concat(J?"read":"unread")]},...N?[]:[{title:"Open Embedded Links",value:"open-embedded-links",onSelect:()=>{let e=a.searchInput;a.setLastSearchQuery(e),a.setSearchInput(""),a.setPages(["Embedded Links"])},shortcut:V("⌘ O"),iconPath:g.N.External,keywords:["open","embedded","links"]}],{title:"Unsubscribe",value:"unsubscribe-opt-out",onSelect:()=>{Y?Q("Unsubscribe",a):$||a.runCommand(()=>{var e,l,n;let o=(0,I.mi)(null!==(l=null==_?void 0:_.at(0))&&void 0!==l?l:"",t),a=null==o?void 0:null===(e=o.messages)||void 0===e?void 0:e.at(0),i=o&&(0,I.e6)((0,I.Uq)(a,"From",!1));if(i){let e="".concat(null==i?void 0:null===(n=i.split("@"))||void 0===n?void 0:n.join("".concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203))));m.setAlertModalObj({alertMsg:"Block sender instead?",alertDescription:"We can’t find a link to unsubscribe. Would you like to block the sender instead? This will delete all messages, including future messages, from ".concat(e,"."),alertCode:H.xK.BLOCK_SENDER,onConfirm:{title:"Block",onClick:()=>{if(E({email:i,isSenderBlocked:$}),!$&&f.includes("/thread/")){var e;let t=null===(e=document.getElementById("next-email-button-no-scroll"))||void 0===e?void 0:e.href;t&&y.push(t)}}},onClose:{title:"Cancel"}}),m.setAlertModalOpen(!0)}})},shortcut:V("⌘ U"),iconPath:g.N.Unsubscribe,keywords:["unsubscribe","opt out"]},{title:$?"Unblock Sender":"Block Sender",value:$?"unblock-sender":"block-sender",onSelect:()=>{a.runCommand(()=>{var e,l,n;let o=(0,I.mi)(null!==(l=null==_?void 0:_.at(0))&&void 0!==l?l:"",t),a=null==o?void 0:null===(e=o.messages)||void 0===e?void 0:e.at(0),i=o&&(0,I.e6)((0,I.Uq)(a,"From",!1));if(i){let e="".concat(null==i?void 0:null===(n=i.split("@"))||void 0===n?void 0:n.join("".concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203))));m.setAlertModalObj({alertMsg:$?"Unblock sender?":"Block sender?",alertDescription:$?"Do you want to unblock ".concat(e,"?"):"This will delete all messages, including future messages, from ".concat(e,"."),alertCode:H.xK.BLOCK_SENDER,onConfirm:{title:$?"Unblock":"Block",onClick:()=>{if(E({email:i,isSenderBlocked:$}),!$&&f.includes("/thread/")){var e;let t=null===(e=document.getElementById("next-email-button-no-scroll"))||void 0===e?void 0:e.href;t&&y.push(t)}}},onClose:{title:"Cancel"}}),m.setAlertModalOpen(!0)}})},iconPath:g.N.Block,keywords:["block sender","unsubscribe"]},{title:(W?R.Wz.Undelete.title:R.Wz.Delete.title)+(N?"s":""),value:"delete-conversation",onSelect:()=>{let e=j?[s.currentThread]:_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(e.some(e=>void 0===e))return;let l=e.filter(e=>void 0!==e),n=null==l?void 0:l.flatMap(e=>null==e?void 0:e.messages.map(e=>e.id)),i=G(W,_,t);a.runCommand(()=>{if(T({isTrash:W,threadIds:_,emailIds:n,toastProps:i,isArchived:B,isSpam:K}),j){var e;let l=null!==(e=null==t?void 0:t.findIndex(e=>(null==e?void 0:e.id)===_[0]))&&void 0!==e?e:-1,n=(0,I.NF)(t,l,_[0],s.setCurrentThread),o="".concat(f.split("/thread").at(0)).concat(n);y.push(o)}}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V(W?R.Wz.Undelete.keys.join(" "):R.Wz.Delete.keys.join(" ")),iconPath:g.N.Trash,keywords:["".concat(W?"undelete":"delete"),"conversation"]},{title:"".concat(K?"Unmark":"Mark"," ").concat(N?"Conversations":"Conversation"," Spam"),value:"mark-conversation-spam",onSelect:()=>{let e=j?[s.currentThread]:_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(e.some(e=>void 0===e))return;let l=e.filter(e=>void 0!==e),n=null==l?void 0:l.flatMap(e=>null==e?void 0:e.messages.map(e=>e.id)),i=G(K,_,t);a.runCommand(()=>{if(P({isSpam:K,threadIds:_,emailIds:n,toastProps:i,isArchived:B,isTrash:W}),j){var e;let l=null!==(e=null==t?void 0:t.findIndex(e=>(null==e?void 0:e.id)===_[0]))&&void 0!==e?e:-1,n=(0,I.NF)(t,l,_[0],s.setCurrentThread),o="".concat(f.split("/thread").at(0)).concat(n);y.push(o)}}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("!"),iconPath:g.N.Spam,keywords:["".concat(K?"unmark":"mark"),"conversation spam"]},...!j&&l?[{title:"Open Conversation",value:"open-conversation",onSelect:()=>{a.runCommand(()=>{var e;y.push(U+"/thread/".concat(null===(e=t[o.currentIndex[1]])||void 0===e?void 0:e.id))})},shortcut:V("O"),iconPath:g.N.RightArrow,keywords:["open","conversation"]}]:[],...j?[{title:"Open All Threaded Messages",value:"open-all-threaded-messages",onSelect:()=>{a.runCommand(()=>{let e=document.querySelectorAll('button[id^="open-message-button"]:not(.hidden)'),t=t=>Array.from(e).every(e=>e.getAttribute("data-state-open")===t),l=t("true"),n=t("false");e.forEach(e=>{(l||n||"false"===e.getAttribute("data-state-open"))&&e.click()})})},shortcut:V("⇧ O"),iconPath:g.N.RightArrow,keywords:["open","all","threaded","messages"]}]:[],{title:"Copy Conversation ".concat(N?"URLs":"URL"),value:"copy-conversation-url",onSelect:()=>{a.runCommand(()=>{let e=_.map(e=>window.location.origin+U+"/thread/"+e),t=e.join("\n");navigator.clipboard.writeText(t),r(S.t.lambdas.ConversationUrlCopied({href:e[0],count:e.length}))})},shortcut:V("⌘ ⇧ ,"),iconPath:g.N.Copy,keywords:["copy","conversation","urls"]},{title:"Copy ".concat(N?"Subjects":"Subject"),value:"copy-subject",onSelect:()=>{a.runCommand(()=>{let e=_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(!e)return;let l=e.map(e=>{var t,l,n,o;let a=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return null==a?void 0:null===(o=a.payload)||void 0===o?void 0:null===(n=o.headers)||void 0===n?void 0:null===(l=n.find(e=>(null==e?void 0:e.name)==="Subject"))||void 0===l?void 0:l.value}),n=l.join("\n");navigator.clipboard.writeText(n),r(S.t.lambdas.SubjectCopied({primaryText:n,count:l.length}))}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("⌘ ⇧ '"),iconPath:g.N.Copy,keywords:["copy","subject"]},{title:"Copy ".concat(N?"Senders' Names":"Sender's Name"),value:"copy-senders-name",onSelect:()=>{a.runCommand(()=>{let e=_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(!e)return;let l=e.map(e=>{var t,l,n,o,a;let i=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,I.Kc)(null!==(a=null==i?void 0:null===(o=i.payload)||void 0===o?void 0:null===(n=o.headers)||void 0===n?void 0:null===(l=n.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==a?a:"")}),n=l.join("\n");navigator.clipboard.writeText(n),r(S.t.lambdas.SenderCopied({primaryText:n,count:l.length}))}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("⌘ ."),iconPath:g.N.Copy,keywords:["copy","senders","names"]},{title:"Copy ".concat(N?"Senders' Addresses":"Sender's Address"),value:"copy-senders-address",onSelect:()=>{a.runCommand(()=>{let e=_.map(e=>t.find(t=>(null==t?void 0:t.id)===e));if(!e)return;let l=e.map(e=>{var t,l,n,o,a;let i=null==e?void 0:e.messages[(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.length)-1];return(0,I.e6)(null!==(a=null==i?void 0:null===(o=i.payload)||void 0===o?void 0:null===(n=o.headers)||void 0===n?void 0:null===(l=n.find(e=>{var t;return(null==e?void 0:null===(t=e.name)||void 0===t?void 0:t.toLowerCase())==="from"}))||void 0===l?void 0:l.value)&&void 0!==a?a:"")}),n=l.join("\n");navigator.clipboard.writeText(n),r(S.t.lambdas.SenderAddressCopied({primaryText:n,count:l.length}))}),o.selectedIndices.length>0&&o.setSelectedIndices([])},shortcut:V("⌘ ⇧ ."),iconPath:g.N.Copy,keywords:["copy","senders","addresses"]},...Z?[{title:"Add or Change Labels",value:"add-or-change-labels",onSelect:()=>{a.setSearchInput(""),setTimeout(()=>{a.setPages(["Add or Change Labels"])},0)},iconPath:g.N.Label,keywords:["add","or","change","labels"]},{title:"Remove Label",value:"remove-label",onSelect:()=>{if(_.every(e=>{var l,n;return(null===(n=c.userLabels)||void 0===n?void 0:null===(l=n.filter(l=>(0,I.g4)(e,null==l?void 0:l.id,t)))||void 0===l?void 0:l.length)>1})){let e=a.searchInput;a.setLastSearchQuery(e),a.setSearchInput(""),a.setPages(["Remove Labels"])}else a.runCommand(()=>{let e=c.userLabels.find(e=>_.every(l=>(0,I.g4)(l,null==e?void 0:e.id,t)));if(!e)return;let l=_.flatMap(e=>{var l,n,o;return null!==(o=null===(n=t.find(t=>t.id===e))||void 0===n?void 0:null===(l=n.messages)||void 0===l?void 0:l.map(e=>e.id))&&void 0!==o?o:[]});O({hasLabel:!0,threadIds:_,emailIds:l,labelIds:[e.id],subject:e.name,doesAddToast:!0})}),N&&o.setSelectedIndices([])},iconPath:g.N.Label,keywords:["remove","labels"]}]:[{title:"Add Labels",value:"add-labels",onSelect:()=>{a.setSearchInput(""),setTimeout(()=>{a.setPages(["Add Labels"])},26)},iconPath:g.N.Label,keywords:["add","labels"]}],{title:"New Split Inbox",value:"new-split-inbox",onSelect:()=>{let e=a.searchInput;a.setLastSearchQuery(e),a.setSearchInput(""),setTimeout(()=>{a.setPages([...a.pages,"New Split Inbox"])},26)},iconPath:g.N.SplitInbox,keywords:["new","split","inbox"]},...ee?[{title:"Add to Existing Split Inbox",value:"add-split-inbox",onSelect:()=>{let e=a.searchInput;a.setLastSearchQuery(e),a.setSearchInput(""),setTimeout(()=>{a.setPages([...a.pages,"Add to Split Inbox"])},26)},iconPath:g.N.SplitInbox,keywords:["new","split","inbox"]}]:[]],[t,j,N]);return(0,i.jsx)(i.Fragment,{children:[{heading:"",items:et}].map((e,t)=>(0,i.jsx)(p.fu,{id:e.heading,heading:e.heading,children:null==e?void 0:e.items.map((t,l)=>(0,i.jsxs)(p.di,{id:e.heading.toLowerCase()+"-"+l,value:t.value,onSelect:e=>{t.onSelect()},keywords:t.keywords,className:x()("[&_[cmdk-item]]:item-svg group [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5"),children:[(0,i.jsx)(C._t,{...t}),(0,i.jsx)(p.Oc,{className:"",children:t.shortcut})]},e.heading.toLowerCase()+"-"+l))},t))})});var K=l(49222),Y=(0,y.Pi)(e=>{let{data:t}=e,{commandMenuStore:l,modalsStore:n,keyboardStore:o,inboxStore:a,toastStore:{addToast:d},labelStore:{currentLabel:u,userLabels:c},idbStore:{db:h},gapiStore:{gapiInitialized:b},syncStore:{isOfflineMode:x,syncStatus:f,setSyncStatus:y},searchStore:N}=(0,v.m)(),{mutate:j}=(0,s.rm)(u,c),{mutate:P}=(0,s.r0)(u,x,f,y,h,b),{mutate:T}=(0,m.s)(N.searchQuery,b),M=(0,k.usePathname)(),{archiveToggleThreads:L,deleteToggleThreads:A}=(0,r.Z)({mutateList:(null==M?void 0:M.includes("/search/"))?T:P,mutateLabel:j,isSingleThreadView:M.includes("/thread/")}),O=(0,k.useRouter)(),R=(0,w.useMemo)(()=>{var e;return M.includes("/thread")?null==a?void 0:a.currentThread:(null==o?void 0:o.currentIndex)&&(null==o?void 0:null===(e=o.currentIndex)||void 0===e?void 0:e.at(0))===1?t[null==o?void 0:o.currentIndex[1]]:void 0},[M,o.currentIndex,t]),E=(0,w.useMemo)(()=>{var e,t,l,n;return null==R?void 0:null===(n=R.messages)||void 0===n?void 0:null===(l=n.at(0))||void 0===l?void 0:null===(t=l.payload)||void 0===t?void 0:null===(e=t.headers)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.name)==="List-Unsubscribe")},[R]),U=(0,w.useMemo)(()=>{var e,t,l,n,o;return!(null==E?void 0:null===(e=E.value)||void 0===e?void 0:e.includes("mailto:"))&&!(null==R?void 0:null===(o=R.messages)||void 0===o?void 0:null===(n=o.at(0))||void 0===n?void 0:null===(l=n.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.name)==="List-Unsubscribe-Post"))},[E]),D=(0,w.useMemo)(()=>{var e,t,l;return null!==(l=null==R?void 0:null===(e=R.messages)||void 0===e?void 0:e.find(e=>{var t,l;return null==e?void 0:null===(l=e.payload)||void 0===l?void 0:null===(t=l.headers)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.name)==="List-Unsubscribe")}))&&void 0!==l?l:null==R?void 0:null===(t=R.messages)||void 0===t?void 0:t.at(0)},[null==R?void 0:R.messages]),_=(0,w.useMemo)(()=>(0,I.e6)((0,I.Uq)(D,"from",!1)),[D]),F=(0,w.useMemo)(()=>{let e=null==_?void 0:_.split("@");return"".concat(null==e?void 0:e.at(0)).concat(String.fromCharCode(8203),"@").concat(String.fromCharCode(8203)).concat(null==e?void 0:e.at(1))},[_]),q=e=>{E&&(0,K.wd)(E);let t=(0,I.ko)(D);d(S.t.lambdas.Unsubscribed({primaryText:t,count:1})),e&&_&&(0,K.jD)("from:".concat(_," ").concat("ARCHIVE"===e?"label:INBOX":"-label:TRASH")).then(t=>{var l,n,o,a,i,r,s,d,u;let{emailIds:c,threadIds:m}=t;if((null==c?void 0:c.length)&&("ARCHIVE"===e?L({emailIds:c,threadIds:m,hasLabel:!1,toastProps:{isActive:!1,count:null==m?void 0:m.length,primaryText:(null==m?void 0:m.length)===1&&null!==(a=null==D?void 0:null===(o=D.payload)||void 0===o?void 0:null===(n=o.headers)||void 0===n?void 0:null===(l=n.find(e=>(null==e?void 0:e.name)==="Subject"))||void 0===l?void 0:l.value)&&void 0!==a?a:""}}):"TRASH"===e&&A({threadIds:m,emailIds:c,toastProps:{isActive:!1,count:null==m?void 0:m.length,primaryText:(null==m?void 0:m.length)===1&&null!==(d=null==D?void 0:null===(s=D.payload)||void 0===s?void 0:null===(r=s.headers)||void 0===r?void 0:null===(i=r.find(e=>(null==e?void 0:e.name)==="Subject"))||void 0===i?void 0:i.value)&&void 0!==d?d:""},isTrash:!1,isArchived:!1,isSpam:!1})),M.includes("/thread/")){let e=null===(u=document.getElementById("next-email-button-no-scroll"))||void 0===u?void 0:u.href;e&&O.push(e)}})},B=[{title:"Unsubscribe",value:"sub-unsubscribe",iconPath:g.N.Unsubscribe,onSelect:()=>{l.runCommand(()=>{n.setAlertModalObj({alertMsg:"Unsubscribe?",alertDescription:"Are you sure you want to unsubscribe from ".concat(F,"?")+(U?" You will be redirected.":""),alertCode:H.xK.UNSUBSCRIBE,onConfirm:{title:"Unsubscribe",onClick:()=>{q()}},onClose:{title:"Cancel"}}),n.setAlertModalOpen(!0)})},keywords:["unsubscribe"]},{title:"Unsubscribe and Archive All Conversations from Sender",value:"sub-unsubscribe-archive",iconPath:g.N.Unsubscribe,onSelect:()=>{l.runCommand(()=>{n.setAlertModalObj({alertMsg:"Unsubscribe?",alertDescription:"Are you sure you want to unsubscribe and archive all conversations from ".concat(F,"?")+(U?" You will be redirected.":""),alertCode:H.xK.UNSUBSCRIBE,onConfirm:{title:"Unsubscribe",onClick:()=>{q("ARCHIVE")}},onClose:{title:"Cancel"}}),n.setAlertModalOpen(!0)})},keywords:["unsubscribe","and","archive","all","conversations","from","sender","done"]},{title:"Unsubscribe and Delete All Conversations from Sender",value:"sub-unsubscribe-delete",iconPath:g.N.Unsubscribe,onSelect:()=>{l.runCommand(()=>{n.setAlertModalObj({alertMsg:"Unsubscribe?",alertDescription:"Are you sure you want to unsubscribe and delete all conversations from ".concat(F,"?")+(U?" You will be redirected.":""),alertCode:H.xK.UNSUBSCRIBE,onConfirm:{title:"Unsubscribe",onClick:()=>{q("TRASH")}},onClose:{title:"Cancel"}}),n.setAlertModalOpen(!0)})},keywords:["unsubscribe","and","delete","all","conversations","from","sender","trash"]}];return(0,i.jsx)(i.Fragment,{children:B.map((e,t)=>(0,i.jsx)(p.di,{id:"unsubscribe-"+t,value:e.value,keywords:e.keywords,className:"group",onSelect:()=>{e.onSelect()},children:(0,i.jsx)(C._t,{...e})},"unsubscribe-"+t))})}),J=(0,y.Pi)(e=>{let{isSubItem:t}=e,{commandMenuStore:l}=(0,v.m)(),n=(0,k.useRouter)(),o=(0,f.U8)(e=>e.search),a=(0,u.H)();if((!o||l.pages.length>0)&&t)return null;let r=[{title:"Overview",value:"sub-overview",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/workspace/overview")})},keywords:["general","workspace","settings"]},{title:"Members",value:"sub-members",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/workspace/members")})},keywords:["members","workspace","settings"]},{title:"Billing",value:"sub-billing",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/workspace/billing")})},keywords:["billing","workspace","settings"]},{title:"Upgrade",value:"sub-upgrade",iconPath:g.N.Cog,onSelect:()=>{l.runCommand(()=>{n.push(a+"/settings/workspace/upgrade")})},keywords:["upgrade","workspace","settings"]}];return(0,i.jsx)(i.Fragment,{children:r.map((e,l)=>(0,i.jsxs)(p.di,{id:"workspace-"+l,value:e.value,keywords:e.keywords,className:"group",onSelect:t=>{e.onSelect()},children:[t?(0,i.jsx)(C.TH,{iconPath:e.iconPath,title:e.title,group:"Workspace Settings"}):(0,i.jsx)(C._t,{...e}),!t&&(0,i.jsx)(p.Oc,{className:"",children:e.shortcut})]},"workspace-"+l))})});let Z=(null===(a=window)||void 0===a?void 0:null===(o=a.navigator)||void 0===o?void 0:null===(n=o.platform)||void 0===n?void 0:n.indexOf("Mac"))===0;function V(e){return e?e.startsWith("G")?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-sm bg-white shadow-key dark:bg-fill-dark-base",children:e[0]},e[0]),(0,i.jsx)("span",{className:"flex items-center justify-center text-tertiary dark:text-tertiary-dark",children:"then"}),(0,i.jsx)("div",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-sm bg-white shadow-key dark:bg-fill-dark-base",children:e[2]},e[1])]}):(0,i.jsx)(i.Fragment,{children:e.split(" ").map(e=>{let t="⌘"===e,l="⌥"===e;return(0,i.jsx)("div",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-sm bg-white shadow-key dark:bg-fill-dark-base "+("⌫"===e?" pl-1":"")+((t||l)&&Z?"":" px-[5px]"),children:t&&!Z?"Ctrl":l&&!Z?"Alt":e},e)})}):(0,i.jsx)("span",{})}let Q=(e,t)=>{let l=t.searchInput;t.setLastSearchQuery(l),t.setSearchInput(""),t.setPages([e])},X=["Create New Label","New Split Inbox"];var $=(0,y.Pi)(e=>{let{isSingleThreadView:t}=e,{sidebarStore:l,keyboardStore:n,commandMenuStore:o,toastStore:{addToast:a},modalsStore:b,inboxStore:y,searchStore:j,labelStore:I,syncStore:M,idbStore:L,gapiStore:R,supabaseStore:E}=(0,v.m)(),{mutate:_}=(0,s.r0)(null==I?void 0:I.currentLabel,M.isOfflineMode,M.syncStatus,M.setSyncStatus,L.db,R.gapiInitialized),{mutate:F}=(0,m.s)(j.searchQuery,R.gapiInitialized),z=(0,u.H)(),{mutate:H}=(0,s.rm)(I.currentLabel,I.userLabels),G=(0,w.useRef)(null),K=(0,f.U8)(e=>e.search),Z=(0,k.usePathname)(),$=(0,w.useMemo)(()=>Z.includes("/mail/search"),[Z]),ee=(0,f.U8)(e=>e.value),et=(0,w.useMemo)(()=>$?void 0:H,[$,H]),el=(0,w.useMemo)(()=>$?j.threads:y.emailData,[$,y.emailData,j.threads]),en=(0,w.useMemo)(()=>$?F:_,[$,_,F]),eo=(0,r.Z)({isSingleThreadView:t,mutateLabel:et,mutateList:en}),ea=(0,w.useMemo)(()=>(n.selectedIndices.length>0||1===n.currentIndex[0]&&n.currentIndex[1]>=0)&&Z!==z+"/labels",[n.selectedIndices,n.currentIndex,Z]),ei=(0,w.useMemo)(()=>n.selectedIndices.length>1,[n.selectedIndices]),er=(0,w.useMemo)(()=>n.selectedIndices.length<2||t,[n.selectedIndices,t]),es=o.pages[o.pages.length-1],ed=(0,k.useRouter)(),eu=(0,w.useMemo)(()=>[{title:"Compose Message",onSelect:()=>{o.runCommand(()=>{y.setComposeOpen(!0)})},value:"compose-message",shortcut:V("C"),iconPath:g.N.Plus,keywords:["compose","message","new"]},{title:"Create New Label",value:"create-new-label",onSelect:()=>{Q("Create New Label",o)},iconPath:g.N.Label,keywords:["create","new","label"]},{title:"Copy Current URL",value:"copy-current-url",onSelect:()=>{o.runCommand(()=>{let e=window.location.href;navigator.clipboard.writeText(e),a(S.t.lambdas.CurrentUrlCopied({primaryText:e}))})},shortcut:V("⌘ ⇧ C"),iconPath:g.N.Copy,keywords:["copy","current","url"]},{title:"Undo",value:"undo",onSelect:()=>{o.runCommand(()=>{})},shortcut:V("⌘ Z"),iconPath:g.N.Undo,keywords:["undo"]},{title:"Redo",value:"redo",onSelect:()=>{o.runCommand(()=>{})},shortcut:V("⌘ ⇧ Z"),iconPath:g.N.Redo,keywords:["redo"]}],[]),ec=(0,w.useMemo)(()=>[{title:"Go to Inbox",value:"go-to-inbox",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/inbox")})},shortcut:V("G I"),keywords:["go","inbox","navigation"]},{title:"Go to Starred",value:"go-to-starred",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/starred")})},shortcut:V("G S"),keywords:["go","to","starred","navigation"]},{title:"Go to Drafts",value:"go-to-drafts",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/drafts")})},shortcut:V("G D"),keywords:["go","to","drafts","navigation"]},{title:"Go to Sent",value:"go-to-sent",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/sent")})},shortcut:V("G E"),keywords:["go","to","sent","navigation"]},{title:"Go to Archive",value:"go-to-archive",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/archive")})},shortcut:V("G A"),keywords:["go","to","archive","navigation"]},{title:"Go to Spam",value:"go-to-spam",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/spam")})},shortcut:V("G P"),keywords:["go","to","spam","navigation"]},{title:"Go to Trash",value:"go-to-trash",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/trash")})},shortcut:V("G T"),keywords:["go","to","trash","navigation"]},{title:"Go to Labels",value:"go-to-labels",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/labels")})},shortcut:V("G L"),keywords:["go","to","labels","navigation"]},{title:"Open Label",value:"open-label",iconPath:g.N.RightArrow,onSelect:()=>{Q("Open Label",o)},keywords:["open","label","navigation"]},{title:"".concat(l.sidebarOpen?"Hide":"Show"," Left Sidebar"),value:"hide-show-left-sidebar",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{l.toggleLeftSidebar()})},shortcut:V("["),keywords:["".concat(l.sidebarOpen?"hide":"show"),"left","sidebar","navigation"]},{title:"".concat(l.rightSidebarOpen?"Hide":"Show"," Right Sidebar"),value:"hide-show-right-sidebar",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{l.toggleRightSidebar()})},shortcut:V("]"),keywords:["".concat(l.rightSidebarOpen?"hide":"show"),"right","sidebar","navigation"]},{title:"Show View Options",value:"show-view-options",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{let e=new MouseEvent("pointerdown",{view:window,ctrlKey:!1,bubbles:!0,cancelable:!0,metaKey:!1,button:0,buttons:1});if((0,d._f)(document.location.pathname)){let t=document.getElementById("view-dropdown-options");setTimeout(()=>{null==t||t.dispatchEvent(e)},20)}else{let t=document.getElementById("view-dropdown-button");setTimeout(()=>{null==t||t.dispatchEvent(e)},20)}})},shortcut:V("V"),keywords:["show","view","options","navigation"]},{title:"Open Onboarding Tutorial",value:"open-onboarding-tutorial",iconPath:g.N.RightArrow,onSelect:()=>{o.runCommand(()=>{ed.push("/onboarding")})},shortcut:V(""),keywords:["open","onboarding","tutorial","navigation"]}],[]),em=(0,w.useMemo)(()=>[{title:"Account Settings",value:"account-settings",iconPath:g.N.Cog,onSelect:()=>{Q("Account Settings",o)},shortcut:V("G N"),keywords:["account","settings"]},{title:"General Settings",value:"general-settings",iconPath:g.N.Cog,onSelect:()=>{Q("General Settings",o)},shortcut:"",keywords:["general","settings"]},{title:"Workspace Settings",value:"workspace-settings",iconPath:g.N.Cog,onSelect:()=>{Q("Workspace Settings",o)},shortcut:"",keywords:["workspace","settings"]},{title:"Change Theme",value:"change-theme-settings",iconPath:g.N.Cog,onSelect:()=>{Q("Change Theme",o)},shortcut:V("Ctrl ⌥ D"),keywords:["change","theme","settings"]}],[]),ev=(0,w.useMemo)(()=>[{title:"Open Help Center",value:"open-help-center",iconPath:g.N.Help,onSelect:()=>{o.runCommand(()=>{b.setHelpCenterModalOpen(!0)})},shortcut:V("?"),keywords:["open","help","center"]},{title:"Open Keyboard Shortcuts",value:"open-keyboard-shortcuts-help",iconPath:g.N.KeyboardFill,onSelect:()=>{o.runCommand(()=>{b.setHelpCenterPage("keyboard shortcuts"),b.setHelpCenterModalOpen(!0)})},shortcut:V(""),keywords:["open","keyboard","shortcuts","help"]},{title:"Open Search Tips",value:"open-search-tips-help",iconPath:g.N.Search,onSelect:()=>{o.runCommand(()=>{b.setHelpCenterPage("search tips"),b.setHelpCenterModalOpen(!0)})},shortcut:V(""),keywords:["open","search","tips","help"]},{title:"Open Tatem Documentation",value:"open-tatem-documentation-help",iconPath:g.N.External,onSelect:()=>{o.runCommand(()=>{window.open("https://tatem.com/docs","_blank")})},shortcut:V(""),keywords:["open","tatem","documentation","help"]},{title:"Contact Support",value:"contact-support-help",iconPath:g.N.Help,onSelect:()=>{Q("Contact Support",o)},shortcut:V(""),keywords:["contact","support","help"]}],[o.pages]),ep=(0,w.useMemo)(()=>[...t||ea?[{title:"Refer ".concat(ei?"Senders":"Sender"," to Tatem Mail"),value:"refer-sender-to-tatem-mail-miscellanous",iconPath:g.N.Gift,onSelect:()=>{o.runCommand(()=>{})},shortcut:V(""),keywords:["refer","sender","tatem","mail","miscellanous"]}]:[],{title:"Refer a Friend to Tatem Mail",value:"refer-friend-to-tatem-mail-miscellanous",iconPath:g.N.Gift,onSelect:()=>{o.runCommand(()=>{})},shortcut:V(""),keywords:["refer","friend","tatem","mail","miscellanous"]},{title:"Copy Referral Link",value:"copy-referral-link-miscellanous",iconPath:g.N.Copy,onSelect:()=>{o.runCommand(()=>{})},shortcut:V(""),keywords:["copy","referral","link","miscellanous"]}],[]),eh=(0,w.useMemo)(()=>[{title:"Sign Out",value:"sign-out",iconPath:g.N.SignOut,onSelect:()=>{o.runCommand(()=>{(0,c.e)().auth.signOut().then(()=>{localStorage.clear(),window.location.reload()})})},shortcut:V(""),keywords:["sign","out"]},{title:"Switch Accounts",value:"switch-accounts",iconPath:g.N.SignOut,onSelect:()=>{Q("Switch Accounts",o)},shortcut:V(""),keywords:["switch","accounts"]}],[]),eg=(0,w.useMemo)(()=>[{title:"Search Mail",value:"search-mail",iconPath:g.N.Search,onSelect:()=>{o.runCommand(()=>{ed.push(z+"/search")})},shortcut:V("/"),keywords:["search","mail"]},{title:"Find in View",value:"find-in-view-search",iconPath:g.N.Search,onSelect:()=>{o.runCommand(()=>{})},shortcut:V("⌘ F"),keywords:["find","view","search"]}],[]);return(0,w.useEffect)(()=>{var e,t;let l=null==G?void 0:null===(e=G.current)||void 0===e?void 0:e.querySelector('[role="option"]');ee===(null==l?void 0:null===(t=l.dataset)||void 0===t?void 0:t.value)&&(null==l||l.scrollIntoView({block:"center"}))},[ee]),(0,i.jsxs)(p.e8,{id:"command-menu-list",ref:G,asChild:!0,style:{paddingTop:X.includes(es)||(null==es?void 0:es.includes('Pick a color for "'))?"min(max(var(--cmdk-list-height) - 16px, -1 * (var(--cmdk-list-height) - 16px)), 8px)":"8px",paddingBottom:X.includes(es)||(null==es?void 0:es.includes('Pick a color for "'))?"min(max(var(--cmdk-list-height) - 16px, 16px - var(--cmdk-list-height)), 8px)":"8px"},children:[!!K&&!X.includes(es)&&!(null==es?void 0:es.includes('Pick a color for "'))&&(0,i.jsx)(p.rb,{className:"body bg-fill-primary dark:bg-fill-dark-primary",style:{height:"48px"},children:(0,i.jsxs)("div",{className:"flex h-full w-full items-center justify-start gap-x-3 px-4 py-3",children:[(0,i.jsx)(h.J,{path:g.N.Search,className:"h-4 w-4 shrink-0"}),(0,i.jsxs)("span",{children:['No Results Found for "',K,'"']})]})}),"Contact Support"===es&&(0,i.jsx)(T,{isSubItem:!1}),"Account Settings"===es&&(0,i.jsx)(N,{isSubItem:!1}),"General Settings"===es&&(0,i.jsx)(O,{isSubItem:!1}),"Workspace Settings"===es&&(0,i.jsx)(J,{isSubItem:!1}),"Embedded Links"===es&&(0,i.jsx)(A,{isSingleThreadView:t,data:el}),"Change Theme"===es&&(0,i.jsx)(B,{isSubItem:!1}),"Unsubscribe"===es&&(0,i.jsx)(Y,{data:el}),"Switch Accounts"===es&&(0,i.jsx)(P,{isSignOut:!1}),(null==es?void 0:es.includes(" Split Inbox"))&&(0,i.jsx)(q,{data:el}),(null==es?void 0:es.includes(" Label"))&&(0,i.jsx)(U,{changeThreadLabels:eo.changeThreadLabels,data:el,mode:"Add Labels"===es||"Add or Change Labels"===es?"toggle":"Remove Labels"===es?"remove":"Create New Label"===es?"create":"navigate"}),(null==es?void 0:es.includes('Pick a color for "'))&&(0,i.jsx)(U,{changeThreadLabels:eo.changeThreadLabels,data:el,mode:"color"}),!es&&ea&&(0,i.jsx)(W,{labelThreadActions:eo,data:el,isSingle:er}),!es&&[{heading:"",items:eu},{heading:"Navigation",items:ec},{heading:"Settings",items:em},{heading:"Help",items:ev},{heading:"Miscellanous",items:ep},{heading:"Account",items:eh},{heading:"Search",items:eg}].map((e,t)=>(0,i.jsxs)(p.fu,{id:e.heading||"default",heading:e.heading,children:[0!==t&&(0,i.jsx)(p.zz,{}),null==e?void 0:e.items.map((t,l)=>(0,i.jsxs)(p.di,{id:""===e.heading?"default-"+l:e.heading.toLowerCase()+"-"+l,value:t.value,onSelect:e=>{t.onSelect()},keywords:t.keywords,className:x()("[&_[cmdk-item]]:item-svg group [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5"),children:[(0,i.jsx)(C._t,{...t}),(0,i.jsx)(p.Oc,{className:"",children:t.shortcut})]},""===e.heading?"default-"+l:e.heading.toLowerCase()+"-"+l))]},t)),!es&&!!K&&(0,i.jsxs)(p.fu,{children:[(0,i.jsx)(T,{isSubItem:!0}),(0,i.jsx)(N,{isSubItem:!0}),(0,i.jsx)(O,{isSubItem:!0}),(0,i.jsx)(J,{isSubItem:!0}),(0,i.jsx)(B,{isSubItem:!0}),(0,i.jsx)(U,{changeThreadLabels:eo.changeThreadLabels,data:el,mode:"toggle",isSubItem:!0}),(0,i.jsx)(D,{})]},"subitems")]})})},15205:function(e,t,l){"use strict";l.d(t,{T:function(){return C},k:function(){return w}});var n=l(44003),o=l(17115),a=l(39635),i=l(70137),r=l(60136),s=l(71451),d=l(93629),u=l(3984),c=l(63372),m=l(39359),v=l(87355),p=l(50026),h=l(6566),g=l(69250),b=l(67265),x=l(74848),f=l(1394),y=l(87767),k=l(62516);let w=["Important","Other","Inbox"],S={team:{placeholder:"Prioritize messages from your team by adding a domain (e.g. domain.com) or multiple domains. Indirect messages, such as those from mailing lists, won’t be included",description:"Filter messages from your team domains."},custom:{placeholder:'Choose whether you’d like to add the sender, domain, recipient, subject, or label to the Split. Combine multiple filters with "and" / "or."',description:"Set rules to organize your emails."},important:{placeholder:"",description:"Prioritize your most crucial emails."}},C=(0,f.Pi)(()=>{var e,t,l,f,C;let{modalsStore:N,supabaseStore:j,toastStore:I,keyboardStore:P}=(0,u.m)(),T=(0,y.usePathname)(),M=(0,s.e)(),L=(0,y.useRouter)(),A=(0,r.H)(),O=(0,k.useMemo)(()=>j.inboxSplits.filter(e=>!w.includes(null==e?void 0:e.name)),[null==j?void 0:j.inboxSplits]),[R,E]=(0,k.useState)(0),[U,D]=(0,k.useState)(null),[_,F]=(0,k.useState)(null),q=(0,k.useRef)(null),B=(0,k.useRef)(null),z=(0,k.useRef)(null),H=(0,k.useMemo)(()=>{var e,t;return(null===(e=j.inboxSplits.find(e=>"Important"===e.name))||void 0===e?void 0:e.active)&&(null===(t=j.inboxSplits.find(e=>"Other"===e.name))||void 0===t?void 0:t.active)},[j.inboxSplits]),G=(0,k.useMemo)(()=>[{name:"Important | Other",value:"",active:H},...O.find(e=>"Team"===e.name)?[]:[{name:"Team",value:"",active:!1}]],[O]),W=e=>{var t;j.setInboxSplits(e),M.from("users").update({splits:e}).eq("id",null==j?void 0:null===(t=j.userData)||void 0===t?void 0:t.id).then()},K=e=>{var t,l,n;let o=[...j.inboxSplits];w.forEach(t=>{let l=o.findIndex(e=>e.name===t);o[l].active="Inbox"===t?!e:e}),e||(null==T?void 0:null===(t=T.split("/"))||void 0===t?void 0:t.pop())!=="other"||L.push(A+"/inbox"),W(o),I.addToast(d.t.lambdas.SplitUpdateCompleted({primaryText:null!==(n=null==U?void 0:null===(l=U.newSplit)||void 0===l?void 0:l.name)&&void 0!==n?n:""}))},Y=()=>{var e,t,l,n,o,a,i,r,s,u,c;if((null==U?void 0:U.oldSplit.name)==="Important | Other"){U.oldSplit.active!==U.newSplit.active&&K(!!U.newSplit.active),D(null);return}if(!(null==U?void 0:U.newSplit.name)||!(null==U?void 0:U.newSplit.value)){I.addToast(d.t.lambdas.SplitUpdateFailed({primaryText:"Please complete the name and content fields before saving."}));return}if(j.inboxSplits.find(e=>{var t,l,n,o;return e.name.toLowerCase()===(null==U?void 0:null===(l=U.newSplit)||void 0===l?void 0:null===(t=l.name)||void 0===t?void 0:t.toLowerCase())&&e.name.toLowerCase()!==(null===(o=U.oldSplit)||void 0===o?void 0:null===(n=o.name)||void 0===n?void 0:n.toLowerCase())})){I.addToast(d.t.lambdas.SplitUpdateFailed({primaryText:"A split inbox with the name “".concat(null==U?void 0:null===(a=U.newSplit)||void 0===a?void 0:a.name,"” already exists")}));return}let m=[...j.inboxSplits],v=m.findIndex(e=>{var t;return e.name===(null==U?void 0:null===(t=U.oldSplit)||void 0===t?void 0:t.name)});v>=0&&(null==U?void 0:U.newSplit)?m[v]=null==U?void 0:U.newSplit:"Team"===U.oldSplit.name&&m.splice(2,0,U.newSplit);let p=null==m?void 0:null===(t=m.filter(e=>!w.includes(null==e?void 0:e.name)&&!!e.active&&!e.showInInbox))||void 0===t?void 0:null===(e=t.map(e=>" -(".concat(e.value,")")))||void 0===e?void 0:e.join("");w.forEach(e=>{let t=m.findIndex(t=>t.name===e);m[t].value=("Inbox"===e?"":"Important"===e?"category:personal":"-(category:personal)")+p}),W(m),I.addToast(d.t.lambdas.SplitUpdateCompleted({primaryText:null!==(i=null==U?void 0:null===(l=U.newSplit)||void 0===l?void 0:l.name)&&void 0!==i?i:""})),(null==U?void 0:U.newSplit.name)!==(null==U?void 0:U.oldSplit.name)&&T.includes(encodeURI(null!==(r=null==U?void 0:null===(o=U.oldSplit)||void 0===o?void 0:null===(n=o.name)||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:""))&&L.push(A+"/inbox/"+encodeURI(null!==(c=null==U?void 0:null===(u=U.newSplit)||void 0===u?void 0:null===(s=u.name)||void 0===s?void 0:s.toLowerCase())&&void 0!==c?c:"")),D(null)},J=()=>{let e=[...O];e.splice(_.newIdx,0,e.splice(_.originalIdx,1)[0]),W([...j.inboxSplits.slice(0,2),...e,j.inboxSplits.at(-1)]),E(_.newIdx+(null==G?void 0:G.length))},Z=()=>{var e,t,l,n,o,a,i;let r=[...j.inboxSplits].filter(e=>e.name!==(null==U?void 0:U.oldSplit.name));if((null==U?void 0:U.oldSplit.active)&&!U.oldSplit.showInInbox){let e=null==r?void 0:null===(o=r.filter(e=>!w.includes(null==e?void 0:e.name)&&!!e.active&&!e.showInInbox))||void 0===o?void 0:null===(n=o.map(e=>" -(".concat(e.value,")")))||void 0===n?void 0:n.join("");w.forEach(t=>{let l=r.findIndex(e=>e.name===t);r[l].value=("Inbox"===t?"":"Important"===t?"category:personal":"-(category:personal)")+e})}W(r),I.addToast(d.t.lambdas.SplitDeletionCompleted({primaryText:null!==(a=null==U?void 0:null===(e=U.newSplit)||void 0===e?void 0:e.name)&&void 0!==a?a:""})),T.includes(encodeURI(null!==(i=null==U?void 0:null===(l=U.oldSplit)||void 0===l?void 0:null===(t=l.name)||void 0===t?void 0:t.toLowerCase())&&void 0!==i?i:""))&&setTimeout(()=>{L.push(A+"/inbox")},0),D(null)};return(0,k.useEffect)(()=>{N.splitInboxModalOpen||(E(0),D(null))},[N.splitInboxModalOpen]),(0,k.useEffect)(()=>{var e;null===(e=z.current)||void 0===e||e.focus()},[null==U?void 0:U.oldSplit]),(0,n.jsx)(x.fC,{onOpenChange:()=>{N.setSplitInboxModalOpen(!N.splitInboxModalOpen)},modal:!0,open:N.splitInboxModalOpen,children:(0,n.jsx)(x.h_,{container:null===(e=document)||void 0===e?void 0:e.getElementById("main-page"),children:(0,n.jsxs)(x.VY,{className:"fixed left-1/2 top-20 z-50 flex max-h-[572px] w-4/5 max-w-[640px] -translate-x-1/2 flex-col rounded-lg shadow-layer-lg before:absolute before:inset-0 before:z-[-1] before:rounded-lg before:bg-fill-overlay before:backdrop-blur-modal dark:shadow-control-dark dark:before:bg-fill-dark-overlay md:top-[120px]","aria-describedby":void 0,onEscapeKeyDown:e=>{U&&(e.preventDefault(),D(null))},onKeyDown:e=>{if("Enter"===e.key&&(0,o.SE)(e)){var t;null===(t=B.current)||void 0===t||t.click()}},onCloseAutoFocus:e=>{if("1,-1"===P.currentIndex.toString()){var t;e.preventDefault(),null===(t=document.getElementById("split-options-button"))||void 0===t||t.focus()}},children:[(0,n.jsxs)(x.Dx,{className:"flex w-full items-center gap-x-3 border-b border-b-border-primary px-4 py-3 dark:border-b-border-dark-primary",children:[(0,n.jsx)("div",{className:"relative h-6 w-6",children:U?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.z,{size:"sm",icon:p.N.LeftArrow,variant:"tertiary",onClick:()=>{D(null)},className:"peer"}),(0,n.jsx)(c.M,{title:i.Wz.Back.title,position:"top-8 -right-7",keys:["Esc"]})]}):(0,n.jsxs)(x.x8,{className:"relative",tabIndex:-1,children:[(0,n.jsx)(m.z,{className:"peer",icon:p.N.LeftArrow,variant:"tertiary",size:"sm"}),(0,n.jsx)(c.M,{...i.Wz.Close,position:"top-8 -right-8"})]})}),(0,n.jsx)("div",{className:"flex items-center whitespace-nowrap text-t2 font-medium text-primary dark:text-primary-dark",children:U?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:'Edit "'}),(0,n.jsx)("span",{className:"max-w-[9rem] truncate md:max-w-[20rem]",children:"Team"===U.oldSplit.name?"Team":"Important | Other"===U.oldSplit.name?"Important | Other":U.oldSplit.name}),(0,n.jsx)("span",{children:'" Split Inbox'})]}):(0,n.jsx)("span",{children:"Split Inbox"})})]}),U?(0,n.jsxs)("div",{className:"flex flex-col gap-6 px-5 py-3 pb-5",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"highlight-text flex items-center justify-between py-3",children:[(0,n.jsx)("span",{className:"block",children:"Toggle split inbox on or off."}),(0,n.jsx)(b.q,{ref:z,id:"edit-split-toggle-switch",checked:U.newSplit.active,onCheckedChange:()=>D({...U,newSplit:{...null==U?void 0:U.newSplit,active:!U.newSplit.active}})})]}),(null===(t=U.oldSplit)||void 0===t?void 0:t.name)!=="Important | Other"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"highlight-text -mt-3 flex items-center justify-between py-3",children:[(0,n.jsx)("span",{className:"block",children:'Also show in "Important | Other."'}),(0,n.jsx)(b.q,{checked:U.newSplit.showInInbox,onCheckedChange:()=>D({...U,newSplit:{...null==U?void 0:U.newSplit,showInInbox:!U.newSplit.showInInbox}})})]}),(0,n.jsx)("hr",{className:"mb-3 border-t border-border-primary dark:border-border-dark-primary"}),(null===(l=U.oldSplit)||void 0===l?void 0:l.name)!=="Team"&&(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("label",{htmlFor:"splitName",className:"highlight-text",children:"Split Name"}),(0,n.jsx)(h.a,{name:"splitName",id:"split-name-input",onFocus:e=>{let t=e.target.value.length;e.target.selectionStart=t,e.target.selectionEnd=t},width:"100%",placeholder:"Custom Name",value:null==U?void 0:null===(f=U.newSplit)||void 0===f?void 0:f.name,maxLength:40,onChange:e=>{var t;return D({...U,newSplit:{...null==U?void 0:U.newSplit,name:null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value}})}})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("label",{htmlFor:"splitName",className:"highlight-text",children:"Team"===U.oldSplit.name?"Team Domain":"Split Content"}),(0,n.jsx)(g.U,{id:"split-value-input",ref:q,value:null==U?void 0:null===(C=U.newSplit)||void 0===C?void 0:C.value,placeholder:"Team"===U.oldSplit.name?S.team.placeholder:S.custom.placeholder,onChange:e=>{var t;return D({...U,newSplit:{...null==U?void 0:U.newSplit,value:null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value}})},onFocus:e=>{setTimeout(()=>{if(q.current){let e=q.current.value.length;q.current.selectionStart=e,q.current.selectionEnd=e,q.current.focus()}},0)},className:"h-48",spellCheck:"false"})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)("span",{className:"text-body text-tertiary dark:text-tertiary-dark",children:"Important | Other"===U.oldSplit.name?S.important.description:"Team"===U.oldSplit.name?S.team.description:S.custom.description}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:["Team"!==U.oldSplit.name&&!U.oldSplit.name.includes("Important")&&(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(m.z,{label:"Delete",className:"peer",variant:"tertiary",onClick:()=>{N.setAlertModalObj({alertMsg:"Are you sure you want to delete this split?",alertDescription:"",onConfirm:{title:"Delete",onClick:()=>{Z()}},onClose:{title:"Cancel",onClick:()=>{}}}),N.setAlertModalOpen(!0)}}),(0,n.jsx)(c.M,{...i.Wz.DeleteSplit,position:"top-10 -right-8"})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(m.z,{ref:B,className:"peer",label:"Save",variant:"primary",onClick:()=>Y()}),(0,n.jsx)(c.M,{...i.Wz.SaveSplitInbox,position:"top-10 -right-12"})]})]})]})]}):(0,n.jsxs)("div",{className:"max-h-[504px] overflow-y-auto p-2 text-body",children:[G.map((e,t)=>(0,n.jsxs)("button",{ref:e=>{(0,o.W_)(e,!!e&&R===t)},onMouseMove:e=>{if((0,a.b)()){e.preventDefault();return}E(t)},id:"default-split-"+e.name+"-"+t,className:"group flex w-full scroll-my-4 items-center justify-between rounded p-3 outline-none focus:bg-fill-primary dark:focus:bg-fill-dark-primary",onKeyDown:e=>{if(e.key.includes("Arrow"))switch(e.stopPropagation(),e.preventDefault(),e.key){case"ArrowDown":E(Math.min([...G,...O].length-1,R+1));break;case"ArrowUp":E(Math.max(0,R-1))}},onClick:()=>{D({oldSplit:e,newSplit:e})},children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,n.jsx)("div",{className:"highlight-text",children:e.name}),(0,n.jsx)("div",{className:"text-tertiary dark:text-tertiary-dark",children:"Important | Other"===e.name?"Split emails marked as important from the rest of your inbox.":"Prioritize emails from your team by adding your company domain."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"text-tertiary group-focus:text-primary dark:text-tertiary-dark dark:group-focus:text-primary-dark",children:e.active?"On":"Team"!==e.name?"Off":"Setup Required"}),(0,n.jsx)(v.J,{path:p.N.RightChevron,className:"text-muted group-focus:text-quartery dark:text-muted-dark dark:group-focus:text-quartery-dark"})]})]},e.value)),[...O].map((e,t)=>(0,n.jsxs)("button",{ref:e=>{(0,o.W_)(e,!!e&&R===t+(null==G?void 0:G.length))},onMouseMove:e=>{if((0,a.b)()){e.preventDefault();return}E(t+(null==G?void 0:G.length))},onDragEnter:()=>{F({..._,newIdx:t})},onDragOver:e=>{e.preventDefault()},id:"user-split-"+t,className:"group flex w-full scroll-my-4 items-center justify-between rounded p-3 outline-none focus:bg-fill-primary dark:focus:bg-fill-dark-primary",onKeyDown:e=>{if(e.key.includes("Arrow"))switch(e.stopPropagation(),e.preventDefault(),e.key){case"ArrowDown":E(Math.min([...G,...O].length-1,R+1));break;case"ArrowUp":E(Math.max(0,R-1))}},onClick:()=>{D({oldSplit:e,newSplit:e})},children:[(0,n.jsxs)("div",{className:"flex flex-col items-start gap-2 text-left",children:[(0,n.jsx)("div",{className:"highlight-text",children:e.name}),(0,n.jsx)("div",{className:"text-tertiary dark:text-tertiary-dark",children:e.value})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{draggable:!0,onDragStart:l=>{l.dataTransfer.effectAllowed="move";let n=document.getElementById("user-split-"+t),o=null==n?void 0:n.getBoundingClientRect();l.dataTransfer.setDragImage(n,l.clientX-o.x,l.clientY-o.y),F({originalIdx:t,newIdx:t,split:e})},onDragEnd:e=>{e.preventDefault(),_.newIdx!==_.originalIdx&&J(),F(null)},className:"mr-1 cursor-move text-quartery opacity-0 hover:text-primary group-focus:opacity-100 dark:text-quartery-dark dark:hover:text-primary-dark",children:(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",children:[(0,n.jsx)("path",{d:"M0 7C0 6.17157 0.671573 5.5 1.5 5.5C2.32843 5.5 3 6.17157 3 7C3 7.82843 2.32843 8.5 1.5 8.5C0.671573 8.5 0 7.82843 0 7Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M0 1.5C0 0.671573 0.671573 0 1.5 0C2.32843 0 3 0.671573 3 1.5C3 2.32843 2.32843 3 1.5 3C0.671573 3 0 2.32843 0 1.5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M6 1.5C6 0.671573 6.67157 0 7.5 0C8.32843 0 9 0.671573 9 1.5C9 2.32843 8.32843 3 7.5 3C6.67157 3 6 2.32843 6 1.5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M0 12.5C0 11.6716 0.671573 11 1.5 11C2.32843 11 3 11.6716 3 12.5C3 13.3284 2.32843 14 1.5 14C0.671573 14 0 13.3284 0 12.5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M6 12.5C6 11.6716 6.67157 11 7.5 11C8.32843 11 9 11.6716 9 12.5C9 13.3284 8.32843 14 7.5 14C6.67157 14 6 13.3284 6 12.5Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M6 7C6 6.17157 6.67157 5.5 7.5 5.5C8.32843 5.5 9 6.17157 9 7C9 7.82843 8.32843 8.5 7.5 8.5C6.67157 8.5 6 7.82843 6 7Z",fill:"currentColor"})]})}),(0,n.jsx)("div",{className:"w-4 text-tertiary group-focus:text-primary dark:text-tertiary-dark dark:group-focus:text-primary-dark",children:e.active?"On":"Off"}),(0,n.jsx)(v.J,{path:p.N.RightChevron,className:"text-muted group-focus:text-quartery dark:text-muted-dark dark:group-focus:text-quartery-dark"})]})]},e.value))]})]})})})})},64813:function(e,t,l){"use strict";var n=l(44003),o=l(3984),a=l(30676),i=l(968),r=l(67476),s=l(61808),d=l.n(s),u=l(1394),c=l(62516),m=l(87355),v=l(50026);l(69364),t.default=(0,u.Pi)(function(){var e,t,l,s;let u;let{commandMenuStore:p,toastStore:h}=(0,o.m)(),[g,b]=(0,c.useState)(!1);return(p&&(u=p.setCommandMenuOpen),(0,c.useEffect)(()=>{b(!0)},[]),g)?(0,n.jsx)(i.f,{container:null!==(s=null===(e=document)||void 0===e?void 0:e.getElementById("main-page"))&&void 0!==s?s:null===(t=document)||void 0===t?void 0:t.body,children:(0,n.jsxs)(r.zt,{duration:a.Q,swipeDirection:"right",children:[null===(l=h.toasts)||void 0===l?void 0:l.map((e,t)=>(0,n.jsxs)(r.fC,{className:"ToastRoot group/toast relative flex w-[364px] items-center rounded-lg bg-fill-overlay p-3 shadow-layer-sm backdrop-blur-lg dark:bg-fill-dark-overlay dark:shadow-control-dark",onEscapeKeyDown:e=>{var t,l;e.preventDefault(),(null===(l=e.target)||void 0===l?void 0:null===(t=l.className)||void 0===t?void 0:t.includes("cmdk"))&&u&&u(!1)},children:[(null==e?void 0:e.icon)&&(0,n.jsx)("div",{className:"mr-2 flex h-10 w-10 shrink-0 items-center justify-center",children:(0,n.jsx)(m.J,{path:null==e?void 0:e.icon,className:"pointer-events-none text-primary dark:text-primary-dark"})}),(0,n.jsxs)("div",{className:d()("flex flex-col gap-1.5 text-body",{"items-start":null==e?void 0:e.description},{"items-center":!(null==e?void 0:e.description)}),style:{maxWidth:(null==e?void 0:e.icon)?"calc(100% - 48px)":"100%"},children:[(0,n.jsx)(r.Dx,{className:"highlight-text",children:e.title}),(null==e?void 0:e.description)&&(0,n.jsx)(r.dk,{className:"line-clamp-2 max-w-full text-tertiary dark:text-tertiary-dark",children:(0,n.jsx)("div",{className:"break-words",children:e.description})})]}),(0,n.jsx)(r.aU,{altText:"Undo button"}),(0,n.jsx)(r.x8,{className:"group absolute -left-2 -top-2 rounded-full bg-fill-overlay p-1 opacity-0 shadow-layer-sm backdrop-blur-xl duration-175 group-hover/toast:opacity-100 dark:bg-fill-dark-overlay dark:shadow-control-dark",children:(0,n.jsx)(m.J,{path:v.N.Close,className:"text-secondary group-hover:text-primary dark:text-secondary-dark dark:group-hover:text-primary-dark"})})]},t)),(0,n.jsx)(r.l_,{className:"fixed bottom-5 right-5 z-[99] flex flex-col gap-2",ref:e=>{var t;(null==e?void 0:e.childElementCount)===0&&(null===(t=h.toasts)||void 0===t?void 0:t.length)>=1&&h.clearToasts()}})]})}):null})},33329:function(e,t,l){"use strict";l.d(t,{s:function(){return r}});var n=l(29970),o=l(49222),a=l(57802);let i=(e,t,l,n)=>""!==e.trim()&&t?0===l?"".concat(e):!(l>0)||n&&n.nextPageToken?"".concat(e,"-").concat(n?n.nextPageToken:""):null:null,r=(e,t)=>{var l,o,r;let{data:d,error:u,size:c,setSize:m,isValidating:v,isLoading:p,mutate:h}=(0,a.ZP)((l,n)=>i(e,t,l,n),e=>s(e),{revalidateAll:!1,revalidateFirstPage:!1,revalidateOnFocus:!1,...n.vv});return{pagedResults:d,resultSizeEstimate:null!==(r=null==d?void 0:null===(l=d[0])||void 0===l?void 0:l.resultSizeEstimate)&&void 0!==r?r:0,isLoading:p,isLoadingInitialData:!d&&!u,isLoadingMore:v&&c>0&&d&&void 0===d[c-1],isSearchResultLoaded:void 0!==d&&0!==d[0].threadResults.length,isSearchResultEmpty:void 0!==d&&0===d[0].resultSizeEstimate&&0===d[0].threadResults.length,isReachingEnd:!!d&&!!d[d.length-1]&&"nextPageToken"in d[d.length-1]&&!(null===(o=d[d.length-1].nextPageToken)||void 0===o?void 0:o.length),hasFinishedLoading:(d||u)&&!v,setSearchPageSize:m,pageSize:c,error:u,mutate:h}},s=async e=>{let[t,l]=e.split("-"),n=window.gapi,{result:{threads:a,nextPageToken:i,resultSizeEstimate:r}}=await n.client.gmail.users.threads.list({userId:"me",q:t,maxResults:25,pageToken:l});if(0===r||!a)return{threadResults:[],nextPageToken:"",resultSizeEstimate:0};let s=Promise.all(null==a?void 0:a.map(async e=>{var t,l,o;return(await (null==n?void 0:null===(o=n.client)||void 0===o?void 0:null===(l=o.gmail)||void 0===l?void 0:null===(t=l.users)||void 0===t?void 0:t.threads.get({userId:"me",id:e.id,fields:"historyId,id,messages(id,internalDate,labelIds,payload,snippet,threadId)"}))).result})),d=new Promise(e=>setTimeout(()=>e(null),3e3)),u=await new Promise((e,t)=>(0,o.$Y)({fn:Promise.race([s,d]),resolve:e,reject:t,count:0}));if(null===u)throw Error("too many attempts");return{threadResults:u,nextPageToken:i,resultSizeEstimate:r}}},64156:function(){},69364:function(){}}]);